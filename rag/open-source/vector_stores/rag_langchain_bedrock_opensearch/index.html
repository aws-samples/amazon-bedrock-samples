<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Amazon Bedrock cookbook website"><meta name=author content=Bedrock-GTM><link href=https://github.amazon-bedrock-samples.com/rag/open-source/vector_stores/rag_langchain_bedrock_opensearch/ rel=canonical><link href=../../chunking/rag_chunking_strategies_langchain_bedrock/ rel=prev><link href=../../../../custom-models/model-distillation/Historical_invocation_distillation/ rel=next><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>Langchain Chatbot with Opensearch - Amazon Bedrock Recipes</title><link rel=stylesheet href=../../../../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="Amazon Bedrock Recipes" class="md-header__button md-logo" aria-label="Amazon Bedrock Recipes" data-md-component=logo> <img src=../../../../logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Amazon Bedrock Recipes </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Langchain Chatbot with Opensearch </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=purple aria-hidden=true type=radio name=__palette id=__palette_0> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Github: Amazon-Bedrock-Samples </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="Amazon Bedrock Recipes" class="md-nav__button md-logo" aria-label="Amazon Bedrock Recipes" data-md-component=logo> <img src=../../../../logo.png alt=logo> </a> Amazon Bedrock Recipes </label> <div class=md-nav__source> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Github: Amazon-Bedrock-Samples </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Intro to Amazon Bedrock </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Intro to Amazon Bedrock </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1> <label class=md-nav__link for=__nav_2_1_1 id=__nav_2_1_1_label tabindex=0> <span class=md-ellipsis> API Usage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> API Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/01_invoke_api/ class=md-nav__link> <span class=md-ellipsis> Invoke Model API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/04_agents_api/ class=md-nav__link> <span class=md-ellipsis> Agents API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/03_knowledgebases_api/ class=md-nav__link> <span class=md-ellipsis> Knowledge Bases API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/02_guardrails_api/ class=md-nav__link> <span class=md-ellipsis> Guardrail API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/converse_api/01_converse_api/ class=md-nav__link> <span class=md-ellipsis> Converse API Example </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Agents </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1 id=__nav_2_2_1_label tabindex=0> <span class=md-ellipsis> Amazon Bedrock Agents </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Amazon Bedrock Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/introduction-to-agents/how_to_create_custom_agents/ class=md-nav__link> <span class=md-ellipsis> How to create an Agent </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_2> <label class=md-nav__link for=__nav_2_2_1_2 id=__nav_2_2_1_2_label tabindex=0> <span class=md-ellipsis> Bedrock Agent Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_2> <span class="md-nav__icon md-icon"></span> Bedrock Agent Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/01-create-agent-with-function-definition/01-create-agent-with-function-definition/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Function Definition </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/02-create-agent-with-api-schema/02-create-agent-with-api-schema/ class=md-nav__link> <span class=md-ellipsis> Create Agent with API Schema </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/03-create-agent-with-return-of-control/03-create-agent-with-return-of-control/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Return of Control </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/04-create-agent-with-single-knowledge-base/04-create-agent-with-single-knowledge-base/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Single Knowledge Base </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/05-create-agent-with-knowledge-base-and-action-group/05-create-agent-with-knowledge-base-and-action-group/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Knowledge Base and Action Group </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/06-prompt-and-session-attributes/06-prompt-and-session-attributes/ class=md-nav__link> <span class=md-ellipsis> Prompt and Session Attributes </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/07-advanced-prompts-and-custom-parsers/07-custom-prompt-and-lambda-parsers/ class=md-nav__link> <span class=md-ellipsis> Custom Prompt and Lambda Parsers </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/08-create-agent-with-guardrails/08-create-agent-with-guardrails/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Guardrails </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/09-create-agent-with-memory/09-create-agent-with-memory/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Memory </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/10-create-agent-with-code-interpreter/10-create-agent-with-code-interpreter/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Code Interpreter </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/14-create-agent-with-custom-orchestration/custom_orchestration_example/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Custom Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/15-invoke-inline-agents/inline-agent-api-usage/ class=md-nav__link> <span class=md-ellipsis> Create Dynamic Tooling Inline Agents </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_3> <label class=md-nav__link for=__nav_2_2_1_3 id=__nav_2_2_1_3_label tabindex=0> <span class=md-ellipsis> Bedrock Flows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_3> <span class="md-nav__icon md-icon"></span> Bedrock Flows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/bedrock-flows/Getting_started_with_Prompt_Management_Flows/ class=md-nav__link> <span class=md-ellipsis> Getting Started with Prompt Management Flows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_4> <label class=md-nav__link for=__nav_2_2_1_4 id=__nav_2_2_1_4_label tabindex=0> <span class=md-ellipsis> Use Case Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_4> <span class="md-nav__icon md-icon"></span> Use Case Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/use-case-examples/text-2-sql-agent/create_and_invoke_sql_agent/ class=md-nav__link> <span class=md-ellipsis> Text to SQL Agent </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/use-case-examples/agentsforbedrock-retailagent/workshop/test_retailagent_agentsforbedrock/ class=md-nav__link> <span class=md-ellipsis> Retail Agent Workshop </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/use-case-examples/product-review-agent/main/ class=md-nav__link> <span class=md-ellipsis> Product Review Agent </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2 id=__nav_2_2_2_label tabindex=0> <span class=md-ellipsis> Function Calling </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Function Calling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/function_calling_with_converse/function_calling_with_converse/ class=md-nav__link> <span class=md-ellipsis> Function Calling with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/function_calling_with_invoke/function_calling_model_with_invoke/ class=md-nav__link> <span class=md-ellipsis> Function Calling with Invoke </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/return_of_control/return_of_control/ class=md-nav__link> <span class=md-ellipsis> Return of Control </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/tool_binding/tool_bindings/ class=md-nav__link> <span class=md-ellipsis> Tool Binding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3> <label class=md-nav__link for=__nav_2_2_3 id=__nav_2_2_3_label tabindex=0> <span class=md-ellipsis> Open Source </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> Open Source </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_1> <label class=md-nav__link for=__nav_2_2_3_1 id=__nav_2_2_3_1_label tabindex=0> <span class=md-ellipsis> CrewAI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_1> <span class="md-nav__icon md-icon"></span> CrewAI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/crew.ai/Find%20dream%20destination%20with%20CrewAI/ class=md-nav__link> <span class=md-ellipsis> Find Dream Destination with CrewAI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_2> <label class=md-nav__link for=__nav_2_2_3_2 id=__nav_2_2_3_2_label tabindex=0> <span class=md-ellipsis> LangGraph </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_2> <span class="md-nav__icon md-icon"></span> LangGraph </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-single-agent/ class=md-nav__link> <span class=md-ellipsis> LangGraph Agent with Function Calling </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-agents-multimodal/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi-Modal Agent with Function Calling </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-multi-agent-sql-tools/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/02_medibot_V3_agents/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent For Medical Chatbot </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-fact-checker-feedback-loop/ class=md-nav__link> <span class=md-ellipsis> LangGraph Fact Checker with Multi Agent </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-multi-agent-sql-tools/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/03_langgraph_agents_of_agent/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent with tools </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/Travel_planner_with_langgraph/ class=md-nav__link> <span class=md-ellipsis> Managing Memory for Multi Agents </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_3> <label class=md-nav__link for=__nav_2_2_3_3 id=__nav_2_2_3_3_label tabindex=0> <span class=md-ellipsis> Multi Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_3> <span class="md-nav__icon md-icon"></span> Multi Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/introduction-to-agents/how_to_create_multi_agents_from_custom_agents/ class=md-nav__link> <span class=md-ellipsis> Multi Agent Orchestration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> RAG </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=true> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> RAG </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1 id=__nav_2_3_1_label tabindex=0> <span class=md-ellipsis> Amazon Bedrock Knowledge Bases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Amazon Bedrock Knowledge Bases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_1> <label class=md-nav__link for=__nav_2_3_1_1 id=__nav_2_3_1_1_label tabindex=0> <span class=md-ellipsis> Zero Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_1> <span class="md-nav__icon md-icon"></span> Zero Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/00-zero-setup-chat-with-your-document/chat_with_document_kb/ class=md-nav__link> <span class=md-ellipsis> Chat with Your Document </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2 id=__nav_2_3_1_2_label tabindex=0> <span class=md-ellipsis> RAG Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> RAG Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/01-rag-concepts/01_create_ingest_documents_test_kb_multi_ds/ class=md-nav__link> <span class=md-ellipsis> Create and Ingest Documents with Multi-Data Sources </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/01-rag-concepts/02_managed_rag_custom_prompting_and_no_of_results/ class=md-nav__link> <span class=md-ellipsis> Managed RAG with Custom Prompting </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/01-rag-concepts/03_customized-rag-retreive-api-hybrid-search-claude-3-sonnet-langchain/ class=md-nav__link> <span class=md-ellipsis> Customized RAG with Claude 3 and Langchain </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/01-rag-concepts/04_customized-rag-retreive-api-langchain-claude-evaluation-ragas/ class=md-nav__link> <span class=md-ellipsis> RAG Evaluation with Langchain and RAGAS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_3> <label class=md-nav__link for=__nav_2_3_1_3 id=__nav_2_3_1_3_label tabindex=0> <span class=md-ellipsis> Optimizing Retrieval Results </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Optimizing Retrieval Results </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/advanced_chunking_options/ class=md-nav__link> <span class=md-ellipsis> Advanced Chunking Options </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/csv_metadata_customization/ class=md-nav__link> <span class=md-ellipsis> CSV Metadata Customization </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/query_reformulation/ class=md-nav__link> <span class=md-ellipsis> Query Reformulation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_4> <label class=md-nav__link for=__nav_2_3_1_4 id=__nav_2_3_1_4_label tabindex=0> <span class=md-ellipsis> Advanced Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_4> <span class="md-nav__icon md-icon"></span> Advanced Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/03-advanced-concepts/dynamic-metadata-filtering/dynamic-metadata-filtering-KB/ class=md-nav__link> <span class=md-ellipsis> Dynamic Metadata Filtering </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_4_2> <label class=md-nav__link for=__nav_2_3_1_4_2 id=__nav_2_3_1_4_2_label tabindex=0> <span class=md-ellipsis> Reranking </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_4_2> <span class="md-nav__icon md-icon"></span> Reranking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/03-advanced-concepts/reranking/01_deploy-reranking-model-sm/ class=md-nav__link> <span class=md-ellipsis> Deploy Reranking Model </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/03-advanced-concepts/reranking/02_kb-reranker/ class=md-nav__link> <span class=md-ellipsis> Knowledge Base Reranker </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/03-advanced-concepts/reranking/qa-generator/ class=md-nav__link> <span class=md-ellipsis> QA Generator </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_5> <label class=md-nav__link for=__nav_2_3_1_5 id=__nav_2_3_1_5_label tabindex=0> <span class=md-ellipsis> Responsible AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_5> <span class="md-nav__icon md-icon"></span> Responsible AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/features-examples/05-responsible-ai/contextual-grounding/ class=md-nav__link> <span class=md-ellipsis> Contextual Grounding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6> <label class=md-nav__link for=__nav_2_3_1_6 id=__nav_2_3_1_6_label tabindex=0> <span class=md-ellipsis> Use Case Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6> <span class="md-nav__icon md-icon"></span> Use Case Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6_1> <label class=md-nav__link for=__nav_2_3_1_6_1 id=__nav_2_3_1_6_1_label tabindex=0> <span class=md-ellipsis> Metadata Filter Access Control </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6_1> <span class="md-nav__icon md-icon"></span> Metadata Filter Access Control </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/use-case-examples/metadata-filter-access-control/kb-end-to-end-acl/ class=md-nav__link> <span class=md-ellipsis> End-to-End ACL with Knowledge Base </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6_2> <label class=md-nav__link for=__nav_2_3_1_6_2 id=__nav_2_3_1_6_2_label tabindex=0> <span class=md-ellipsis> RAG with Structured and Unstructured Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6_2> <span class="md-nav__icon md-icon"></span> RAG with Structured and Unstructured Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/0-create-dummy-structured-data/ class=md-nav__link> <span class=md-ellipsis> Create Dummy Structured Data </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/1_create_sql_dataset_optional/ class=md-nav__link> <span class=md-ellipsis> Create SQL Dataset (Optional) </span> </a> </li> <li class=md-nav__item> <a href=../../../knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/2_rag_with_structured_unstructured_data/ class=md-nav__link> <span class=md-ellipsis> RAG with Structured and Unstructured Data </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_2 checked> <label class=md-nav__link for=__nav_2_3_2 id=__nav_2_3_2_label tabindex=0> <span class=md-ellipsis> Open Source </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> Open Source </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../chatbots/qa_chatbot_langchain_bedrock/ class=md-nav__link> <span class=md-ellipsis> Chatbot using Langchain </span> </a> </li> <li class=md-nav__item> <a href=../../chunking/rag_chunking_strategies_langchain_bedrock/ class=md-nav__link> <span class=md-ellipsis> Chunking strategies for RAG applications </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_2_3 checked> <label class=md-nav__link for=__nav_2_3_2_3 id=__nav_2_3_2_3_label tabindex=0> <span class=md-ellipsis> Vector Stores </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_2_3_label aria-expanded=true> <label class=md-nav__title for=__nav_2_3_2_3> <span class="md-nav__icon md-icon"></span> Vector Stores </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Langchain Chatbot with Opensearch </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Model Customization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Model Customization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../custom-models/model-distillation/Historical_invocation_distillation/ class=md-nav__link> <span class=md-ellipsis> Model Distillation with Invocation Logs </span> </a> </li> <li class=md-nav__item> <a href=../../../../custom-models/model-distillation/Distillation-via-S3-input/ class=md-nav__link> <span class=md-ellipsis> Model Distillation with S3 Data </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Gen AI Usecases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Gen AI Usecases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> Text Generation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Text Generation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text_generation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Streaming Response with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_code_generation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Generate Python Code with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text_translation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Text Translation with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text-summarization-titan%2Bclaude/ class=md-nav__link> <span class=md-ellipsis> Text summarization with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_batch_example_for_multi_threaded_invocation/ class=md-nav__link> <span class=md-ellipsis> Generate Bulk Emails with Batch Inference </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Workshops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Workshops </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class=md-ellipsis> Open-source L400 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Open-source L400 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/01_usecase_introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction to the Use Case </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/02_Lab_Find%20a%20Dream%20Destination_RAG%20query/ class=md-nav__link> <span class=md-ellipsis> Advanced RAG for Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/02_travel_planner_with_langgraph/ class=md-nav__link> <span class=md-ellipsis> Conversational Memory in Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/03_travel_agent_with_tools/ class=md-nav__link> <span class=md-ellipsis> Multi-Modal and Types of Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/04_travel_booking_multi_agent/ class=md-nav__link> <span class=md-ellipsis> Multi-Agent Collaboration with Human-in-loop </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/05_dream_destination_with_crewai/ class=md-nav__link> <span class=md-ellipsis> Find Dream Destination with CrewAI </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/06_agent_evaluation_with_ragas/ class=md-nav__link> <span class=md-ellipsis> RAGAs Agents Evaluation </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/07_dynamic_tooling_agents/ class=md-nav__link> <span class=md-ellipsis> Dynamic Tool invocation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Open-source L200 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Open-source L200 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/02_contextual_text_generation/ class=md-nav__link> <span class=md-ellipsis> Introduction to the Use Case </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/03_retrieval_based_text_application/ class=md-nav__link> <span class=md-ellipsis> Retrieval Based Text Generation </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/04_retrieval_based_chat_application/ class=md-nav__link> <span class=md-ellipsis> Retrieval Based Chat Application </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/05_agent_based_text_generation/ class=md-nav__link> <span class=md-ellipsis> Agent Based Text Generation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../general/tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class=md-nav__item> <a href=../../../../general/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a href=../../../../general/tags/#rag-knowledge-bases class="md-tag md-tag-icon">RAG/ Knowledge-Bases</a> <a href=../../../../general/tags/#open-source-langchain class="md-tag md-tag-icon">Open Source/ Langchain</a> <a href=../../../../general/tags/#vector-db-opensearch class="md-tag md-tag-icon">Vector-DB/ OpenSearch</a> </nav> <h1>Langchain Chatbot with Opensearch</h1> <!-- <style>
  .md-typeset h1,
  .md-content__button {
    display: none;
  }
</style>

<h2> Build RAG solution with LangChain and Amazon Bedrock using OpenSearch Serverless</h2> --> <div class="admonition tip inline end"> <p class=admonition-title><a href=https://github.com/aws-samples/amazon-bedrock-samples/blob/main/rag/open-source/vector_stores/rag_langchain_bedrock_opensearch.ipynb target=_blank>Open in github</a></p> </div> <p>This notebook provides sample code for building a RAG solution using LangChain and Amazon Bedrock using OpenSearch Serverless.</p> <h2>Overview</h2> <p>In a RAG application, the vector store plays a crucial role in the retrieval step. When a user submits a query, the query is first converted into a vector representation using a pre-trained language model. The vector store is then searched for the most relevant documents or passages based on the similarity between their vectors and the query vector. The retrieved documents or passages are then used to generate the response.</p> <p>In this sample we will use OpenSearch Serverless to build a vector store and then use it in a RAG application using LangChain. The vector search collection type in OpenSearch Serverless provides a similarity search capability that is scalable and high performing. It makes it easy for you to build modern machine learning (ML) augmented search experiences and generative artificial intelligence (AI) applications without having to manage the underlying vector database infrastructure.</p> <p><img alt=image.png src=../assets/architecture.png></p> <h3>Steps: </h3> <ol> <li>Create necessary policies for Amazon OpenSearch Serverless</li> <li>Create an OpenSearch Serverless cluster and deploy a vector store collection</li> <li>Use the OpenSearch Serverless VectorStore as retriever in LangChain</li> <li>Create generation pipeline using <code>create_stuff_documents_chain</code></li> <li>Use the pipeline to generate response for user queries</li> </ol> <h2> Setup </h2> <p>Before running the rest of this notebook, you'll need to run the cells below to (ensure necessary libraries are installed and) connect to Bedrock.</p> <div class=highlight><pre><span></span><code><span class=o>%</span><span class=n>pip</span> <span class=n>install</span> <span class=o>-</span><span class=n>U</span> <span class=n>opensearch</span><span class=o>-</span><span class=n>py</span><span class=o>==</span><span class=mf>2.3.1</span> <span class=o>--</span><span class=n>quiet</span>
<span class=o>%</span><span class=n>pip</span> <span class=n>install</span> <span class=o>-</span><span class=n>U</span> <span class=n>boto3</span> <span class=o>--</span><span class=n>quiet</span>
<span class=o>%</span><span class=n>pip</span> <span class=n>install</span> <span class=o>-</span><span class=n>U</span> <span class=n>retrying</span><span class=o>==</span><span class=mf>1.3.4</span> <span class=o>--</span><span class=n>quiet</span>
<span class=o>%</span><span class=n>pip</span> <span class=n>install</span> <span class=o>--</span><span class=n>quiet</span> <span class=n>langchain</span> <span class=n>langchain</span><span class=o>-</span><span class=n>community</span> <span class=n>langchain_aws</span> <span class=n>bs4</span> <span class=n>pypdf</span>
<span class=o>%</span><span class=n>pip</span> <span class=n>install</span> <span class=o>--</span><span class=n>quiet</span> <span class=n>requests</span> <span class=n>requests</span><span class=o>-</span><span class=n>aws4auth</span>
</code></pre></div> <h2> 1. Create a vector store - OpenSearch Serverless index </h2> <p>First of all we have to create a vector store. In this section we will use Amazon OpenSearch serverless.</p> <p>Amazon OpenSearch Serverless is a serverless option in Amazon OpenSearch Service. As a developer, you can use OpenSearch Serverless to run petabyte-scale workloads without configuring, managing, and scaling OpenSearch clusters. You get the same interactive millisecond response times as OpenSearch Service with the simplicity of a serverless environment. Pay only for what you use by automatically scaling resources to provide the right amount of capacity for your applicationâ€”without impacting data ingestion.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>boto3</span>
<span class=kn>import</span> <span class=nn>pprint</span>

<span class=n>boto3_session</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
<span class=n>region_name</span> <span class=o>=</span> <span class=n>boto3_session</span><span class=o>.</span><span class=n>region_name</span>
<span class=n>service</span> <span class=o>=</span> <span class=s2>&quot;aoss&quot;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>vector_store_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;bedrock-sample-rag-oss&#39;</span>
<span class=n>index_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;bedrock-sample-rag-index-oss&quot;</span>
<span class=n>aoss_client</span> <span class=o>=</span> <span class=n>boto3_session</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;opensearchserverless&#39;</span><span class=p>)</span>

<span class=n>pp</span> <span class=o>=</span> <span class=n>pprint</span><span class=o>.</span><span class=n>PrettyPrinter</span><span class=p>(</span><span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</code></pre></div> <p>This code creates three security policies for an Amazon OpenSearch Serverless collection using the. The policies include an encryption policy, a network policy, and an access policy. Here's a brief description of each policy:</p> <p><strong>Encryption Policy:</strong></p> <p>This policy specifies that Amazon OpenSearch Serverless should use an AWS-owned key for encrypting the data in the specified collection. It grants the encryption permission for the specified collection.</p> <p><strong>Network Policy:</strong></p> <p>This policy allows public access to the specified collection. It grants the network access permission for the specified collection.</p> <p><strong>Access Policy:</strong></p> <p>This policy grants permissions to the specified principal (the AWS identity executing the code) to perform various operations on the collection and its associated indexes.</p> <p>For the collection, it grants permissions to create, delete, update, and describe collection items. For the indexes associated with the collection, it grants permissions to create, delete, update, and describe indexes, as well as read and write documents.</p> <div class="alert alert-block alert-info"> <b>Note:</b> These policies are defined just to run this sample. Please make sure to define these policies based on your requirements and security best practices. </div> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>json</span>


<span class=n>identity</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s2>&quot;sts&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>get_caller_identity</span><span class=p>()[</span><span class=s2>&quot;Arn&quot;</span><span class=p>]</span>

<span class=n>encryption_policy_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;bedrock-sample-rag-oss&quot;</span>
<span class=n>network_policy_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;bedrock-sample-rag-np-oss&quot;</span>
<span class=n>access_policy_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;bedrock-sample-rag-ap-oss&quot;</span>

<span class=k>def</span> <span class=nf>create_policies_in_oss</span><span class=p>(</span>
    <span class=n>vector_store_name</span><span class=p>,</span> <span class=n>aoss_client</span>
<span class=p>):</span>
    <span class=n>encryption_policy</span> <span class=o>=</span> <span class=n>aoss_client</span><span class=o>.</span><span class=n>create_security_policy</span><span class=p>(</span>
        <span class=n>name</span><span class=o>=</span><span class=n>encryption_policy_name</span><span class=p>,</span>
        <span class=n>policy</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span>
            <span class=p>{</span>
                <span class=s2>&quot;Rules&quot;</span><span class=p>:</span> <span class=p>[</span>
                    <span class=p>{</span>
                        <span class=s2>&quot;Resource&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;collection/&quot;</span> <span class=o>+</span> <span class=n>vector_store_name</span><span class=p>],</span>
                        <span class=s2>&quot;ResourceType&quot;</span><span class=p>:</span> <span class=s2>&quot;collection&quot;</span><span class=p>,</span>
                    <span class=p>}</span>
                <span class=p>],</span>
                <span class=s2>&quot;AWSOwnedKey&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
            <span class=p>}</span>
        <span class=p>),</span>
        <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;encryption&quot;</span><span class=p>,</span>
    <span class=p>)</span>

    <span class=n>network_policy</span> <span class=o>=</span> <span class=n>aoss_client</span><span class=o>.</span><span class=n>create_security_policy</span><span class=p>(</span>
        <span class=n>name</span><span class=o>=</span><span class=n>network_policy_name</span><span class=p>,</span>
        <span class=n>policy</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span>
            <span class=p>[</span>
                <span class=p>{</span>
                    <span class=s2>&quot;Rules&quot;</span><span class=p>:</span> <span class=p>[</span>
                        <span class=p>{</span>
                            <span class=s2>&quot;Resource&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;collection/&quot;</span> <span class=o>+</span> <span class=n>vector_store_name</span><span class=p>],</span>
                            <span class=s2>&quot;ResourceType&quot;</span><span class=p>:</span> <span class=s2>&quot;collection&quot;</span><span class=p>,</span>
                        <span class=p>}</span>
                    <span class=p>],</span>
                    <span class=s2>&quot;AllowFromPublic&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
                <span class=p>}</span>
            <span class=p>]</span>
        <span class=p>),</span>
        <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;network&quot;</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=n>access_policy</span> <span class=o>=</span> <span class=n>aoss_client</span><span class=o>.</span><span class=n>create_access_policy</span><span class=p>(</span>
        <span class=n>name</span><span class=o>=</span><span class=n>access_policy_name</span><span class=p>,</span>
        <span class=n>policy</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span>
            <span class=p>[</span>
                <span class=p>{</span>
                    <span class=s2>&quot;Rules&quot;</span><span class=p>:</span> <span class=p>[</span>
                        <span class=p>{</span>
                            <span class=s2>&quot;Resource&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;collection/&quot;</span> <span class=o>+</span> <span class=n>vector_store_name</span><span class=p>],</span>
                            <span class=s2>&quot;Permission&quot;</span><span class=p>:</span> <span class=p>[</span>
                                <span class=s2>&quot;aoss:CreateCollectionItems&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:DeleteCollectionItems&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:UpdateCollectionItems&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:DescribeCollectionItems&quot;</span><span class=p>,</span>
                            <span class=p>],</span>
                            <span class=s2>&quot;ResourceType&quot;</span><span class=p>:</span> <span class=s2>&quot;collection&quot;</span><span class=p>,</span>
                        <span class=p>},</span>
                        <span class=p>{</span>
                            <span class=s2>&quot;Resource&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;index/&quot;</span> <span class=o>+</span> <span class=n>vector_store_name</span> <span class=o>+</span> <span class=s2>&quot;/*&quot;</span><span class=p>],</span>
                            <span class=s2>&quot;Permission&quot;</span><span class=p>:</span> <span class=p>[</span>
                                <span class=s2>&quot;aoss:CreateIndex&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:DeleteIndex&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:UpdateIndex&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:DescribeIndex&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:ReadDocument&quot;</span><span class=p>,</span>
                                <span class=s2>&quot;aoss:WriteDocument&quot;</span><span class=p>,</span>
                            <span class=p>],</span>
                            <span class=s2>&quot;ResourceType&quot;</span><span class=p>:</span> <span class=s2>&quot;index&quot;</span><span class=p>,</span>
                        <span class=p>},</span>
                    <span class=p>],</span>
                    <span class=s2>&quot;Principal&quot;</span><span class=p>:</span> <span class=p>[</span><span class=n>identity</span><span class=p>],</span>
                    <span class=s2>&quot;Description&quot;</span><span class=p>:</span> <span class=s2>&quot;Easy data policy&quot;</span><span class=p>,</span>
                <span class=p>}</span>
            <span class=p>]</span>
        <span class=p>),</span>
        <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;data&quot;</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=n>encryption_policy</span><span class=p>,</span> <span class=n>network_policy</span><span class=p>,</span> <span class=n>access_policy</span>
</code></pre></div> <p>This code creates a new Amazon OpenSearch Serverless collection with the specified <code>vector_store_name</code> and applies the previously created security policies to it.</p> <div class=highlight><pre><span></span><code><span class=n>encryption_policy</span><span class=p>,</span> <span class=n>network_policy</span><span class=p>,</span> <span class=n>access_policy</span> <span class=o>=</span> <span class=n>create_policies_in_oss</span><span class=p>(</span>
    <span class=n>vector_store_name</span><span class=o>=</span><span class=n>vector_store_name</span><span class=p>,</span>
    <span class=n>aoss_client</span><span class=o>=</span><span class=n>aoss_client</span><span class=p>,</span>
<span class=p>)</span>
<span class=n>collection</span> <span class=o>=</span> <span class=n>aoss_client</span><span class=o>.</span><span class=n>create_collection</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=n>vector_store_name</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;VECTORSEARCH&quot;</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>collection_id</span> <span class=o>=</span> <span class=n>collection</span><span class=p>[</span><span class=s2>&quot;createCollectionDetail&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
<span class=n>collection_id</span> <span class=o>=</span> <span class=n>collection</span><span class=p>[</span><span class=s2>&quot;createCollectionDetail&quot;</span><span class=p>][</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
<span class=n>host</span> <span class=o>=</span> <span class=n>collection_id</span> <span class=o>+</span> <span class=s2>&quot;.&quot;</span> <span class=o>+</span> <span class=n>region_name</span> <span class=o>+</span> <span class=s2>&quot;.aoss.amazonaws.com&quot;</span>
<span class=nb>print</span><span class=p>(</span><span class=n>host</span><span class=p>)</span>
</code></pre></div> <pre><code>7p2nmbgokp3l2ngnkrkf.us-east-1.aoss.amazonaws.com
</code></pre> <div class=highlight><pre><span></span><code><span class=n>host</span> <span class=o>=</span> <span class=s2>&quot;7p2nmbgokp3l2ngnkrkf.us-east-1.aoss.amazonaws.com&quot;</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>time</span>

<span class=k>def</span> <span class=nf>interactive_sleep</span><span class=p>(</span><span class=n>seconds</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
    <span class=n>dots</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>seconds</span><span class=p>):</span>
        <span class=n>dots</span> <span class=o>+=</span> <span class=s2>&quot;.&quot;</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>dots</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&quot;</span><span class=se>\r</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Done!&quot;</span><span class=p>)</span>
</code></pre></div> <p>Let's setup an OpenSearch index with a vector field for similarity search using the k-Nearest Neighbors (KNN) algorithm.</p> <p><strong>Different embeddings models may have different output dimensions, and the dimension value in the mappings should be adjusted accordingly.</strong></p> <p>In this sample we are using <code>amazon.titan-embed-text-v2:0</code>, which has an output dimension of 1024.</p> <div class=highlight><pre><span></span><code><span class=c1># Create the vector index in Opensearch serverless, with the knn_vector field index mapping, specifying the dimension size, name and engine.</span>
<span class=kn>from</span> <span class=nn>opensearchpy</span> <span class=kn>import</span> <span class=n>OpenSearch</span><span class=p>,</span> <span class=n>RequestsHttpConnection</span><span class=p>,</span> <span class=n>AWSV4SignerAuth</span><span class=p>,</span> <span class=n>RequestError</span>
<span class=n>credentials</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span><span class=o>.</span><span class=n>get_credentials</span><span class=p>()</span>
<span class=n>awsauth</span> <span class=o>=</span> <span class=n>auth</span> <span class=o>=</span> <span class=n>AWSV4SignerAuth</span><span class=p>(</span><span class=n>credentials</span><span class=p>,</span> <span class=n>region_name</span><span class=p>,</span> <span class=n>service</span><span class=p>)</span>

<span class=n>index_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;bedrock-sample-index-oss&quot;</span>
<span class=n>body_json</span> <span class=o>=</span> <span class=p>{</span>
   <span class=s2>&quot;settings&quot;</span><span class=p>:</span> <span class=p>{</span>
      <span class=s2>&quot;index.knn&quot;</span><span class=p>:</span> <span class=s2>&quot;true&quot;</span><span class=p>,</span>
       <span class=s2>&quot;number_of_shards&quot;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
       <span class=s2>&quot;knn.algo_param.ef_search&quot;</span><span class=p>:</span> <span class=mi>512</span><span class=p>,</span>
       <span class=s2>&quot;number_of_replicas&quot;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
   <span class=p>},</span>
   <span class=s2>&quot;mappings&quot;</span><span class=p>:</span> <span class=p>{</span>
      <span class=s2>&quot;properties&quot;</span><span class=p>:</span> <span class=p>{</span>
         <span class=s2>&quot;vector_field&quot;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;knn_vector&quot;</span><span class=p>,</span>
            <span class=s2>&quot;dimension&quot;</span><span class=p>:</span> <span class=mi>1024</span><span class=p>,</span>
             <span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=p>{</span>
                 <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=s2>&quot;hnsw&quot;</span><span class=p>,</span>
                 <span class=s2>&quot;engine&quot;</span><span class=p>:</span> <span class=s2>&quot;faiss&quot;</span><span class=p>,</span>
                 <span class=s2>&quot;space_type&quot;</span><span class=p>:</span> <span class=s2>&quot;l2&quot;</span>
             <span class=p>},</span>
         <span class=p>},</span>
         <span class=s2>&quot;text&quot;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;text&quot;</span>
         <span class=p>},</span>
         <span class=s2>&quot;text-metadata&quot;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;text&quot;</span>         <span class=p>}</span>
      <span class=p>}</span>
   <span class=p>}</span>
<span class=p>}</span>

<span class=c1># Build the OpenSearch client</span>
<span class=n>oss_client</span> <span class=o>=</span> <span class=n>OpenSearch</span><span class=p>(</span>
    <span class=n>hosts</span><span class=o>=</span><span class=p>[{</span><span class=s1>&#39;host&#39;</span><span class=p>:</span> <span class=n>host</span><span class=p>,</span> <span class=s1>&#39;port&#39;</span><span class=p>:</span> <span class=mi>443</span><span class=p>}],</span>
    <span class=n>http_auth</span><span class=o>=</span><span class=n>awsauth</span><span class=p>,</span>
    <span class=n>use_ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>verify_certs</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>connection_class</span><span class=o>=</span><span class=n>RequestsHttpConnection</span><span class=p>,</span>
    <span class=n>timeout</span><span class=o>=</span><span class=mi>300</span>
<span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1># Create index</span>
<span class=k>try</span><span class=p>:</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>oss_client</span><span class=o>.</span><span class=n>indices</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=n>index_name</span><span class=p>,</span> <span class=n>body</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>body_json</span><span class=p>))</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Creating index:&quot;</span><span class=p>)</span>
    <span class=n>pp</span><span class=o>.</span><span class=n>pprint</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>

    <span class=c1># index creation can take up to a minute</span>
    <span class=n>interactive_sleep</span><span class=p>(</span><span class=mi>60</span><span class=p>)</span>
<span class=k>except</span> <span class=n>RequestError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
    <span class=c1># you can delete the index if its already exists</span>
    <span class=c1># oss_client.indices.delete(index=index_name)</span>
    <span class=nb>print</span><span class=p>(</span>
        <span class=sa>f</span><span class=s2>&quot;Error while trying to create the index, with error </span><span class=si>{</span><span class=n>e</span><span class=o>.</span><span class=n>error</span><span class=si>}</span><span class=se>\n</span><span class=s2>you may unmark the delete above to delete, and recreate the index&quot;</span>
    <span class=p>)</span>
</code></pre></div> <pre><code>Creating index:
{ 'acknowledged': True,
  'index': 'bedrock-sample-index-oss',
  'shards_acknowledged': True}
Done!.......................................................
</code></pre> <h2>Load Documents </h2> <p>We first need to download sample documents on which we will be building our Q&amp;A. For this sample we are downloading Amazon letter to shareholders.</p> <div class=highlight><pre><span></span><code><span class=err>!</span><span class=n>mkdir</span> <span class=o>-</span><span class=n>p</span> <span class=o>./</span><span class=n>data</span>

<span class=kn>from</span> <span class=nn>urllib.request</span> <span class=kn>import</span> <span class=n>urlretrieve</span>

<span class=n>urls</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s2>&quot;https://s2.q4cdn.com/299287126/files/doc_financials/2023/ar/2022-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
    <span class=s2>&quot;https://s2.q4cdn.com/299287126/files/doc_financials/2022/ar/2021-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
    <span class=s2>&quot;https://s2.q4cdn.com/299287126/files/doc_financials/2021/ar/Amazon-2020-Shareholder-Letter-and-1997-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
    <span class=s2>&quot;https://s2.q4cdn.com/299287126/files/doc_financials/2020/ar/2019-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
<span class=p>]</span>

<span class=n>filenames</span> <span class=o>=</span> <span class=p>[</span>
    <span class=s2>&quot;AMZN-2022-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
    <span class=s2>&quot;AMZN-2021-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
    <span class=s2>&quot;AMZN-2020-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
    <span class=s2>&quot;AMZN-2019-Shareholder-Letter.pdf&quot;</span><span class=p>,</span>
<span class=p>]</span>

<span class=n>data_root</span> <span class=o>=</span> <span class=s2>&quot;./data/&quot;</span>

<span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>url</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>urls</span><span class=p>):</span>
    <span class=n>file_path</span> <span class=o>=</span> <span class=n>data_root</span> <span class=o>+</span> <span class=n>filenames</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span>
    <span class=n>urlretrieve</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>file_path</span><span class=p>)</span>
</code></pre></div> <p>LangChain has a few different built-in document <a href=https://python.langchain.com/v0.2/docs/how_to/document_loader_pdf/ >loaders</a> to load pdf document. Below, we'll use pypdf package that reads from a filepath. </p> <ul> <li>The loader reads the PDF at the specified path into memory.</li> <li>It then extracts text data using the pypdf package.</li> <li>Finally, it creates a LangChain Document for each page of the PDF with the page's content and some metadata about where in the document the text came from.</li> </ul> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>PyPDFLoader</span>
<span class=kn>import</span> <span class=nn>os</span>

<span class=n>data_root</span> <span class=o>=</span> <span class=s2>&quot;./data/&quot;</span>
<span class=n>folder_path</span> <span class=o>=</span> <span class=n>data_root</span>
<span class=n>documents</span> <span class=o>=</span> <span class=p>[]</span>

<span class=c1># Loop through all files in the folder</span>
<span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>folder_path</span><span class=p>):</span>
    <span class=n>file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>folder_path</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span>
    <span class=n>loader</span> <span class=o>=</span> <span class=n>PyPDFLoader</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
    <span class=c1># Load the PDF data</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
    <span class=c1># Add the loaded data to the documents list</span>
    <span class=n>documents</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

<span class=c1># Print the text of the first page of the first document</span>
<span class=k>if</span> <span class=n>documents</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>documents</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>page_content</span><span class=p>)</span>
<span class=k>else</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;No PDF files found in the folder.&quot;</span><span class=p>)</span>
</code></pre></div> <pre><code>To our shareowners:
In Amazonâ€™s 1997 letter to shareholders, our first, I talked about our hope to create an â€œenduring franchise,â€
one that would reinvent what it means to serve customers by unlocking the internetâ€™s power. I noted that
Amazon had grown from having 158 employees to 614, and that we had surpassed 1.5 million customer
accounts. We had just gone public at a split-adjusted stock price of $1.50 per share. I wrote that it was Day 1.
Weâ€™ve come a long way since then, and we are working harder than ever to serve and delight customers.
Last year, we hired 500,000 employees and now directly employ 1.3 million people around the world. We have
more than 200 million Prime members worldwide. More than 1.9 million small and medium-sized businesses
sell in our store, and they make up close to 60% of our retail sales. Customers have connected more than
100 million smart home devices to Alexa. Amazon Web Services serves millions of customers and ended 2020
with a $50 billion annualized run rate. In 1997, we hadnâ€™t invented Prime, Marketplace, Alexa, or AWS.
They werenâ€™t even ideas then, and none was preordained. We took great risk with each one and put sweat
and ingenuity into each one.
Along the way, weâ€™ve created $1.6 trillion of wealth for shareowners. Who are they? Y our Chair is one, and
my Amazon shares have made me wealthy. But more than 7/8ths of the shares, representing $1.4 trillion of
wealth creation, are owned by others. Who are they? Theyâ€™re pension funds, universities, and 401(k)s, and
theyâ€™re Mary and Larry, who sent me this note out of the blue just as I was sitting down to write this
shareholder letter:
</code></pre> <h2>Indexing the documents</h2> <p>We will follow the following steps to index the documents:</p> <ul> <li>Obtain the chunked documents </li> <li>Choose an embedding model: Select a suitable embedding model that can convert the text content of each chunk into a high-dimensional vector representation. In this example we are using Amazon titan embedding model - <code>amazon.titan-embed-text-v2:0</code></li> <li>Store embeddings vector in a vector store: We will use the OpenSearch index that we have created in previous step to store the embeddings vector</li> </ul> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>langchain_text_splitters</span> <span class=kn>import</span> <span class=n>RecursiveCharacterTextSplitter</span>

<span class=n>text_splitter</span> <span class=o>=</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>chunk_overlap</span><span class=o>=</span><span class=mi>200</span><span class=p>)</span>
<span class=n>splits</span> <span class=o>=</span> <span class=n>text_splitter</span><span class=o>.</span><span class=n>split_documents</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>langchain_aws.embeddings.bedrock</span> <span class=kn>import</span> <span class=n>BedrockEmbeddings</span>

<span class=c1># ---- âš ï¸ Update region for your AWS setup âš ï¸ ----</span>
<span class=n>bedrock_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s2>&quot;bedrock-runtime&quot;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s2>&quot;us-east-1&quot;</span><span class=p>)</span>

<span class=n>embeddings_model</span> <span class=o>=</span> <span class=n>BedrockEmbeddings</span><span class=p>(</span>
    <span class=n>client</span><span class=o>=</span><span class=n>bedrock_client</span><span class=p>,</span> <span class=n>model_id</span><span class=o>=</span><span class=s2>&quot;amazon.titan-embed-text-v2:0&quot;</span>
<span class=p>)</span>
</code></pre></div> <p>Now its time to store re the embeddings in the vector store. We are going to use embedding model that we have defined in the previous step.</p> <p>For OpenSearch connection we will use AWS4Auth to provide authentication to the OpenSearch instance</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>boto3</span>
<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>from</span> <span class=nn>opensearchpy</span> <span class=kn>import</span> <span class=n>RequestsHttpConnection</span>
<span class=kn>from</span> <span class=nn>requests_aws4auth</span> <span class=kn>import</span> <span class=n>AWS4Auth</span>
<span class=kn>from</span> <span class=nn>langchain_community.vectorstores</span> <span class=kn>import</span> <span class=n>OpenSearchVectorSearch</span>

<span class=c1># ---- âš ï¸ Update profile name âš ï¸ ----</span>
<span class=n>profile_name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;AWS_PROFILE&quot;</span><span class=p>)</span>

<span class=n>credentials</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>Session</span><span class=p>(</span>
    <span class=n>profile_name</span><span class=o>=</span><span class=n>profile_name</span><span class=p>,</span>
<span class=p>)</span><span class=o>.</span><span class=n>get_credentials</span><span class=p>()</span>
<span class=n>awsauth</span> <span class=o>=</span> <span class=n>AWS4Auth</span><span class=p>(</span><span class=n>region</span><span class=o>=</span><span class=n>region_name</span><span class=p>,</span> <span class=n>service</span><span class=o>=</span><span class=n>service</span><span class=p>,</span> <span class=n>refreshable_credentials</span><span class=o>=</span><span class=n>credentials</span><span class=p>)</span>

<span class=n>docsearch</span> <span class=o>=</span> <span class=n>OpenSearchVectorSearch</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span>
    <span class=n>documents</span><span class=p>,</span>
    <span class=n>embeddings_model</span><span class=p>,</span>
    <span class=n>opensearch_url</span><span class=o>=</span><span class=n>host</span><span class=p>,</span>
    <span class=n>http_auth</span><span class=o>=</span><span class=n>awsauth</span><span class=p>,</span>
    <span class=n>timeout</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span>
    <span class=n>use_ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>verify_certs</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>connection_class</span><span class=o>=</span><span class=n>RequestsHttpConnection</span><span class=p>,</span>
    <span class=n>index_name</span><span class=o>=</span><span class=n>index_name</span><span class=p>,</span>
    <span class=n>engine</span><span class=o>=</span><span class=s2>&quot;faiss&quot;</span>
<span class=p>)</span>
</code></pre></div> <p>Now we can test if the index by passing a query to <code>similarity_search</code></p> <div class=highlight><pre><span></span><code><span class=n>docs</span> <span class=o>=</span> <span class=n>docsearch</span><span class=o>.</span><span class=n>similarity_search</span><span class=p>(</span>
    <span class=s2>&quot;What is Amazon doing in the field of generative AI?&quot;</span><span class=p>,</span>
    <span class=n>search_type</span><span class=o>=</span><span class=s2>&quot;script_scoring&quot;</span><span class=p>,</span>
    <span class=n>space_type</span><span class=o>=</span><span class=s2>&quot;cosinesimil&quot;</span><span class=p>,</span>
    <span class=n>vector_field</span><span class=o>=</span><span class=s2>&quot;vector_field&quot;</span><span class=p>,</span>
    <span class=n>text_field</span><span class=o>=</span><span class=s2>&quot;text&quot;</span><span class=p>,</span>
    <span class=n>metadata_field</span><span class=o>=</span><span class=s2>&quot;metadata&quot;</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>docs</span>
</code></pre></div> <pre><code>[Document(metadata={'source': './data/AMZN-2022-Shareholder-Letter.pdf', 'page': 6}, page_content='developer productivity by generating code suggestions in real time. I could write an entire letter on LLMs\nand Generative AI as I think they will be that transformative, but Iâ€™ll leave that for a future letter. Letâ€™s justsay that LLMs and Generative AI are going to be a big deal for customers, our shareholders, and Amazon.\nSo, in closing, Iâ€™m optimistic that weâ€™ll emerge from this challenging macroeconomic time in a stronger\nposition than when we entered it. There are several reasons for it and Iâ€™ve mentioned many of them above.But, there are two relatively simple statistics that underline our immense future opportunity. While we have aconsumer business thatâ€™s $434B in 2022, the vast majority of total market segment share in global retailstill resides in physical stores (roughly 80%). And, itâ€™s a similar story for Global IT spending, where we haveAWS revenue of $80B in 2022, with about 90% of Global IT spending still on-premises and yet to migrateto the cloud. As these equations steadily flipâ€”as weâ€™re already seeing happenâ€”we believe our leading customerexperiences, relentless invention, customer focus, and hard work will result in significant growth in thecoming years. And, of course, this doesnâ€™t include the other businesses and experiences weâ€™re pursuing atAmazon, all of which are still in their early days.\nI strongly believe that our best days are in front of us, and I look forward to working with my teammates at\nAmazon to make it so.\nSincerely,\nAndy Jassy\nPresident and Chief Executive OfficerAmazon.com, Inc.\nP .S. As we have always done, our original 1997 Shareholder Letter follows. Whatâ€™s written there is as true\ntoday as it was in 1997.'),
 Document(metadata={'source': './data/AMZN-2022-Shareholder-Letter.pdf', 'page': 3}, page_content='of the Amazon shopping experience for more than a decade. However, unlike physical retailers, Amazon\ncan tailor these sponsored products to be relevant to what customers are searching for given what we knowabout shopping behaviors and our very deep investment in machine learning algorithms. This leads toadvertising thatâ€™s more useful for customers; and as a result, performs better for brands. This is part of whyour Advertising revenue has continued to grow rapidly (23% Y oY in Q4 2022, 25% Y oY overall for 2022on a $31B revenue base), even as most large advertising-focused businessesâ€™ growth have slowed over the lastseveral quarters.\nWe strive to be the best place for advertisers to build their brands. We have near and long-term opportunities\nthat will help us achieve that mission. Weâ€™re continuing to make large investments in machine learning tokeep honing our advertising selection algorithms. For the past couple of years, weâ€™ve invested in buildingcomprehensive, flexible, and durable planning and measurement solutions, giving marketers greater insightinto advertising effectiveness. An example is Amazon Marketing Cloud (â€œAMCâ€). AMC is a â€œclean roomâ€(i.e. secure digital environment) in which advertisers can run custom audience and campaign analyticsacross a range of first and third-party inputs, in a privacy-safe manner, to generate advertising and businessinsights to inform their broader marketing and sales strategies. The Advertising and AWS teams havecollaborated to enable companies to store their data in AWS, operate securely in AMC with Amazon andother third-party data sources, perform analytics in AWS, and have the option to activate advertising onAmazon or third-party publishers through the Amazon Demand-Side Platform. Customers really like thisconcerted capability. We also see future opportunity to thoughtfully integrate advertising into our video,live sports, audio, and grocery products. Weâ€™ll continue to work hard to help brands uniquely engage withthe right audience, and grow this part of our business.\nWhile itâ€™s tempting in turbulent times only to focus on your existing large businesses, to build a sustainable,\nlong-lasting, growing company that helps customers across a large number of dimensions, you canâ€™t stop\ninventing and working on long-term customer experiences that can meaningfully impact customers andyour company.\nWhen we look at new investment opportunities, we ask ourselves a few questions:\nâ—¦If we were successful, could it be big and have a reasonable return on invested capital?\nâ—¦Is the opportunity being well-served today?\nâ—¦Do we have a differentiated approach?\nâ—¦And, do we have competence in that area? And if not, can we acquire it quickly?\nIf we like the answers to those questions, then weâ€™ll invest. This process has led to some expansions that\nseem straightforward, and others that some folks might not have initially guessed.\nThe earliest example is when we chose to expand from just selling Books , to adding categories like Music,\nVideo, Electronics, and Toys. Back then (1998-1999), it wasnâ€™t universally applauded, but in retrospect, itseems fairly obvious.\nThe same could be said for our international Stores expansion . In 2022, our international consumer segment\ndrove $118B of revenue. In our larger, established international consumer businesses, weâ€™re big enough tobe impacted by the slowing macroeconomic conditions; however, the growth in 2019-2021 on a large base wasremarkableâ€”30% compound annual growth rate (â€œCAGRâ€) in the UK, 26% in Germany, and 21% inJapan (excluding the impact of FX). Over the past several years, weâ€™ve invested in new internationalgeographies, including India, Brazil, Mexico, Australia, various European countries, the Middle East, andparts of Africa. These new countries take a certain amount of fixed investment to get started and to scale, butwe like the trajectory theyâ€™re on, and their growth patterns resemble what weâ€™ve seen in North Americaand our established international geographies. Emerging countries sometimes lack some of the infrastructureand services that our business relies on (e.g. payment methods, transportation services, and internet/telecom infrastructure). To solve these challenges, we continue to work with various partners to deliversolutions for customers. Ultimately, we believe that this investment in serving a broader geographical footprintwill allow us to help more customers across the world, as well as build a larger free cash flow-generatingconsumer business.'),
 Document(metadata={'source': './data/AMZN-2019-Shareholder-Letter.pdf', 'page': 4}, page_content='We want to improve workersâ€™ lives beyond pay. Amazon provides every full-time employee with health\ninsurance, a 401(k) plan, 20 weeks paid maternity leave, and other benefits. These are the same benefits thatAmazonâ€™s most senior executives receive. And with our rapidly changing economy, we see more clearly thanever the need for workers to evolve their skills continually to keep up with technology. Thatâ€™s why weâ€™respending $700 million to provide more than 100,000 Amazonians access to training programs, at their places ofwork, in high-demand fields such as healthcare, cloud computing, and machine learning. Since 2012, we haveoffered Career Choice, a pre-paid tuition program for fulfillment center associates looking to move into high-demand occupations. Amazon pays up to 95% of tuition and fees toward a certificate or diploma in qualifiedfields of study, leading to enhanced employment opportunities in high-demand jobs. Since its launch, more than25,000 Amazonians have received training for in-demand occupations.\nTo ensure that future generations have the skills they need to thrive in a technology-driven economy, we started a\nprogram last year called Amazon Future Engineer, which is designed to educate and train low-income anddisadvantaged young people to pursue careers in computer science. We have an ambitious goal: to help hundredsof thousands of students each year learn computer science and coding. Amazon Future Engineer currently fundsIntroduction to Computer Science and AP Computer Science classes for more than 2,000 schools in underservedcommunities across the country. Each year, Amazon Future Engineer also gives 100 four-year, $40,000 collegescholarships to computer science students from low-income backgrounds. Those scholarship recipients alsoreceive guaranteed, paid internships at Amazon after their first year of college. Our program in the UK funds 120engineering apprenticeships and helps students from disadvantaged backgrounds pursue technology careers.\nFor now, my own time and thinking continues to be focused on COVID-19 and how Amazon can help while\nweâ€™re in the middle of it. I am extremely grateful to my fellow Amazonians for all the grit and ingenuity they areshowing as we move through this. You can count on all of us to look beyond the immediate crisis for insights andlessons and how to apply them going forward.\nReflect on this from Theodor Seuss Geisel:\nâ€œWhen something bad happens you have three choices. You can either let it define you, let it\ndestroy you, or you can let it strengthen you.â€\nI am very optimistic about which of these civilization is going to choose.Even in these circumstances, it remains Day 1. As always, I attach a copy of our original 1997 letter.\nSincerely,\nJeffrey P. Bezos\nFounder and Chief Executive OfficerAmazon.com, Inc.'),
 Document(metadata={'source': './data/AMZN-2022-Shareholder-Letter.pdf', 'page': 5}, page_content='month flat fee, enables Prime members to get as many of the eligible prescription medications as they need\nfor dozens of common conditions, like high blood pressure, acid reflux, and anxiety. However, our customershave continued to express a strong desire for Amazon to provide a better alternative to the inefficient andunsatisfying broader healthcare experience. We decided to start with primary care as itâ€™s a prevalent first stopin the patient journey. We evaluated and studied the existing landscape extensively, including some early\nAmazon experiments like Amazon Care. During this process, we identified One Medicalâ€™s patient-focusedexperience as an excellent foundation upon which to build our future business; and in July 2022, we announcedour acquisition of One Medical. There are several elements that customers love about One Medical. It hasa fantastic digital app that makes it easy for patients to discuss issues with a medical practitioner via chat orvideo conference. If a physical visit is required, One Medical has offices in cities across the US wherepatients can book same or next day appointments. One Medical has relationships with specialty physiciansin each of its cities and works closely with local hospital systems to make seeing specialists easy, so OneMedical members can quickly access these resources when needed. Going forward, we strongly believethat One Medical and Amazon will continue to innovate together to change what primary care will look likefor customers.\nKuiper is another example of Amazon innovating for customers over the long term in an area where thereâ€™s\nhigh customer need. Our vision for Kuiper is to create a low-Earth orbit satellite system to deliver high-qualitybroadband internet service to places around the world that donâ€™t currently have it. There are hundreds ofmillions of households and businesses who donâ€™t have reliable access to the internet. Imagine what theyâ€™ll beable to do with reliable connectivity, from people taking online education courses, using financial services,starting their own businesses, doing their shopping, enjoying entertainment, to businesses and governmentsimproving their coverage, efficiency, and operations. Kuiper will deliver not only accessibility, butaffordability. Our teams have developed low-cost antennas (i.e. customer terminals) that will lower thebarriers to access. We recently unveiled the new terminals that will communicate with the satellites passingoverhead, and we expect to be able to produce our standard residential version for less than $400 each. Theyâ€™resmall: 11 inches square, 1 inch thick, and weigh less than 5 pounds without their mounting bracket, butthey deliver speeds up to 400 megabits per second. And theyâ€™re powered by Amazon-designed baseband chips.Weâ€™re preparing to launch two prototype satellites to test the entire end-to-end communications networkthis year, and plan to be in beta with commercial customers in 2024. The customer reaction to what weâ€™veshared thus far about Kuiper has been very positive, and we believe Kuiper represents a very large potentialopportunity for Amazon. It also shares several similarities to AWS in that itâ€™s capital intensive at the start,but has a large prospective consumer, enterprise, and government customer base, significant revenue andoperating profit potential, and relatively few companies with the technical and inventive aptitude, as well asthe investment hypothesis to go after it.\nOne final investment area that Iâ€™ll mention, thatâ€™s core to setting Amazon up to invent in every area of our\nbusiness for many decades to come, and where weâ€™re investing heavily is Large Language Models (â€œLLMsâ€)\nand Generative AI . Machine learning has been a technology with high promise for several decades, but itâ€™s\nonly been the last five to ten years that itâ€™s started to be used more pervasively by companies. This shift wasdriven by several factors, including access to higher volumes of compute capacity at lower prices than was everavailable. Amazon has been using machine learning extensively for 25 years, employing it in everythingfrom personalized ecommerce recommendations, to fulfillment center pick paths, to drones for Prime Air,to Alexa, to the many machine learning services AWS offers (where AWS has the broadest machine learningfunctionality and customer base of any cloud provider). More recently, a newer form of machine learning,called Generative AI, has burst onto the scene and promises to significantly accelerate machine learningadoption. Generative AI is based on very Large Language Models (trained on up to hundreds of billionsof parameters, and growing), across expansive datasets, and has radically general and broad recall andlearning capabilities. We have been working on our own LLMs for a while now, believe it will transform andimprove virtually every customer experience, and will continue to invest substantially in these modelsacross all of our consumer, seller, brand, and creator experiences. Additionally, as weâ€™ve done for years inAWS, weâ€™re democratizing this technology so companies of all sizes can leverage Generative AI. AWS isoffering the most price-performant machine learning chips in Trainium and Inferentia so small and largecompanies can afford to train and run their LLMs in production. We enable companies to choose fromvarious LLMs and build applications with all of the AWS security, privacy and other features that customersare accustomed to using. And, weâ€™re delivering applications like AWSâ€™s CodeWhisperer, which revolutionizes')]
</code></pre> <h2>Retriever </h2> <p>A retriever is an interface that returns documents given an unstructured query. It is more general than a vector store. A retriever does not need to be able to store documents, only to return (or retrieve) them. </p> <p>In this example we are using Maximum marginal relevance search (MMR). MMR optimizes for similarity to query AND diversity among selected documents.</p> <div class=highlight><pre><span></span><code><span class=n>retriever</span> <span class=o>=</span> <span class=n>docsearch</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(</span>
    <span class=n>search_type</span><span class=o>=</span><span class=s2>&quot;mmr&quot;</span><span class=p>,</span>
    <span class=n>search_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;k&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;fetch_k&#39;</span><span class=p>:</span> <span class=mi>50</span><span class=p>}</span>
<span class=p>)</span>
<span class=n>retrieved_docs</span> <span class=o>=</span> <span class=n>retriever</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span>
    <span class=s2>&quot;What is Amazon&#39;s doing in the field of generative AI?&quot;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Number of retrieved documents: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>retrieved_docs</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>retrieved_docs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>page_content</span><span class=p>)</span>
</code></pre></div> <pre><code>Number of retrieved documents: 5
Weâ€™ve also committed to reaching 80% renewable energy by 2024 and 100% renewable energy by 2030. (The
team is actually pushing to get to 100% by 2025 and has a challenging but credible plan to pull that off.)Globally, Amazon has 86 solar and wind projects that have the capacity to generate over 2,300 MW and delivermore than 6.3 million MWh of energy annuallyâ€”enough to power more than 580,000 U.S. homes.
Weâ€™ve made tremendous progress cutting packaging waste. More than a decade ago, we created the Frustration-
Free Packaging program to encourage manufacturers to package their products in easy-to-open, 100% recyclablepackaging that is ready to ship to customers without the need for an additional shipping box. Since 2008, thisprogram has saved more than 810,000 tons of packaging material and eliminated the use of 1.4 billion shippingboxes.
We are making these significant investments to drive our carbon footprint to zero despite the fact that shopping
online is already inherently more carbon efficient than going to the store. Amazonâ€™s sustainability scientists havespent more than three years developing the models, tools, and metrics to measure our carbon footprint. Theirdetailed analysis has found that shopping online consistently generates less carbon than driving to a store, since asingle delivery van trip can take approximately 100 roundtrip car journeys off the road on average. Our scientistsdeveloped a model to compare the carbon intensity of ordering Whole Foods Market groceries online versusdriving to your nearest Whole Foods Market store. The study found that, averaged across all basket sizes, onlinegrocery deliveries generate 43% lower carbon emissions per item compared to shopping in stores. Smaller basketsizes generate even greater carbon savings.
AWS is also inherently more efficient than the traditional in-house data center. Thatâ€™s primarily due to two
thingsâ€”higher utilization, and the fact that our servers and facilities are more efficient than what mostcompanies can achieve running their own data centers. Typical single-company data centers operate at roughly18% server utilization. They need that excess capacity to handle large usage spikes. AWS benefits from multi-tenant usage patterns and operates at far higher server utilization rates. In addition, AWS has been successful inincreasing the energy efficiency of its facilities and equipment, for instance by using more efficient evaporativecooling in certain data centers instead of traditional air conditioning. A study by 451 Research found that AWSâ€™sinfrastructure is 3.6 times more energy efficient than the median U.S. enterprise data center surveyed. Along withour use of renewable energy, these factors enable AWS to do the same tasks as traditional data centers with an88% lower carbon footprint. And donâ€™t think weâ€™re not going to get those last 12 pointsâ€”weâ€™ll make AWS 100%carbon free through more investments in renewable energy projects.
Leveraging scale for good
Over the last decade, no company has created more jobs than Amazon. Amazon directly employs 840,000
workers worldwide, including over 590,000 in the U.S., 115,000 in Europe, and 95,000 in Asia. In total, Amazondirectly and indirectly supports 2 million jobs in the U.S., including 680,000-plus jobs created by Amazonâ€™sinvestments in areas like construction, logistics, and professional services, plus another 830,000 jobs created bysmall and medium-sized businesses selling on Amazon. Globally, we support nearly 4 million jobs. We areespecially proud of the fact that many of these are entry-level jobs that give people their first opportunity toparticipate in the workforce.
And Amazonâ€™s jobs come with an industry-leading $15 minimum wage and comprehensive benefits. More than
40 million Americansâ€”many making the federal minimum wage of $7.25 an hourâ€”earn less than the lowest-paid Amazon associate. When we raised our starting minimum wage to $15 an hour in 2018, it had an immediateand meaningful impact on the hundreds of thousands of people working in our fulfillment centers. We want otherbig employers to join us by raising their own minimum pay rates, and we continue to lobby for a $15 federalminimum wage.
</code></pre> <h2> Generation </h2> <p>We will use the retriever created in above step to retrieve document text from OpenSearch and then use the LLM to generate a response. </p> <p>Weâ€™ll use Anthropic's Claude 3 Sonnet model from Amazon Bedrock as generation model, but you can also use other models from Bedrock.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>langchain_aws</span> <span class=kn>import</span> <span class=n>ChatBedrockConverse</span>

<span class=n>llm</span> <span class=o>=</span> <span class=n>ChatBedrockConverse</span><span class=p>(</span>
    <span class=n>client</span><span class=o>=</span><span class=n>bedrock_client</span><span class=p>,</span>
    <span class=n>model_id</span><span class=o>=</span><span class=s2>&quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;</span>
<span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>langchain.chains</span> <span class=kn>import</span> <span class=n>create_retrieval_chain</span>
<span class=kn>from</span> <span class=nn>langchain.chains.combine_documents</span> <span class=kn>import</span> <span class=n>create_stuff_documents_chain</span>
<span class=kn>from</span> <span class=nn>langchain_core.prompts</span> <span class=kn>import</span> <span class=n>ChatPromptTemplate</span>

<span class=n>system_prompt</span> <span class=o>=</span> <span class=p>(</span>
    <span class=s2>&quot;You are an assistant for question-answering tasks. &quot;</span>
    <span class=s2>&quot;Use the following pieces of retrieved context to answer &quot;</span>
    <span class=s2>&quot;the question. If you don&#39;t know the answer, say that you &quot;</span>
    <span class=s2>&quot;don&#39;t know. Use three sentences maximum and keep the &quot;</span>
    <span class=s2>&quot;answer concise.&quot;</span>
    <span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>&quot;</span>
    <span class=s2>&quot;</span><span class=si>{context}</span><span class=s2>&quot;</span>
<span class=p>)</span>

<span class=n>prompt</span> <span class=o>=</span> <span class=n>ChatPromptTemplate</span><span class=o>.</span><span class=n>from_messages</span><span class=p>(</span>
    <span class=p>[</span>
        <span class=p>(</span><span class=s2>&quot;system&quot;</span><span class=p>,</span> <span class=n>system_prompt</span><span class=p>),</span>
        <span class=p>(</span><span class=s2>&quot;human&quot;</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{input}</span><span class=s2>&quot;</span><span class=p>),</span>
    <span class=p>]</span>
<span class=p>)</span>


<span class=n>question_answer_chain</span> <span class=o>=</span> <span class=n>create_stuff_documents_chain</span><span class=p>(</span><span class=n>llm</span><span class=p>,</span> <span class=n>prompt</span><span class=p>)</span>
<span class=n>rag_chain</span> <span class=o>=</span> <span class=n>create_retrieval_chain</span><span class=p>(</span><span class=n>retriever</span><span class=p>,</span> <span class=n>question_answer_chain</span><span class=p>)</span>

<span class=n>results</span> <span class=o>=</span> <span class=n>rag_chain</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span>
    <span class=p>{</span><span class=s2>&quot;input&quot;</span><span class=p>:</span> <span class=s2>&quot;What is Amazon&#39;s doing in the field of generative AI?&quot;</span><span class=p>}</span>
<span class=p>)</span>

<span class=n>results</span>
</code></pre></div> <pre><code>{'input': "What is Amazon's doing in the field of generative AI?",
 'context': [Document(metadata={'source': './data/AMZN-2022-Shareholder-Letter.pdf', 'page': 5}, page_content='month flat fee, enables Prime members to get as many of the eligible prescription medications as they need\nfor dozens of common conditions, like high blood pressure, acid reflux, and anxiety. However, our customershave continued to express a strong desire for Amazon to provide a better alternative to the inefficient andunsatisfying broader healthcare experience. We decided to start with primary care as itâ€™s a prevalent first stopin the patient journey. We evaluated and studied the existing landscape extensively, including some early\nAmazon experiments like Amazon Care. During this process, we identified One Medicalâ€™s patient-focusedexperience as an excellent foundation upon which to build our future business; and in July 2022, we announcedour acquisition of One Medical. There are several elements that customers love about One Medical. It hasa fantastic digital app that makes it easy for patients to discuss issues with a medical practitioner via chat orvideo conference. If a physical visit is required, One Medical has offices in cities across the US wherepatients can book same or next day appointments. One Medical has relationships with specialty physiciansin each of its cities and works closely with local hospital systems to make seeing specialists easy, so OneMedical members can quickly access these resources when needed. Going forward, we strongly believethat One Medical and Amazon will continue to innovate together to change what primary care will look likefor customers.\nKuiper is another example of Amazon innovating for customers over the long term in an area where thereâ€™s\nhigh customer need. Our vision for Kuiper is to create a low-Earth orbit satellite system to deliver high-qualitybroadband internet service to places around the world that donâ€™t currently have it. There are hundreds ofmillions of households and businesses who donâ€™t have reliable access to the internet. Imagine what theyâ€™ll beable to do with reliable connectivity, from people taking online education courses, using financial services,starting their own businesses, doing their shopping, enjoying entertainment, to businesses and governmentsimproving their coverage, efficiency, and operations. Kuiper will deliver not only accessibility, butaffordability. Our teams have developed low-cost antennas (i.e. customer terminals) that will lower thebarriers to access. We recently unveiled the new terminals that will communicate with the satellites passingoverhead, and we expect to be able to produce our standard residential version for less than $400 each. Theyâ€™resmall: 11 inches square, 1 inch thick, and weigh less than 5 pounds without their mounting bracket, butthey deliver speeds up to 400 megabits per second. And theyâ€™re powered by Amazon-designed baseband chips.Weâ€™re preparing to launch two prototype satellites to test the entire end-to-end communications networkthis year, and plan to be in beta with commercial customers in 2024. The customer reaction to what weâ€™veshared thus far about Kuiper has been very positive, and we believe Kuiper represents a very large potentialopportunity for Amazon. It also shares several similarities to AWS in that itâ€™s capital intensive at the start,but has a large prospective consumer, enterprise, and government customer base, significant revenue andoperating profit potential, and relatively few companies with the technical and inventive aptitude, as well asthe investment hypothesis to go after it.\nOne final investment area that Iâ€™ll mention, thatâ€™s core to setting Amazon up to invent in every area of our\nbusiness for many decades to come, and where weâ€™re investing heavily is Large Language Models (â€œLLMsâ€)\nand Generative AI . Machine learning has been a technology with high promise for several decades, but itâ€™s\nonly been the last five to ten years that itâ€™s started to be used more pervasively by companies. This shift wasdriven by several factors, including access to higher volumes of compute capacity at lower prices than was everavailable. Amazon has been using machine learning extensively for 25 years, employing it in everythingfrom personalized ecommerce recommendations, to fulfillment center pick paths, to drones for Prime Air,to Alexa, to the many machine learning services AWS offers (where AWS has the broadest machine learningfunctionality and customer base of any cloud provider). More recently, a newer form of machine learning,called Generative AI, has burst onto the scene and promises to significantly accelerate machine learningadoption. Generative AI is based on very Large Language Models (trained on up to hundreds of billionsof parameters, and growing), across expansive datasets, and has radically general and broad recall andlearning capabilities. We have been working on our own LLMs for a while now, believe it will transform andimprove virtually every customer experience, and will continue to invest substantially in these modelsacross all of our consumer, seller, brand, and creator experiences. Additionally, as weâ€™ve done for years inAWS, weâ€™re democratizing this technology so companies of all sizes can leverage Generative AI. AWS isoffering the most price-performant machine learning chips in Trainium and Inferentia so small and largecompanies can afford to train and run their LLMs in production. We enable companies to choose fromvarious LLMs and build applications with all of the AWS security, privacy and other features that customersare accustomed to using. And, weâ€™re delivering applications like AWSâ€™s CodeWhisperer, which revolutionizes'),
  Document(metadata={'source': './data/AMZN-2019-Shareholder-Letter.pdf', 'page': 3}, page_content='Weâ€™ve also committed to reaching 80% renewable energy by 2024 and 100% renewable energy by 2030. (The\nteam is actually pushing to get to 100% by 2025 and has a challenging but credible plan to pull that off.)Globally, Amazon has 86 solar and wind projects that have the capacity to generate over 2,300 MW and delivermore than 6.3 million MWh of energy annuallyâ€”enough to power more than 580,000 U.S. homes.\nWeâ€™ve made tremendous progress cutting packaging waste. More than a decade ago, we created the Frustration-\nFree Packaging program to encourage manufacturers to package their products in easy-to-open, 100% recyclablepackaging that is ready to ship to customers without the need for an additional shipping box. Since 2008, thisprogram has saved more than 810,000 tons of packaging material and eliminated the use of 1.4 billion shippingboxes.\nWe are making these significant investments to drive our carbon footprint to zero despite the fact that shopping\nonline is already inherently more carbon efficient than going to the store. Amazonâ€™s sustainability scientists havespent more than three years developing the models, tools, and metrics to measure our carbon footprint. Theirdetailed analysis has found that shopping online consistently generates less carbon than driving to a store, since asingle delivery van trip can take approximately 100 roundtrip car journeys off the road on average. Our scientistsdeveloped a model to compare the carbon intensity of ordering Whole Foods Market groceries online versusdriving to your nearest Whole Foods Market store. The study found that, averaged across all basket sizes, onlinegrocery deliveries generate 43% lower carbon emissions per item compared to shopping in stores. Smaller basketsizes generate even greater carbon savings.\nAWS is also inherently more efficient than the traditional in-house data center. Thatâ€™s primarily due to two\nthingsâ€”higher utilization, and the fact that our servers and facilities are more efficient than what mostcompanies can achieve running their own data centers. Typical single-company data centers operate at roughly18% server utilization. They need that excess capacity to handle large usage spikes. AWS benefits from multi-tenant usage patterns and operates at far higher server utilization rates. In addition, AWS has been successful inincreasing the energy efficiency of its facilities and equipment, for instance by using more efficient evaporativecooling in certain data centers instead of traditional air conditioning. A study by 451 Research found that AWSâ€™sinfrastructure is 3.6 times more energy efficient than the median U.S. enterprise data center surveyed. Along withour use of renewable energy, these factors enable AWS to do the same tasks as traditional data centers with an88% lower carbon footprint. And donâ€™t think weâ€™re not going to get those last 12 pointsâ€”weâ€™ll make AWS 100%carbon free through more investments in renewable energy projects.\nLeveraging scale for good\nOver the last decade, no company has created more jobs than Amazon. Amazon directly employs 840,000\nworkers worldwide, including over 590,000 in the U.S., 115,000 in Europe, and 95,000 in Asia. In total, Amazondirectly and indirectly supports 2 million jobs in the U.S., including 680,000-plus jobs created by Amazonâ€™sinvestments in areas like construction, logistics, and professional services, plus another 830,000 jobs created bysmall and medium-sized businesses selling on Amazon. Globally, we support nearly 4 million jobs. We areespecially proud of the fact that many of these are entry-level jobs that give people their first opportunity toparticipate in the workforce.\nAnd Amazonâ€™s jobs come with an industry-leading $15 minimum wage and comprehensive benefits. More than\n40 million Americansâ€”many making the federal minimum wage of $7.25 an hourâ€”earn less than the lowest-paid Amazon associate. When we raised our starting minimum wage to $15 an hour in 2018, it had an immediateand meaningful impact on the hundreds of thousands of people working in our fulfillment centers. We want otherbig employers to join us by raising their own minimum pay rates, and we continue to lobby for a $15 federalminimum wage.'),
  Document(metadata={'source': './data/AMZN-2022-Shareholder-Letter.pdf', 'page': 6}, page_content='developer productivity by generating code suggestions in real time. I could write an entire letter on LLMs\nand Generative AI as I think they will be that transformative, but Iâ€™ll leave that for a future letter. Letâ€™s justsay that LLMs and Generative AI are going to be a big deal for customers, our shareholders, and Amazon.\nSo, in closing, Iâ€™m optimistic that weâ€™ll emerge from this challenging macroeconomic time in a stronger\nposition than when we entered it. There are several reasons for it and Iâ€™ve mentioned many of them above.But, there are two relatively simple statistics that underline our immense future opportunity. While we have aconsumer business thatâ€™s $434B in 2022, the vast majority of total market segment share in global retailstill resides in physical stores (roughly 80%). And, itâ€™s a similar story for Global IT spending, where we haveAWS revenue of $80B in 2022, with about 90% of Global IT spending still on-premises and yet to migrateto the cloud. As these equations steadily flipâ€”as weâ€™re already seeing happenâ€”we believe our leading customerexperiences, relentless invention, customer focus, and hard work will result in significant growth in thecoming years. And, of course, this doesnâ€™t include the other businesses and experiences weâ€™re pursuing atAmazon, all of which are still in their early days.\nI strongly believe that our best days are in front of us, and I look forward to working with my teammates at\nAmazon to make it so.\nSincerely,\nAndy Jassy\nPresident and Chief Executive OfficerAmazon.com, Inc.\nP .S. As we have always done, our original 1997 Shareholder Letter follows. Whatâ€™s written there is as true\ntoday as it was in 1997.'),
  Document(metadata={'source': './data/AMZN-2021-Shareholder-Letter.pdf', 'page': 3}, page_content='Prime Video : We started in 2006 with an offering called Amazon Unbox where customers could download\nabout a thousand movies from major studios. This made sense as bandwidth was slower those days (it wouldtake an hour to download a video). But, as bandwidth got much faster to peopleâ€™s homes and mobiledevices, along with the advent of connected TVs, streaming was going to be a much better customer solution,and we focused our efforts on streaming. In 2011, we started offering over 5,000 streaming movies andshows as part of customersâ€™ Amazon Prime subscriptions. Initially, all of our content was produced by otherstudios and entertainment companies. These deals were expensive, country-specific, and only available tous for a limited period; so, to expand our options, we started creating our own original shows. Our early effortsincluded short-lived shows like Alpha House andBetas , before we had our first award-winning series in\nTransparent , and eventually created multi-year franchises in The Marvelous Mrs. Maisel ,The Boys ,Bosch ,\nandJack Ryan . Along the way, weâ€™ve learned a lot about producing compelling entertainment with memorable\nmoments and using machine learning and other inventive technology to provide a superior-quality streamingexperience (with useful, relevant data about actors, TV shows, movies, music, or sports stats a click awayin our unique X-Ray feature). Y ou might have seen some of this in action in our recent new hit series, Reacher ,\nand youâ€™ll hopefully see it in our upcoming Lord of the Rings series launch (coming Labor Day 2022). Wealso expect that youâ€™ll see this iterative invention when we launch Thursday Night Football , the NFLâ€™s first\nweekly, prime time, streaming-only broadcast, airing exclusively on Prime Video starting in September2022. Our agreement with the NFL is for 11 years, and we will work relentlessly over the next several yearsto reinvent the NFL viewing experience for football fans.\nThis track record of frequent invention is not only why more sports entities are choosing to work with\nPrime Video, but also why so many large entertainment companies have become Prime Video Channelspartners. Channels is a program that enables entertainment companies to leverage Prime Videoâ€™s uniquetechnology and viewing experience, as well as its very large member base to offer monthly subscriptions totheir content. Companies like Warner Bros. Discovery, Paramount, Starz, Corus Entertainment, and Globohave found that theyâ€™re driving substantial incremental membership and better customer experiencethrough Channels. While there is so much progress in Prime Video from where we started, we have moreinvention in front of us in the next 15 years than the last 15â€”and our team is passionately committed toproviding customers with the most expansive collection of compelling content anywhere in the world.\nThis same sort of iterative invention can be applied to efforts supporting people and communities. Last\nsummer, we added two new Leadership Principles: Strive to be Earthâ€™s Best Employer andSuccess and Scale\nBring Broad Responsibility . These concepts were always implicit at Amazon, but explicit Leadership\nPrinciples help us ask ourselvesâ€”and empower more Amazonians at all levels to askâ€”whether weâ€™re livingup to these principles.\nFor example, more than a million Amazonians work in our fulfillment network. In 2018, we championed\nthe $15 minimum wage (which is more than double the federal minimum wage), but havenâ€™t stopped there. Wecontinued to increase compensation such that our average starting hourly salary is currently over $18.Along with this compensation, we offer very robust benefits, including full health insurance, a 401K plan,up to 20 weeks of parental leave, and full tuition coverage for associates who want to get a college education(whether they remain with us or not). Weâ€™re not close to being done in how we improve the lives of ouremployees. Weâ€™ve researched and created a list of what we believe are the top 100 employee experience painpoints and are systematically solving them. Weâ€™re also passionate about further improving safety in ourfulfillment network, with a focus on reducing strains, sprains, falls, and repetitive stress injuries. Our injuryrates are sometimes misunderstood. We have operations jobs that fit both the â€œwarehousingâ€ and â€œcourierand deliveryâ€ categories. In the last U.S. public numbers, our recordable incident rates were a little higherthan the average of our warehousing peers (6.4 vs. 5.5), and a little lower than the average of our courier anddelivery peers (7.6 vs. 9.1). This makes us about average relative to peers, but we donâ€™t seek to be average.We want to be best in class. When I first started in my new role, I spent significant time in our fulfillmentcenters and with our safety team, and hoped there might be a silver bullet that could change the numbersquickly. I didnâ€™t find that. At our scale (we hired over 300,000 people in 2021 alone, many of whom were newto this sort of work and needed training), it takes rigorous analysis, thoughtful problem-solving, and awillingness to invent to get to where you want. Weâ€™ve been dissecting every process path to discern how wecan further improve. We have a variety of programs in flight (e.g. rotational programs that help employeesavoid spending too much time doing the same repetitive motions, wearables that prompt employees when'),
  Document(metadata={'source': './data/AMZN-2021-Shareholder-Letter.pdf', 'page': 2}, page_content='Everybody agreed that having a persistent block store was important to a complete compute service;\nhowever, to have one ready would take an extra year. The question became could we offer customers auseful service where they could get meaningful value before we had all the features we thought they wanted?We decided that the initial launch of EC2 could be feature-poor if we also organized ourselves to listen tocustomers and iterate quickly. This approach works well if you indeed iterate quickly; but, is disastrous if youcanâ€™t. We launched EC2 in 2006 with one instance size, in one data center, in one region of the world, withLinux operating system instances only (no Windows), without monitoring, load balancing, auto-scaling, oryes, persistent storage. EC2 was an initial success, but nowhere near the multi-billion-dollar service itâ€™sbecome until we added the missing capabilities listed above, and then some.\nIn the early days of AWS, people sometimes asked us why compute wouldnâ€™t just be an undifferentiated\ncommodity. But, thereâ€™s a lot more to compute than just a server. Customers want various flavors of compute(e.g. server configurations optimized for storage, memory, high-performance compute, graphics rendering,machine learning), multiple form factors (e.g. fixed instance sizes, portable containers, serverless functions),various sizes and optimizations of persistent storage, and a slew of networking capabilities. Then, thereâ€™sthe CPU chip that runs in your compute. For many years, the industry had used Intel or AMD x86 processors.We have important partnerships with these companies, but realized that if we wanted to push price andperformance further (as customers requested), weâ€™d have to develop our own chips, too. Our first generalizedchip was Graviton, which we announced in 2018. This helped a subset of customer workloads run morecost-effectively than prior options. But, it wasnâ€™t until 2020, after taking the learnings from Graviton and\ninnovating on a new chip, that we had something remarkable with our Graviton2 chip, which provides up to40% better price-performance than the comparable latest generation x86 processors. Think about howmuch of an impact 40% improvement on compute is. Compute is used for every bit of technology. Thatâ€™s ahuge deal for customers. And, while Graviton2 has been a significant success thus far (48 of the top 50 AWSEC2 customers have already adopted it), the AWS Chips team was already learning from what customerssaid could be better, and announced Graviton3 this past December (offering a 25% improvement on top ofGraviton2â€™s relative gains). The list of what weâ€™ve invented and delivered for customers in EC2 (and AWS ingeneral) is pretty mind-boggling, and this iterative approach to innovation has not only given customersmuch more functionality in AWS than they can find anywhere else (which is a significant differentiator), butalso allowed us to arrive at the much more game-changing offering that AWS is today.\nDevices : Our first foray into devices was the Kindle, released in 2007. It was not the most sophisticated\nindustrial design (it was creamy white in color and the corners were uncomfortable for some people to hold),but revolutionary because it offered customers the ability to download any of over 90,000 books (nowmillions) in 60 secondsâ€”and we got better and faster at building attractive designs. Shortly thereafter, welaunched a tablet, and then a phone (with the distinguishing feature of having front-facing cameras and agyroscope to give customers a dynamic perspective along with varied 3D experiences). The phone wasunsuccessful, and though we determined we were probably too late to this party and directed these resourceselsewhere, we hired some fantastic long-term builders and learned valuable lessons from this failure thathave served us well in devices like Echo and FireTV .\nWhen I think of the first Echo deviceâ€”and what Alexa could do for customers at that pointâ€”it was\nnoteworthy, yet so much less capable than whatâ€™s possible today. Today, there are hundreds of millions ofAlexa-enabled devices out there (in homes, offices, cars, hotel rooms, Amazon Echo devices, and third-partymanufacturer devices); you can listen to musicâ€”or watch videos now; you can control your lights andhome automation; you can create routines like â€œStart My Dayâ€ where Alexa tells you the weather, yourestimated commute time based on current traffic, then plays the news; you can easily order retail items onAmazon; you can get general or customized news, updates on sporting events and related statsâ€”and weâ€™re stillquite early with respect to what Alexa and Alexa-related devices will do for customers. Our goal is forAlexa to be the worldâ€™s most helpful and resourceful personal assistant, who makes peopleâ€™s lives meaningfullyeasier and better. We have a lot more inventing and iterating to go, but customers continue to indicate thatweâ€™re on the right path. We have several other devices at varying stages of evolution (e.g. Ring and Blinkprovide the leading digital home security solutions, Astro is a brand new home robot that we just launchedin late 2021), but itâ€™s safe to say that every one of our devices, whether youâ€™re talking about Kindle, FireTV,Alexa/Echo, Ring, Blink, or Astro is an invention-in-process with a lot more coming that will keepimproving customersâ€™ lives.')],
 'answer': 'According to the letter, Amazon is heavily investing in large language models (LLMs) and generative AI. Some key points:\n\n- Amazon believes generative AI based on large language models will "significantly accelerate machine learning adoption" and "transform and improve virtually every customer experience."\n\n- Amazon has been working on developing its own large language models for a while now. \n\n- Like with other AI technologies, Amazon plans to democratize generative AI through AWS so companies of all sizes can leverage it, offering price-performant chips like Trainium and Inferentia to run LLMs cost-effectively.\n\n- AWS is delivering applications powered by generative AI, like the CodeWhisperer tool that generates code suggestions in real-time to boost developer productivity.\n\n- The letter states "I could write an entire letter on LLMs and Generative AI as I think they will be that transformative" for Amazon\'s customers, shareholders and Amazon itself, signaling Amazon\'s major focus on this technology area.\n\nIn summary, Amazon views generative AI as highly promising and transformative, and is investing heavily through research into LLMs as well as offering generative AI services and applications to customers and third-parties via AWS.'}
</code></pre> <h2> Conclusion </h2> <p>In this notebook, we've successfully built a RAG solution using LangChain, Amazon Bedrock, and OpenSearch Serverless. We've covered the following key steps:</p> <ul> <li>Created necessary policies for Amazon OpenSearch Serverless</li> <li>Set up an OpenSearch Serverless cluster and deployed a vector store collection</li> <li>Loaded and indexed documents into the vector store</li> <li>Implemented search using OpenSearch Serverless</li> <li>Created a generation pipeline using Claude 3 Sonnet model from Amazon Bedrock</li> </ul> <h2>Next steps </h2> <ul> <li>Metadata filtering</li> <li>Experiment with Different search methods - https://opensearch.org/docs/latest/search-plugins/vector-search/</li> <li>Implement Re-ranking</li> </ul> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by <a href="https://github.com/aws-samples/amazon-bedrock-samples/issues/new?title=[Online Feedback]: Short-Summary-of-Issue&body=Page URL: /rag/open-source/vector_stores/rag_langchain_bedrock_opensearch/" target=_blank rel=noopener>creating an issue</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../chunking/rag_chunking_strategies_langchain_bedrock/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Chunking strategies for RAG applications"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Chunking strategies for RAG applications </div> </div> </a> <a href=../../../../custom-models/model-distillation/Historical_invocation_distillation/ class="md-footer__link md-footer__link--next" aria-label="Next: Model Distillation with Invocation Logs"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Model Distillation with Invocation Logs </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved. </div> </div> <div class=md-social> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["tags", "toc.integrate", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "search.highlight", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "tags": {"Compatibility": "compat"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.88dd0f4e.min.js></script> <script src=../../../../javascript/feedback.js></script> </body> </html>