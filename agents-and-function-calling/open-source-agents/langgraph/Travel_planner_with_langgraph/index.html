<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Amazon Bedrock cookbook website"><meta name=author content=Bedrock-GTM><link href=https://github.amazon-bedrock-samples.com/agents-and-function-calling/open-source-agents/langgraph/Travel_planner_with_langgraph/ rel=canonical><link href=../03_langgraph_agents_of_agent/ rel=prev><link href=../../../introduction-to-agents/how_to_create_multi_agents_from_custom_agents/ rel=next><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>Managing Memory for Multi Agents - Amazon Bedrock Recipes</title><link rel=stylesheet href=../../../../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#building-a-travel-planner-with-a-simple-langgraph class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="Amazon Bedrock Recipes" class="md-header__button md-logo" aria-label="Amazon Bedrock Recipes" data-md-component=logo> <img src=../../../../logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Amazon Bedrock Recipes </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Managing Memory for Multi Agents </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=purple aria-hidden=true type=radio name=__palette id=__palette_0> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Github: Amazon-Bedrock-Samples </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="Amazon Bedrock Recipes" class="md-nav__button md-logo" aria-label="Amazon Bedrock Recipes" data-md-component=logo> <img src=../../../../logo.png alt=logo> </a> Amazon Bedrock Recipes </label> <div class=md-nav__source> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Github: Amazon-Bedrock-Samples </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Intro to Amazon Bedrock </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Intro to Amazon Bedrock </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1> <label class=md-nav__link for=__nav_2_1_1 id=__nav_2_1_1_label tabindex=0> <span class=md-ellipsis> API Usage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> API Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/01_invoke_api/ class=md-nav__link> <span class=md-ellipsis> Invoke Model API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/04_agents_api/ class=md-nav__link> <span class=md-ellipsis> Agents API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/03_knowledgebases_api/ class=md-nav__link> <span class=md-ellipsis> Knowledge Bases API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/02_guardrails_api/ class=md-nav__link> <span class=md-ellipsis> Guardrail API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/converse_api/01_converse_api/ class=md-nav__link> <span class=md-ellipsis> Converse API Example </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2 checked> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Agents </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1 id=__nav_2_2_1_label tabindex=0> <span class=md-ellipsis> Amazon Bedrock Agents </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Amazon Bedrock Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../introduction-to-agents/how_to_create_custom_agents/ class=md-nav__link> <span class=md-ellipsis> How to create an Agent </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_2> <label class=md-nav__link for=__nav_2_2_1_2 id=__nav_2_2_1_2_label tabindex=0> <span class=md-ellipsis> Bedrock Agent Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_2> <span class="md-nav__icon md-icon"></span> Bedrock Agent Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/01-create-agent-with-function-definition/01-create-agent-with-function-definition/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Function Definition </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/02-create-agent-with-api-schema/02-create-agent-with-api-schema/ class=md-nav__link> <span class=md-ellipsis> Create Agent with API Schema </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/03-create-agent-with-return-of-control/03-create-agent-with-return-of-control/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Return of Control </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/04-create-agent-with-single-knowledge-base/04-create-agent-with-single-knowledge-base/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Single Knowledge Base </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/05-create-agent-with-knowledge-base-and-action-group/05-create-agent-with-knowledge-base-and-action-group/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Knowledge Base and Action Group </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/06-prompt-and-session-attributes/06-prompt-and-session-attributes/ class=md-nav__link> <span class=md-ellipsis> Prompt and Session Attributes </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/07-advanced-prompts-and-custom-parsers/07-custom-prompt-and-lambda-parsers/ class=md-nav__link> <span class=md-ellipsis> Custom Prompt and Lambda Parsers </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/08-create-agent-with-guardrails/08-create-agent-with-guardrails/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Guardrails </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/09-create-agent-with-memory/09-create-agent-with-memory/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Memory </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/10-create-agent-with-code-interpreter/10-create-agent-with-code-interpreter/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Code Interpreter </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/14-create-agent-with-custom-orchestration/custom_orchestration_example/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Custom Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/features-examples/15-invoke-inline-agents/inline-agent-api-usage/ class=md-nav__link> <span class=md-ellipsis> Create Dynamic Tooling Inline Agents </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_3> <label class=md-nav__link for=__nav_2_2_1_3 id=__nav_2_2_1_3_label tabindex=0> <span class=md-ellipsis> Bedrock Flows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_3> <span class="md-nav__icon md-icon"></span> Bedrock Flows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../bedrock-agents/bedrock-flows/Getting_started_with_Prompt_Management_Flows/ class=md-nav__link> <span class=md-ellipsis> Getting Started with Prompt Management Flows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_4> <label class=md-nav__link for=__nav_2_2_1_4 id=__nav_2_2_1_4_label tabindex=0> <span class=md-ellipsis> Use Case Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_4> <span class="md-nav__icon md-icon"></span> Use Case Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../bedrock-agents/use-case-examples/text-2-sql-agent/create_and_invoke_sql_agent/ class=md-nav__link> <span class=md-ellipsis> Text to SQL Agent </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/use-case-examples/agentsforbedrock-retailagent/workshop/test_retailagent_agentsforbedrock/ class=md-nav__link> <span class=md-ellipsis> Retail Agent Workshop </span> </a> </li> <li class=md-nav__item> <a href=../../../bedrock-agents/use-case-examples/product-review-agent/main/ class=md-nav__link> <span class=md-ellipsis> Product Review Agent </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2 id=__nav_2_2_2_label tabindex=0> <span class=md-ellipsis> Function Calling </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Function Calling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../function-calling/function_calling_with_converse/function_calling_with_converse/ class=md-nav__link> <span class=md-ellipsis> Function Calling with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../function-calling/function_calling_with_invoke/function_calling_model_with_invoke/ class=md-nav__link> <span class=md-ellipsis> Function Calling with Invoke </span> </a> </li> <li class=md-nav__item> <a href=../../../function-calling/return_of_control/return_of_control/ class=md-nav__link> <span class=md-ellipsis> Return of Control </span> </a> </li> <li class=md-nav__item> <a href=../../../function-calling/tool_binding/tool_bindings/ class=md-nav__link> <span class=md-ellipsis> Tool Binding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3 checked> <label class=md-nav__link for=__nav_2_2_3 id=__nav_2_2_3_label tabindex=0> <span class=md-ellipsis> Open Source </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_3_label aria-expanded=true> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> Open Source </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_1> <label class=md-nav__link for=__nav_2_2_3_1 id=__nav_2_2_3_1_label tabindex=0> <span class=md-ellipsis> CrewAI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_1> <span class="md-nav__icon md-icon"></span> CrewAI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../crew.ai/Find%20dream%20destination%20with%20CrewAI/ class=md-nav__link> <span class=md-ellipsis> Find Dream Destination with CrewAI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_2 checked> <label class=md-nav__link for=__nav_2_2_3_2 id=__nav_2_2_3_2_label tabindex=0> <span class=md-ellipsis> LangGraph </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2_2_3_2> <span class="md-nav__icon md-icon"></span> LangGraph </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../langgraph-single-agent/ class=md-nav__link> <span class=md-ellipsis> LangGraph Agent with Function Calling </span> </a> </li> <li class=md-nav__item> <a href=../langgraph-agents-multimodal/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi-Modal Agent with Function Calling </span> </a> </li> <li class=md-nav__item> <a href=../langgraph-multi-agent-sql-tools/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../02_medibot_V3_agents/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent For Medical Chatbot </span> </a> </li> <li class=md-nav__item> <a href=../langgraph-fact-checker-feedback-loop/ class=md-nav__link> <span class=md-ellipsis> LangGraph Fact Checker with Multi Agent </span> </a> </li> <li class=md-nav__item> <a href=../langgraph-multi-agent-sql-tools/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../03_langgraph_agents_of_agent/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent with tools </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Managing Memory for Multi Agents </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Managing Memory for Multi Agents </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#intro-to-agents class=md-nav__link> <span class=md-ellipsis> Intro to Agents </span> </a> <nav class=md-nav aria-label="Intro to Agents"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#memory-management class=md-nav__link> <span class=md-ellipsis> Memory Management </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#use-case-details class=md-nav__link> <span class=md-ellipsis> Use Case Details </span> </a> <nav class=md-nav aria-label="Use Case Details"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#setup-and-imports class=md-nav__link> <span class=md-ellipsis> Setup and Imports </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#langgraph-state-graph-nodes-and-edges class=md-nav__link> <span class=md-ellipsis> LangGraph -- State Graph, Nodes and Edges </span> </a> <nav class=md-nav aria-label="LangGraph -- State Graph, Nodes and Edges"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#define-agent-state class=md-nav__link> <span class=md-ellipsis> Define Agent State </span> </a> </li> <li class=md-nav__item> <a href=#key-components class=md-nav__link> <span class=md-ellipsis> Key Components </span> </a> <nav class=md-nav aria-label="Key Components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#advanced-concepts class=md-nav__link> <span class=md-ellipsis> Advanced concepts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#memory class=md-nav__link> <span class=md-ellipsis> Memory </span> </a> </li> <li class=md-nav__item> <a href=#define-agent-nodes class=md-nav__link> <span class=md-ellipsis> Define Agent Nodes </span> </a> </li> <li class=md-nav__item> <a href=#set-up-language-model-and-prompts class=md-nav__link> <span class=md-ellipsis> Set Up Language Model and Prompts </span> </a> </li> <li class=md-nav__item> <a href=#define-the-nodes-and-edges class=md-nav__link> <span class=md-ellipsis> Define the nodes and Edges </span> </a> </li> <li class=md-nav__item> <a href=#create-and-compile-the-graph class=md-nav__link> <span class=md-ellipsis> Create and Compile the Graph </span> </a> </li> <li class=md-nav__item> <a href=#display-the-graph-structure class=md-nav__link> <span class=md-ellipsis> Display the graph structure </span> </a> </li> <li class=md-nav__item> <a href=#define-the-function-that-runs-the-graph class=md-nav__link> <span class=md-ellipsis> Define the function that runs the graph </span> </a> </li> <li class=md-nav__item> <a href=#travel-planner-example class=md-nav__link> <span class=md-ellipsis> Travel Planner Example </span> </a> <nav class=md-nav aria-label="Travel Planner Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#leverage-the-memory-saver-to-manipulate-the-graph-state class=md-nav__link> <span class=md-ellipsis> Leverage the memory saver to manipulate the Graph State </span> </a> </li> <li class=md-nav__item> <a href=#run-with-another-session class=md-nav__link> <span class=md-ellipsis> Run with another session </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#explore-external-store-for-memory class=md-nav__link> <span class=md-ellipsis> Explore External Store for memory </span> </a> <nav class=md-nav aria-label="Explore External Store for memory"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-store class=md-nav__link> <span class=md-ellipsis> Create a Store </span> </a> </li> <li class=md-nav__item> <a href=#quick-look-at-how-to-use-this-store class=md-nav__link> <span class=md-ellipsis> Quick look at how to use this store </span> </a> </li> <li class=md-nav__item> <a href=#create-the-similiar-graph-as-earlier-note-we-will-not-have-any-mesages-in-the-graph-state-as-that-has-been-externalized class=md-nav__link> <span class=md-ellipsis> Create the similiar graph as earlier -- note we will not have any mesages in the Graph state as that has been externalized </span> </a> </li> <li class=md-nav__item> <a href=#quick-look-at-the-store class=md-nav__link> <span class=md-ellipsis> Quick look at the store </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#finally-we-review-the-concept-of-having-ecah-agent-be-backed-by-its-own-memory class=md-nav__link> <span class=md-ellipsis> Finally we review the concept of having Ecah Agent be backed by it's own memory </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> Conclusion </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_3> <label class=md-nav__link for=__nav_2_2_3_3 id=__nav_2_2_3_3_label tabindex=0> <span class=md-ellipsis> Multi Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_3> <span class="md-nav__icon md-icon"></span> Multi Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../introduction-to-agents/how_to_create_multi_agents_from_custom_agents/ class=md-nav__link> <span class=md-ellipsis> Multi Agent Orchestration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> RAG </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> RAG </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1 id=__nav_2_3_1_label tabindex=0> <span class=md-ellipsis> Amazon Bedrock Knowledge Bases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Amazon Bedrock Knowledge Bases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_1> <label class=md-nav__link for=__nav_2_3_1_1 id=__nav_2_3_1_1_label tabindex=0> <span class=md-ellipsis> Zero Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_1> <span class="md-nav__icon md-icon"></span> Zero Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/00-zero-setup-chat-with-your-document/chat_with_document_kb/ class=md-nav__link> <span class=md-ellipsis> Chat with Your Document </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2 id=__nav_2_3_1_2_label tabindex=0> <span class=md-ellipsis> RAG Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> RAG Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/01_create_ingest_documents_test_kb_multi_ds/ class=md-nav__link> <span class=md-ellipsis> Create and Ingest Documents with Multi-Data Sources </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/02_managed_rag_custom_prompting_and_no_of_results/ class=md-nav__link> <span class=md-ellipsis> Managed RAG with Custom Prompting </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/03_customized-rag-retreive-api-hybrid-search-claude-3-sonnet-langchain/ class=md-nav__link> <span class=md-ellipsis> Customized RAG with Claude 3 and Langchain </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/04_customized-rag-retreive-api-langchain-claude-evaluation-ragas/ class=md-nav__link> <span class=md-ellipsis> RAG Evaluation with Langchain and RAGAS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_3> <label class=md-nav__link for=__nav_2_3_1_3 id=__nav_2_3_1_3_label tabindex=0> <span class=md-ellipsis> Optimizing Retrieval Results </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Optimizing Retrieval Results </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/advanced_chunking_options/ class=md-nav__link> <span class=md-ellipsis> Advanced Chunking Options </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/csv_metadata_customization/ class=md-nav__link> <span class=md-ellipsis> CSV Metadata Customization </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/query_reformulation/ class=md-nav__link> <span class=md-ellipsis> Query Reformulation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_4> <label class=md-nav__link for=__nav_2_3_1_4 id=__nav_2_3_1_4_label tabindex=0> <span class=md-ellipsis> Advanced Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_4> <span class="md-nav__icon md-icon"></span> Advanced Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/dynamic-metadata-filtering/dynamic-metadata-filtering-KB/ class=md-nav__link> <span class=md-ellipsis> Dynamic Metadata Filtering </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_4_2> <label class=md-nav__link for=__nav_2_3_1_4_2 id=__nav_2_3_1_4_2_label tabindex=0> <span class=md-ellipsis> Reranking </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_4_2> <span class="md-nav__icon md-icon"></span> Reranking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/reranking/01_deploy-reranking-model-sm/ class=md-nav__link> <span class=md-ellipsis> Deploy Reranking Model </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/reranking/02_kb-reranker/ class=md-nav__link> <span class=md-ellipsis> Knowledge Base Reranker </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/reranking/qa-generator/ class=md-nav__link> <span class=md-ellipsis> QA Generator </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_5> <label class=md-nav__link for=__nav_2_3_1_5 id=__nav_2_3_1_5_label tabindex=0> <span class=md-ellipsis> Responsible AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_5> <span class="md-nav__icon md-icon"></span> Responsible AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/05-responsible-ai/contextual-grounding/ class=md-nav__link> <span class=md-ellipsis> Contextual Grounding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6> <label class=md-nav__link for=__nav_2_3_1_6 id=__nav_2_3_1_6_label tabindex=0> <span class=md-ellipsis> Use Case Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6> <span class="md-nav__icon md-icon"></span> Use Case Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6_1> <label class=md-nav__link for=__nav_2_3_1_6_1 id=__nav_2_3_1_6_1_label tabindex=0> <span class=md-ellipsis> Metadata Filter Access Control </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6_1> <span class="md-nav__icon md-icon"></span> Metadata Filter Access Control </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/metadata-filter-access-control/kb-end-to-end-acl/ class=md-nav__link> <span class=md-ellipsis> End-to-End ACL with Knowledge Base </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6_2> <label class=md-nav__link for=__nav_2_3_1_6_2 id=__nav_2_3_1_6_2_label tabindex=0> <span class=md-ellipsis> RAG with Structured and Unstructured Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6_2> <span class="md-nav__icon md-icon"></span> RAG with Structured and Unstructured Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/0-create-dummy-structured-data/ class=md-nav__link> <span class=md-ellipsis> Create Dummy Structured Data </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/1_create_sql_dataset_optional/ class=md-nav__link> <span class=md-ellipsis> Create SQL Dataset (Optional) </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/2_rag_with_structured_unstructured_data/ class=md-nav__link> <span class=md-ellipsis> RAG with Structured and Unstructured Data </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2 id=__nav_2_3_2_label tabindex=0> <span class=md-ellipsis> Open Source </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> Open Source </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/open-source/chatbots/qa_chatbot_langchain_bedrock/ class=md-nav__link> <span class=md-ellipsis> Chatbot using Langchain </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/open-source/chunking/rag_chunking_strategies_langchain_bedrock/ class=md-nav__link> <span class=md-ellipsis> Chunking strategies for RAG applications </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_2_3> <label class=md-nav__link for=__nav_2_3_2_3 id=__nav_2_3_2_3_label tabindex=0> <span class=md-ellipsis> Vector Stores </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_2_3> <span class="md-nav__icon md-icon"></span> Vector Stores </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/open-source/vector_stores/rag_langchain_bedrock_opensearch/ class=md-nav__link> <span class=md-ellipsis> Langchain Chatbot with Opensearch </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Model Customization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Model Customization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../custom-models/model-distillation/Historical_invocation_distillation/ class=md-nav__link> <span class=md-ellipsis> Model Distillation with Invocation Logs </span> </a> </li> <li class=md-nav__item> <a href=../../../../custom-models/model-distillation/Distillation-via-S3-input/ class=md-nav__link> <span class=md-ellipsis> Model Distillation with S3 Data </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Gen AI Usecases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Gen AI Usecases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> Text Generation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Text Generation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text_generation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Streaming Response with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_code_generation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Generate Python Code with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text_translation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Text Translation with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text-summarization-titan%2Bclaude/ class=md-nav__link> <span class=md-ellipsis> Text summarization with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_batch_example_for_multi_threaded_invocation/ class=md-nav__link> <span class=md-ellipsis> Generate Bulk Emails with Batch Inference </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Workshops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Workshops </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class=md-ellipsis> Open-source L400 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Open-source L400 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/01_usecase_introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction to the Use Case </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/02_Lab_Find%20a%20Dream%20Destination_RAG%20query/ class=md-nav__link> <span class=md-ellipsis> Advanced RAG for Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/02_travel_planner_with_langgraph/ class=md-nav__link> <span class=md-ellipsis> Conversational Memory in Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/03_travel_agent_with_tools/ class=md-nav__link> <span class=md-ellipsis> Multi-Modal and Types of Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/04_travel_booking_multi_agent/ class=md-nav__link> <span class=md-ellipsis> Multi-Agent Collaboration with Human-in-loop </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/05_dream_destination_with_crewai/ class=md-nav__link> <span class=md-ellipsis> Find Dream Destination with CrewAI </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/06_agent_evaluation_with_ragas/ class=md-nav__link> <span class=md-ellipsis> RAGAs Agents Evaluation </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/07_dynamic_tooling_agents/ class=md-nav__link> <span class=md-ellipsis> Dynamic Tool invocation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Open-source L200 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Open-source L200 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/02_contextual_text_generation/ class=md-nav__link> <span class=md-ellipsis> Introduction to the Use Case </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/03_retrieval_based_text_application/ class=md-nav__link> <span class=md-ellipsis> Retrieval Based Text Generation </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/04_retrieval_based_chat_application/ class=md-nav__link> <span class=md-ellipsis> Retrieval Based Chat Application </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/05_agent_based_text_generation/ class=md-nav__link> <span class=md-ellipsis> Agent Based Text Generation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../general/tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class=md-nav__item> <a href=../../../../general/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=building-a-travel-planner-with-a-simple-langgraph>Building a Travel Planner with a Simple LangGraph</h1> <h2 id=overview>Overview</h2> <p>This lab guides you through the process of creating a simple Travel Planner using LangGraph, a library for building stateful, multi-step applications with language models. The Travel Planner demonstrates how to structure a conversational AI application that collects user input and generates personalized travel itineraries.</p> <h2 id=intro-to-agents>Intro to Agents</h2> <ul> <li>Agents are leverage LLM to <code>think step by step</code> and then plan the execution</li> <li>Agents have access to tools</li> <li>Agents have access to memory. Below diagram illustrates this concept</li> </ul> <h4 id=memory-management>Memory Management</h4> <p>Memory is key for any agentic conversation which is <code>Multi-Turn</code> or <code>Multi-Agent</code> colloboration conversation and more so if it spans multiple days. The 3 main aspects of Agents are: 1. Tools 2. Memory 3. Planners</p> <ul> <li><img alt="Agent memory" src=../images/agents_memory_light.png></li> </ul> <h2 id=use-case-details>Use Case Details</h2> <p>Our Travel Planner follows a straightforward, three-step process:</p> <ol> <li><strong>Initial User Input</strong>: </li> <li>The application prompts the user to enter their desired travel plan to get assistance from AI Agent.</li> <li> <p>This information is stored in the state.</p> </li> <li> <p><strong>Interests Input</strong>:</p> </li> <li>The user is asked to provide their interests for the trip.</li> <li> <p>These interests are stored as a list in the state.</p> </li> <li> <p><strong>Itinerary Creation</strong>:</p> </li> <li>Using the collected city and interests, the application leverages a language model to generate a personalized day trip itinerary.</li> <li>The generated itinerary is presented to the user.</li> </ol> <p>The flow between these steps is managed by LangGraph, which handles the state transitions and ensures that each step is executed in the correct order.</p> <p>The below diagram illustrates this:</p> <p><img alt="Travel Planner Agent" src=../images/agents_itinerary.png></p> <div class=highlight><pre><span></span><code><span class=c1># %pip install -U --no-cache-dir  \</span>
<span class=c1># langchain&gt;=0.3.7 \ </span>
<span class=c1># langchain-anthropic&gt;=0.1.15 \</span>
<span class=c1># langchain-aws&gt;=0.2.6 \</span>
<span class=c1># langchain-community&gt;=0.3.5 \</span>
<span class=c1># langchain-core&gt;=0.3.15 \</span>
<span class=c1># langchain-text-splitters&gt;=0.3.2 \</span>
<span class=c1># langchainhub&gt;=0.1.20 \</span>
<span class=c1># langgraph&gt;=0.2.45 \</span>
<span class=c1># langgraph-checkpoint&gt;=2.0.2 \</span>
<span class=c1># langgraph-sdk&gt;=0.1.35 \</span>
<span class=c1># langsmith&gt;=0.1.140 \</span>
<span class=c1># sqlalchemy -U \</span>
<span class=c1># &quot;faiss-cpu&gt;=1.7,&lt;2&quot; \</span>
<span class=c1># &quot;pypdf&gt;=3.8,&lt;4&quot; \</span>
<span class=c1># &quot;ipywidgets&gt;=7,&lt;8&quot; \</span>
<span class=c1># matplotlib&gt;=3.9.0 \</span>

<span class=c1>#%pip install -U --no-cache-dir transformers</span>
<span class=c1>#%pip install -U --no-cache-dir boto3</span>
<span class=c1>#%pip install grandalf==3.1.2</span>
</code></pre></div> <h3 id=setup-and-imports>Setup and Imports</h3> <p>First, let's import the necessary modules and set up our environment.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>os</span>
<span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>TypedDict</span><span class=p>,</span> <span class=n>Annotated</span><span class=p>,</span> <span class=n>List</span>
<span class=kn>from</span> <span class=nn>langgraph.graph</span> <span class=kn>import</span> <span class=n>StateGraph</span><span class=p>,</span> <span class=n>END</span>
<span class=kn>from</span> <span class=nn>langchain_core.messages</span> <span class=kn>import</span> <span class=n>HumanMessage</span><span class=p>,</span> <span class=n>AIMessage</span>
<span class=kn>from</span> <span class=nn>langchain_core.prompts</span> <span class=kn>import</span> <span class=n>ChatPromptTemplate</span>
<span class=kn>from</span> <span class=nn>langchain_core.runnables.graph</span> <span class=kn>import</span> <span class=n>MermaidDrawMethod</span>
<span class=kn>from</span> <span class=nn>IPython.display</span> <span class=kn>import</span> <span class=n>display</span><span class=p>,</span> <span class=n>Image</span>
<span class=kn>from</span> <span class=nn>dotenv</span> <span class=kn>import</span> <span class=n>load_dotenv</span>
<span class=kn>import</span> <span class=nn>os</span>
<span class=c1>#load_dotenv()</span>
</code></pre></div> <h2 id=langgraph-state-graph-nodes-and-edges>LangGraph -- State Graph, Nodes and Edges</h2> <p>First, we are initializing the <code>StateGraph</code>. This object will encapsulate the graph being traversed during excecution.</p> <p>Then we define the <strong>nodes</strong> in our graph. In LangGraph, nodes are typically python functions. There are two main nodes we will use for our graph: - The agent node: responsible for deciding what (if any) actions to take. - The tool node: This node will orchestrate calling the respective tool and returning the output. This means if the agent decides to take an action, this node will then execute that action.</p> <p><strong>Edges</strong> define how the logic is routed and how the graph decides to stop. This is a big part of how your agents work and how different nodes communicate with each other. There are a few key types of edges:</p> <ul> <li>Normal Edges: Go directly from one node to the next.</li> <li>Conditional Edges: Call a function to determine which node(s) to go to next.</li> <li>Entry Point: Which node to call first when user input arrives.</li> <li>Conditional Entry Point: Call a function to determine which node(s) to call first when user input arrives.</li> </ul> <p>In our case we need to define a conditional edge that routes to the <code>ToolNode</code> when a tool get called in the agent node, i.e. when the LLM determines the requirement of tool use. With <code>tools_condition</code>, LangGraph provides a preimplemented function handling this. Further, an edge from the <code>START</code>node to the <code>assistant</code>and from the <code>ToolNode</code> back to the <code>assistant</code> are required.</p> <p>We are adding the nodes, edges as well as a persistant memory to the <code>StateGraph</code> before we compile it. </p> <h3 id=define-agent-state>Define Agent State</h3> <p>We'll define the state that our agent will maintain throughout its operation. First, define the <a href=https://langchain-ai.github.io/langgraph/concepts/low_level/#state>State</a> of the graph. The State schema serves as the input schema for all Nodes and Edges in the graph.</p> <p>Let's use the <code>TypedDict</code> class from python's <code>typing</code> module as our schema, which provides type hints for the keys.</p> <h3 id=key-components>Key Components</h3> <ol> <li><strong>StateGraph</strong>: The core of our application, defining the flow of our Travel Planner.</li> <li><strong>PlannerState</strong>: A custom type representing the state of our planning process.</li> <li><strong>Node Functions</strong>: Individual steps in our planning process (input_city, input_interests, create_itinerary).</li> <li><strong>LLM Integration</strong>: Utilizing a language model to generate the final itinerary.</li> <li><strong>Memory Integration</strong>: Utilizing long term and short term memory for conversations</li> </ol> <h4 id=advanced-concepts>Advanced concepts</h4> <p>Now we'll define the main functions nodes that our agent will use: get interests, create itinerary. </p> <ul> <li><a href=https://langchain-ai.github.io/langgraph/concepts/low_level/#nodes>Nodes</a> are python functions.</li> <li>The first positional argument is the state, as defined above. </li> <li>State is a <code>TypedDict</code> with schema as defined above, each node can access the key, <code>graph_state</code>, with <code>state['graph_state']</code>. </li> <li>Each node returns a new value of the state key <code>graph_state</code>.</li> </ul> <p>By default, the new value returned by each node <a href=https://langchain-ai.github.io/langgraph/concepts/low_level/#reducers>will override</a> the prior state value.</p> <h3 id=memory>Memory</h3> <ol> <li>We will disscuss memory is detail in subsequent sections below how some some key points</li> <li>We have <code>Conversational Memory</code> which is needed for all agents to have context since this is a <code>ChatBot</code> which needs history of conversations</li> <li>We usually summarize these into a <strong>Summary Conversation</strong> alternating with Human | AI for multi session conversations</li> <li>We have the concept of Graph State which is for Async workflows where we need to resume the workflow from a <strong>certain point</strong> in history</li> </ol> <p>For <code>A-Sync</code> workflows where we need to persist the state of the graph and bring it back once we get the required data. below diagram explains this concept. </p> <p><img alt="Graph state" src=../images/graph_state_light.png></p> <h3 id=define-agent-nodes>Define Agent Nodes</h3> <p>we will create a simple graph with - user travel plans - invoke with Bedrock - generate the travel plan for the day - ability to add or modify the plan</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>PlannerState</span><span class=p>(</span><span class=n>TypedDict</span><span class=p>):</span>
    <span class=n>messages</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=n>HumanMessage</span> <span class=o>|</span> <span class=n>AIMessage</span><span class=p>],</span> <span class=s2>&quot;The messages in the conversation&quot;</span><span class=p>]</span>
    <span class=n>itinerary</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>city</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span>
</code></pre></div> <h3 id=set-up-language-model-and-prompts>Set Up Language Model and Prompts</h3> <div class=highlight><pre><span></span><code><span class=c1>#llm = ChatOpenAI(model=&quot;gpt-4o-mini&quot;)</span>

<span class=kn>from</span> <span class=nn>langchain_aws</span> <span class=kn>import</span> <span class=n>ChatBedrockConverse</span>
<span class=kn>from</span> <span class=nn>langchain_aws</span> <span class=kn>import</span> <span class=n>ChatBedrock</span>
<span class=kn>import</span> <span class=nn>boto3</span>
<span class=kn>from</span> <span class=nn>langgraph.checkpoint.memory</span> <span class=kn>import</span> <span class=n>MemorySaver</span>
<span class=kn>from</span> <span class=nn>langchain_core.runnables.config</span> <span class=kn>import</span> <span class=n>RunnableConfig</span>
<span class=kn>from</span> <span class=nn>langchain_core.chat_history</span> <span class=kn>import</span> <span class=n>InMemoryChatMessageHistory</span>
<span class=kn>from</span> <span class=nn>langchain_core.output_parsers</span> <span class=kn>import</span> <span class=n>StrOutputParser</span>
<span class=kn>from</span> <span class=nn>langchain_core.prompts</span> <span class=kn>import</span> <span class=n>ChatPromptTemplate</span>
<span class=kn>from</span> <span class=nn>langchain_core.runnables.history</span> <span class=kn>import</span> <span class=n>RunnableWithMessageHistory</span>
<span class=kn>from</span> <span class=nn>langchain_core.prompts</span> <span class=kn>import</span> <span class=n>ChatPromptTemplate</span><span class=p>,</span> <span class=n>MessagesPlaceholder</span>

<span class=c1># ----  Update region for your AWS setup  ----</span>
<span class=n>bedrock_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s2>&quot;bedrock-runtime&quot;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s2>&quot;us-east-1&quot;</span><span class=p>)</span>
<span class=n>model_id</span> <span class=o>=</span> <span class=s2>&quot;anthropic.claude-3-haiku-20240307-v1:0&quot;</span>
<span class=c1>#model_id = &quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;#</span>
<span class=c1>#model_id=&quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;</span>

<span class=n>provider_id</span> <span class=o>=</span> <span class=s2>&quot;anthropic&quot;</span>

<span class=n>llm</span> <span class=o>=</span> <span class=n>ChatBedrockConverse</span><span class=p>(</span>
    <span class=n>model</span><span class=o>=</span><span class=n>model_id</span><span class=p>,</span>
    <span class=n>provider</span><span class=o>=</span><span class=n>provider_id</span><span class=p>,</span>
    <span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
    <span class=n>max_tokens</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>client</span><span class=o>=</span><span class=n>bedrock_client</span><span class=p>,</span>
    <span class=c1># other params...</span>
<span class=p>)</span>


<span class=n>itinerary_prompt</span> <span class=o>=</span> <span class=n>ChatPromptTemplate</span><span class=o>.</span><span class=n>from_messages</span><span class=p>([</span>
    <span class=p>(</span><span class=s2>&quot;system&quot;</span><span class=p>,</span> <span class=s2>&quot;You are a helpful travel assistant. Create a day trip itinerary for </span><span class=si>{city}</span><span class=s2> based on the user&#39;s interests. Use the below chat conversation and the latest input from Human to get the user interests. Provide a brief, bulleted itinerary.&quot;</span><span class=p>),</span>
    <span class=n>MessagesPlaceholder</span><span class=p>(</span><span class=s2>&quot;chat_history&quot;</span><span class=p>),</span>
    <span class=p>(</span><span class=s2>&quot;human&quot;</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{user_message}</span><span class=s2>&quot;</span><span class=p>),</span>
<span class=p>])</span>
</code></pre></div> <h3 id=define-the-nodes-and-edges>Define the nodes and Edges</h3> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>input_interests</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>PlannerState</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PlannerState</span><span class=p>:</span>
    <span class=n>user_message</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>]</span> <span class=c1>#input(&quot;Your input: &quot;)</span>
    <span class=c1>#print(f&quot;We are going to :: {user_message}:: for trip to {state[&#39;city&#39;]} based on your interests mentioned in the prompt....&quot;)</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>state</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;messages&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=p>:</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;messages&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>return</span> <span class=p>{</span>
        <span class=o>**</span><span class=n>state</span><span class=p>,</span>
    <span class=p>}</span>

<span class=k>def</span> <span class=nf>create_itinerary</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>PlannerState</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PlannerState</span><span class=p>:</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>llm</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=n>itinerary_prompt</span><span class=o>.</span><span class=n>format_messages</span><span class=p>(</span><span class=n>city</span><span class=o>=</span><span class=n>state</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>],</span> <span class=n>user_message</span><span class=o>=</span><span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>],</span> <span class=n>chat_history</span><span class=o>=</span><span class=n>state</span><span class=p>[</span><span class=s1>&#39;messages&#39;</span><span class=p>]))</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Final Itinerary:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
    <span class=k>return</span> <span class=p>{</span>
        <span class=o>**</span><span class=n>state</span><span class=p>,</span>
        <span class=s2>&quot;messages&quot;</span><span class=p>:</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;messages&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=n>HumanMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>]),</span><span class=n>AIMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)],</span>
        <span class=s2>&quot;itinerary&quot;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>content</span>
    <span class=p>}</span>
</code></pre></div> <h3 id=create-and-compile-the-graph>Create and Compile the Graph</h3> <p>Now we'll create our LangGraph workflow and compile it. We build the graph from our <a href=https://langchain-ai.github.io/langgraph/concepts/low_level/ >components</a> defined above. The <a href=https://langchain-ai.github.io/langgraph/concepts/low_level/#stategraph>StateGraph class</a> is the graph class that we can use.</p> <p>First, we initialize a StateGraph with the <code>State</code> class we defined above. Then, we add our nodes and edges. We use the <a href=https://langchain-ai.github.io/langgraph/concepts/low_level/#start-node><code>START</code> Node, a special node</a> that sends user input to the graph, to indicate where to start our graph. The <a href=https://langchain-ai.github.io/langgraph/concepts/low_level/#end-node><code>END</code> Node</a> is a special node that represents a terminal node. </p> <div class=highlight><pre><span></span><code><span class=n>workflow</span> <span class=o>=</span> <span class=n>StateGraph</span><span class=p>(</span><span class=n>PlannerState</span><span class=p>)</span>

<span class=c1>#workflow.add_node(&quot;input_city&quot;, input_city)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>,</span> <span class=n>input_interests</span><span class=p>)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;create_itinerary&quot;</span><span class=p>,</span> <span class=n>create_itinerary</span><span class=p>)</span>

<span class=n>workflow</span><span class=o>.</span><span class=n>set_entry_point</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>)</span>

<span class=c1>#workflow.add_edge(&quot;input_city&quot;, &quot;input_interests&quot;)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>,</span> <span class=s2>&quot;create_itinerary&quot;</span><span class=p>)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=s2>&quot;create_itinerary&quot;</span><span class=p>,</span> <span class=n>END</span><span class=p>)</span>

<span class=c1># The checkpointer lets the graph persist its state</span>
<span class=c1># this is a complete memory for the entire graph.</span>
<span class=n>memory</span> <span class=o>=</span> <span class=n>MemorySaver</span><span class=p>()</span>
<span class=n>app</span> <span class=o>=</span> <span class=n>workflow</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>checkpointer</span><span class=o>=</span><span class=n>memory</span><span class=p>)</span>
</code></pre></div> <h3 id=display-the-graph-structure>Display the graph structure</h3> <p>Finally, we <a href=https://langchain-ai.github.io/langgraph/concepts/low_level/#compiling-your-graph>compile our graph</a> to perform a few basic checks on the graph structure. We can visualize the graph as a <a href=https://github.com/mermaid-js/mermaid>Mermaid diagram</a>.</p> <div class=highlight><pre><span></span><code><span class=n>display</span><span class=p>(</span>
    <span class=n>Image</span><span class=p>(</span>
        <span class=n>app</span><span class=o>.</span><span class=n>get_graph</span><span class=p>()</span><span class=o>.</span><span class=n>draw_mermaid_png</span><span class=p>(</span>
            <span class=n>draw_method</span><span class=o>=</span><span class=n>MermaidDrawMethod</span><span class=o>.</span><span class=n>API</span><span class=p>,</span>
        <span class=p>)</span>
    <span class=p>)</span>
<span class=p>)</span>
</code></pre></div> <p><img alt=jpeg src=Travel_planner_with_langgraph_files/Travel_planner_with_langgraph_14_0.jpg></p> <h3 id=define-the-function-that-runs-the-graph>Define the function that runs the graph</h3> <p>When we compile the graph, we turn it into a LangChain Runnable, which automatically enables calling <code>.invoke()</code>, <code>.stream()</code> and <code>.batch()</code> with your inputs. In the following example, we run <code>stream()</code> to invoke the graph with inputs</p> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>config_dict</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Current User Request: </span><span class=si>{</span><span class=n>user_request</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=n>init_input</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;user_message&quot;</span><span class=p>:</span> <span class=n>user_request</span><span class=p>,</span><span class=s2>&quot;city&quot;</span> <span class=p>:</span> <span class=s2>&quot;Seattle&quot;</span><span class=p>}</span>

    <span class=k>for</span> <span class=n>output</span> <span class=ow>in</span> <span class=n>app</span><span class=o>.</span><span class=n>stream</span><span class=p>(</span><span class=n>init_input</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config_dict</span><span class=p>,</span> <span class=n>stream_mode</span><span class=o>=</span><span class=s2>&quot;values&quot;</span><span class=p>):</span>
        <span class=k>pass</span>  <span class=c1># The nodes themselves now handle all printing</span>
</code></pre></div> <h3 id=travel-planner-example>Travel Planner Example</h3> <ul> <li>To run this the system prompts and asks for user input for activities </li> <li>We have initialized the graph state with city Seattle which usually will be dynamic and we will see in subsequrnt labs</li> <li>You can enter like boating, swiming</li> </ul> <div class=highlight><pre><span></span><code><span class=n>config</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;configurable&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;thread_id&quot;</span><span class=p>:</span> <span class=s2>&quot;1&quot;</span><span class=p>}}</span>

<span class=n>user_request</span> <span class=o>=</span> <span class=s2>&quot;Can you create a itinerary for boating, swim. Need a complete plan&quot;</span>
<span class=n>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</code></pre></div> <pre><code>Current User Request: Can you create a itinerary for boating, swim. Need a complete plan


Final Itinerary:
Okay, based on your interest in boating and swimming, here is a suggested day trip itinerary for Seattle:

Seattle Day Trip Itinerary:

Morning:
- Start your day at Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.
- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.

Afternoon: 
- Head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.
- Have lunch at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.

Late Afternoon:
- Visit Seacrest Park in West Seattle, which has a public swimming pool, beach access, and a fishing pier. Spend time swimming, relaxing on the beach, or trying your luck at fishing.
- As the day winds down, take the West Seattle Water Taxi back to downtown Seattle, enjoying the skyline views.

Evening:
- For dinner, consider a seafood-focused restaurant like Ivar's Acres of Clams on the Seattle Waterfront, with views of the Puget Sound.

Let me know if you would like me to modify or expand on this Seattle day trip itinerary focused on boating and swimming activities.
</code></pre> <h4 id=leverage-the-memory-saver-to-manipulate-the-graph-state>Leverage the memory saver to manipulate the Graph State</h4> <ul> <li>Since the <code>Conversation Messages</code> are part of the graph state we can leverage that</li> <li>However the graph state is tied to <code>session_id</code> which will be passed in as a <code>thread_id</code> which ties to a session</li> <li>If we add a request with different thread id it will create a new session which will not have the previous <code>Interests</code></li> <li>However this this has the other check points variables as well and so this pattern is good for <code>A-Sync</code> workflow</li> </ul> <div class=highlight><pre><span></span><code><span class=n>config</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;configurable&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;thread_id&quot;</span><span class=p>:</span> <span class=s2>&quot;1&quot;</span><span class=p>}}</span>

<span class=n>user_request</span> <span class=o>=</span> <span class=s2>&quot;Can you add white water rafting to this itinerary&quot;</span>
<span class=n>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</code></pre></div> <pre><code>Current User Request: Can you add white water rafting to this itinerary


Final Itinerary:
Okay, great, let's add white water rafting to the Seattle day trip itinerary:

Seattle Day Trip Itinerary with White Water Rafting:

Morning:
- Start your day at Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.
- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.

Mid-Morning:
- Head out of the city to the Skykomish River, about a 1-hour drive from Seattle, for a white water rafting adventure. Spend 2-3 hours rafting down the river's class II-III rapids.

Afternoon:
- After your rafting trip, head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.
- Have lunch at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.

Late Afternoon:
- Visit Seacrest Park in West Seattle, which has a public swimming pool, beach access, and a fishing pier. Spend time swimming, relaxing on the beach, or trying your luck at fishing.
- As the day winds down, take the West Seattle Water Taxi back to downtown Seattle, enjoying the skyline views.

Evening:
- For dinner, consider a seafood-focused restaurant like Ivar's Acres of Clams on the Seattle Waterfront, with views of the Puget Sound.

Let me know if you would like me to modify or expand on this updated Seattle day trip itinerary that includes white water rafting.
</code></pre> <h4 id=run-with-another-session>Run with another session</h4> <p>Now this session will not have the previous conversations and we see it will create a new travel plan with the <code>white water rafting</code> interests, not boating or swim</p> <div class=highlight><pre><span></span><code><span class=n>config</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;configurable&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;thread_id&quot;</span><span class=p>:</span> <span class=s2>&quot;11&quot;</span><span class=p>}}</span>

<span class=n>user_request</span> <span class=o>=</span> <span class=s2>&quot;Can you add white water rafting to itinerary&quot;</span>
<span class=n>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</code></pre></div> <pre><code>Current User Request: Can you add white water rafting to this itinerary


Final Itinerary:
Okay, got it. Based on our previous conversation and your latest request to add white water rafting, here is a suggested day trip itinerary for Seattle:

Seattle Day Trip Itinerary:

- Start your day with a visit to the iconic Pike Place Market - explore the bustling stalls, grab a coffee, and watch the famous fish throwing.
- Head to the Space Needle for panoramic views of the city skyline and the Puget Sound.
- Enjoy a white water rafting adventure on one of the nearby rivers, such as the Skykomish or Snoqualmie River. This will be an exhilarating way to experience the natural beauty around Seattle.
- After the rafting, have lunch at one of the waterfront restaurants with views of the Puget Sound and the Olympic Mountains.
- Spend the afternoon exploring the Museum of Pop Culture (MoPOP) and learning about Seattle's music and pop culture heritage.
- End your day with a stroll through the Chihuly Garden and Glass, admiring the stunning glass sculptures.

Let me know if you would like me to modify or add anything to this Seattle day trip itinerary!
</code></pre> <h3 id=explore-external-store-for-memory>Explore <code>External Store</code> for memory</h3> <p>For Memory we further need short term and long term memory which can be explained below. Further reading can be at this <a href=https://langchain-ai.github.io/langgraph/concepts/memory/#what-is-memory>link</a></p> <p>Conversation memory can be explained by this diagram below which explains the <code>turn by turn</code> conversations which needs to be accessed by agents and then saved as a summary for long term memory</p> <p><img alt="long term memory" src=../images/short-vs-long.png></p> <h4 id=create-a-store>Create a <code>Store</code></h4> <p>In this section we will leverage multi-thread, multi-session persistence to Chat Messages. Ideally you will leverage persistence like Redis Store etc to save messages per session</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>langgraph.store.base</span> <span class=kn>import</span> <span class=n>BaseStore</span><span class=p>,</span> <span class=n>Item</span><span class=p>,</span> <span class=n>Op</span><span class=p>,</span> <span class=n>Result</span>
<span class=kn>from</span> <span class=nn>langgraph.store.memory</span> <span class=kn>import</span> <span class=n>InMemoryStore</span>
<span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>,</span> <span class=n>Literal</span><span class=p>,</span> <span class=n>NamedTuple</span><span class=p>,</span> <span class=n>Optional</span><span class=p>,</span> <span class=n>Union</span><span class=p>,</span> <span class=n>cast</span>

<span class=k>class</span> <span class=nc>CustomMemoryStore</span><span class=p>(</span><span class=n>BaseStore</span><span class=p>):</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ext_store</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>store</span> <span class=o>=</span> <span class=n>ext_store</span>

    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>namespace</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>],</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Item</span><span class=p>]:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>store</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>namespace</span><span class=p>,</span><span class=n>key</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>put</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>namespace</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=o>...</span><span class=p>],</span> <span class=n>key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>store</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>namespace</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
    <span class=k>def</span> <span class=nf>batch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ops</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Op</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>Result</span><span class=p>]:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>store</span><span class=o>.</span><span class=n>batch</span><span class=p>(</span><span class=n>ops</span><span class=p>)</span>
    <span class=k>async</span> <span class=k>def</span> <span class=nf>abatch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ops</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Op</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=n>Result</span><span class=p>]:</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>store</span><span class=o>.</span><span class=n>abatch</span><span class=p>(</span><span class=n>ops</span><span class=p>)</span>
</code></pre></div> <h4 id=quick-look-at-how-to-use-this-store>Quick look at how to use this store</h4> <div class=highlight><pre><span></span><code><span class=n>in_memory_store</span> <span class=o>=</span> <span class=n>CustomMemoryStore</span><span class=p>(</span><span class=n>InMemoryStore</span><span class=p>())</span>
<span class=n>namespace_u</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&quot;chat_messages&quot;</span><span class=p>,</span> <span class=s2>&quot;user_id_1&quot;</span><span class=p>)</span>
<span class=n>key_u</span><span class=o>=</span><span class=s2>&quot;user_id_1&quot;</span>
<span class=n>in_memory_store</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>namespace_u</span><span class=p>,</span> <span class=n>key_u</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;data&quot;</span><span class=p>:[</span><span class=s2>&quot;list a&quot;</span><span class=p>]})</span>
<span class=n>item_u</span> <span class=o>=</span> <span class=n>in_memory_store</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>namespace_u</span><span class=p>,</span> <span class=n>key_u</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>item_u</span><span class=o>.</span><span class=n>value</span><span class=p>,</span> <span class=n>item_u</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>])</span>

<span class=n>in_memory_store</span><span class=o>.</span><span class=n>list_namespaces</span><span class=p>()</span>
</code></pre></div> <pre><code>{'data': ['list a']} ['list a']





[('chat_messages', 'user_id_1')]
</code></pre> <h4 id=create-the-similiar-graph-as-earlier-note-we-will-not-have-any-mesages-in-the-graph-state-as-that-has-been-externalized>Create the similiar graph as earlier -- note we will not have any mesages in the Graph state as that has been externalized</h4> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>PlannerState</span><span class=p>(</span><span class=n>TypedDict</span><span class=p>):</span>
    <span class=n>itinerary</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>city</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>input_interests</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>PlannerState</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>RunnableConfig</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>store</span><span class=p>:</span> <span class=n>BaseStore</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PlannerState</span><span class=p>:</span>
    <span class=n>user_message</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>]</span> <span class=c1>#input(&quot;Your input: &quot;)</span>
    <span class=k>return</span> <span class=p>{</span>
        <span class=o>**</span><span class=n>state</span><span class=p>,</span>
    <span class=p>}</span>

<span class=k>def</span> <span class=nf>create_itinerary</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>PlannerState</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>RunnableConfig</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>store</span><span class=p>:</span> <span class=n>BaseStore</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PlannerState</span><span class=p>:</span>
    <span class=c1>#- get the history from the store</span>
    <span class=n>user_u</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;user_id_</span><span class=si>{</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;configurable&#39;</span><span class=p>][</span><span class=s1>&#39;thread_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
    <span class=n>namespace_u</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&quot;chat_messages&quot;</span><span class=p>,</span> <span class=n>user_u</span><span class=p>)</span>
    <span class=n>store_item</span> <span class=o>=</span> <span class=n>store</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>namespace</span><span class=o>=</span><span class=n>namespace_u</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=n>user_u</span><span class=p>)</span>
    <span class=n>chat_history_messages</span> <span class=o>=</span> <span class=n>store_item</span><span class=o>.</span><span class=n>value</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>]</span> <span class=k>if</span> <span class=n>store_item</span> <span class=k>else</span> <span class=p>[]</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>user_u</span><span class=p>,</span><span class=n>chat_history_messages</span><span class=p>)</span>

    <span class=n>response</span> <span class=o>=</span> <span class=n>llm</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=n>itinerary_prompt</span><span class=o>.</span><span class=n>format_messages</span><span class=p>(</span><span class=n>city</span><span class=o>=</span><span class=n>state</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>],</span> <span class=n>user_message</span><span class=o>=</span><span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>],</span> <span class=n>chat_history</span><span class=o>=</span><span class=n>chat_history_messages</span><span class=p>))</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Final Itinerary:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>

    <span class=c1>#- add back to the store</span>
    <span class=n>store</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>namespace</span><span class=o>=</span><span class=n>namespace_u</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=n>user_u</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;data&quot;</span><span class=p>:</span><span class=n>chat_history_messages</span><span class=o>+</span><span class=p>[</span><span class=n>HumanMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>]),</span><span class=n>AIMessage</span><span class=p>(</span><span class=n>content</span><span class=o>=</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)]})</span>

    <span class=k>return</span> <span class=p>{</span>
        <span class=o>**</span><span class=n>state</span><span class=p>,</span>
        <span class=s2>&quot;itinerary&quot;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>content</span>
    <span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>in_memory_store_n</span> <span class=o>=</span> <span class=n>CustomMemoryStore</span><span class=p>(</span><span class=n>InMemoryStore</span><span class=p>())</span>

<span class=n>workflow</span> <span class=o>=</span> <span class=n>StateGraph</span><span class=p>(</span><span class=n>PlannerState</span><span class=p>)</span>

<span class=c1>#workflow.add_node(&quot;input_city&quot;, input_city)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>,</span> <span class=n>input_interests</span><span class=p>)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;create_itinerary&quot;</span><span class=p>,</span> <span class=n>create_itinerary</span><span class=p>)</span>

<span class=n>workflow</span><span class=o>.</span><span class=n>set_entry_point</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>)</span>

<span class=c1>#workflow.add_edge(&quot;input_city&quot;, &quot;input_interests&quot;)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>,</span> <span class=s2>&quot;create_itinerary&quot;</span><span class=p>)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=s2>&quot;create_itinerary&quot;</span><span class=p>,</span> <span class=n>END</span><span class=p>)</span>


<span class=n>app</span> <span class=o>=</span> <span class=n>workflow</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>store</span><span class=o>=</span><span class=n>in_memory_store_n</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>config_dict</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Current User Request: </span><span class=si>{</span><span class=n>user_request</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=n>init_input</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;user_message&quot;</span><span class=p>:</span> <span class=n>user_request</span><span class=p>,</span><span class=s2>&quot;city&quot;</span> <span class=p>:</span> <span class=s2>&quot;Seattle&quot;</span><span class=p>}</span>

    <span class=k>for</span> <span class=n>output</span> <span class=ow>in</span> <span class=n>app</span><span class=o>.</span><span class=n>stream</span><span class=p>(</span><span class=n>init_input</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config_dict</span><span class=p>,</span> <span class=n>stream_mode</span><span class=o>=</span><span class=s2>&quot;values&quot;</span><span class=p>):</span>
        <span class=k>pass</span>  <span class=c1># The nodes themselves now handle all printing</span>

<span class=n>config</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;configurable&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;thread_id&quot;</span><span class=p>:</span> <span class=s2>&quot;1&quot;</span><span class=p>}}</span>

<span class=n>user_request</span> <span class=o>=</span> <span class=s2>&quot;Can you create a itinerary for boating, swim. Need a complete plan&quot;</span>
<span class=n>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</code></pre></div> <pre><code>Current User Request: Can you create a itinerary for boating, swim. Need a complete plan

user_id_1 []

Final Itinerary:
Okay, based on your interest in boating and swimming, here is a suggested day trip itinerary for Seattle:

Seattle Day Trip Itinerary:

Morning:
- Start your day at Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.
- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.

Afternoon: 
- Head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.
- Have lunch at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.

Late Afternoon:
- Visit Seacrest Park in West Seattle, which has a public swimming pool, beach access, and a fishing pier. Spend time swimming, relaxing, and taking in the views.
- Consider taking the West Seattle Water Taxi back to downtown Seattle for a scenic ride across the harbor.

Evening:
- Finish your day with dinner at a waterfront restaurant in Seattle's vibrant Pike Place Market area, watching the sunset over the Puget Sound.

Let me know if you would like me to modify or expand on this itinerary in any way!
</code></pre> <div class=highlight><pre><span></span><code><span class=n>config</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;configurable&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;thread_id&quot;</span><span class=p>:</span> <span class=s2>&quot;1&quot;</span><span class=p>}}</span>

<span class=n>user_request</span> <span class=o>=</span> <span class=s2>&quot;Can you add itinerary for white water rafting to this&quot;</span>
<span class=n>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</code></pre></div> <pre><code>Current User Request: Can you add itinerary for white water rafting to this

user_id_1 [HumanMessage(content='Can you create a itinerary for boating, swim. Need a complete plan', additional_kwargs={}, response_metadata={}), AIMessage(content="Okay, based on your interest in boating and swimming, here is a suggested day trip itinerary for Seattle:\n\nSeattle Day Trip Itinerary:\n\nMorning:\n- Start your day at Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.\n- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.\n\nAfternoon: \n- Head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.\n- Have lunch at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.\n\nLate Afternoon:\n- Visit Seacrest Park in West Seattle, which has a public swimming pool, beach access, and a fishing pier. Spend time swimming, relaxing, and taking in the views.\n- Consider taking the West Seattle Water Taxi back to downtown Seattle for a scenic ride across the harbor.\n\nEvening:\n- Finish your day with dinner at a waterfront restaurant in Seattle's vibrant Pike Place Market area, watching the sunset over the Puget Sound.\n\nLet me know if you would like me to modify or expand on this itinerary in any way!", additional_kwargs={}, response_metadata={})]

Final Itinerary:
Okay, here's an updated day trip itinerary for Seattle that includes white water rafting:

Seattle Day Trip Itinerary:

Morning:
- Start your day with a white water rafting adventure on the Skykomish River, about 1 hour east of Seattle. Spend 2-3 hours rafting down the scenic river with class III-IV rapids.

Afternoon:
- Head back to Seattle and visit Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.
- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.

Late Afternoon:
- Head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.
- Have dinner at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.

Evening:
- Finish your day with a scenic ride on the West Seattle Water Taxi back to downtown Seattle, watching the sunset over the Puget Sound.

Let me know if you would like me to modify or expand on this updated itinerary further.
</code></pre> <h4 id=quick-look-at-the-store>Quick look at the store</h4> <p>it will show the History of the Chat Messages</p> <div class=highlight><pre><span></span><code><span class=nb>print</span><span class=p>(</span><span class=n>in_memory_store_n</span><span class=o>.</span><span class=n>list_namespaces</span><span class=p>())</span>
<span class=nb>print</span><span class=p>(</span><span class=n>in_memory_store_n</span><span class=o>.</span><span class=n>get</span><span class=p>((</span><span class=s1>&#39;chat_messages&#39;</span><span class=p>,</span> <span class=s1>&#39;user_id_1&#39;</span><span class=p>),</span><span class=s1>&#39;user_id_1&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
</code></pre></div> <pre><code>[('chat_messages', 'user_id_1')]
{'data': [HumanMessage(content='Can you create a itinerary for boating, swim. Need a complete plan', additional_kwargs={}, response_metadata={}), AIMessage(content="Okay, based on your interest in boating and swimming, here is a suggested day trip itinerary for Seattle:\n\nSeattle Day Trip Itinerary:\n\nMorning:\n- Start your day at Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.\n- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.\n\nAfternoon: \n- Head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.\n- Have lunch at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.\n\nLate Afternoon:\n- Visit Seacrest Park in West Seattle, which has a public swimming pool, beach access, and a fishing pier. Spend time swimming, relaxing, and taking in the views.\n- Consider taking the West Seattle Water Taxi back to downtown Seattle for a scenic ride across the harbor.\n\nEvening:\n- Finish your day with dinner at a waterfront restaurant in Seattle's vibrant Pike Place Market area, watching the sunset over the Puget Sound.\n\nLet me know if you would like me to modify or expand on this itinerary in any way!", additional_kwargs={}, response_metadata={}), HumanMessage(content='Can you add itinerary for white water rafting to this', additional_kwargs={}, response_metadata={}), AIMessage(content="Okay, here's an updated day trip itinerary for Seattle that includes white water rafting:\n\nSeattle Day Trip Itinerary:\n\nMorning:\n- Start your day with a white water rafting adventure on the Skykomish River, about 1 hour east of Seattle. Spend 2-3 hours rafting down the scenic river with class III-IV rapids.\n\nAfternoon:\n- Head back to Seattle and visit Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.\n- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.\n\nLate Afternoon:\n- Head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.\n- Have dinner at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.\n\nEvening:\n- Finish your day with a scenic ride on the West Seattle Water Taxi back to downtown Seattle, watching the sunset over the Puget Sound.\n\nLet me know if you would like me to modify or expand on this updated itinerary further.", additional_kwargs={}, response_metadata={})]}
</code></pre> <h3 id=finally-we-review-the-concept-of-having-ecah-agent-be-backed-by-its-own-memory>Finally we review the concept of having Ecah <code>Agent</code> be backed by it's own memory</h3> <p>For this we will leverage the RunnableWithMessageHistory when creating the agent - Here we create to simulate a InMemoryChatMessageHistory, but this will be externalized in produftion use cases - use this this as a sample</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>langchain_core.chat_history</span> <span class=kn>import</span> <span class=n>InMemoryChatMessageHistory</span>
<span class=kn>from</span> <span class=nn>langchain_core.output_parsers</span> <span class=kn>import</span> <span class=n>StrOutputParser</span>
<span class=kn>from</span> <span class=nn>langchain_core.prompts</span> <span class=kn>import</span> <span class=n>ChatPromptTemplate</span>
<span class=kn>from</span> <span class=nn>langchain_core.runnables.history</span> <span class=kn>import</span> <span class=n>RunnableWithMessageHistory</span>


<span class=c1># ----  Update region for your AWS setup  ----</span>
<span class=n>bedrock_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s2>&quot;bedrock-runtime&quot;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s2>&quot;us-east-1&quot;</span><span class=p>)</span>
<span class=n>model_id</span> <span class=o>=</span> <span class=s2>&quot;anthropic.claude-3-haiku-20240307-v1:0&quot;</span>
<span class=c1>#model_id = &quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;#</span>
<span class=c1>#model_id=&quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;</span>

<span class=n>provider_id</span> <span class=o>=</span> <span class=s2>&quot;anthropic&quot;</span>

<span class=n>chatbedrock_llm</span> <span class=o>=</span> <span class=n>ChatBedrockConverse</span><span class=p>(</span>
    <span class=n>model</span><span class=o>=</span><span class=n>model_id</span><span class=p>,</span>
    <span class=n>provider</span><span class=o>=</span><span class=n>provider_id</span><span class=p>,</span>
    <span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
    <span class=n>max_tokens</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>client</span><span class=o>=</span><span class=n>bedrock_client</span><span class=p>,</span>
    <span class=c1># other params...</span>
<span class=p>)</span>

<span class=n>itinerary_prompt</span> <span class=o>=</span> <span class=n>ChatPromptTemplate</span><span class=o>.</span><span class=n>from_messages</span><span class=p>([</span>
    <span class=p>(</span><span class=s2>&quot;system&quot;</span><span class=p>,</span> <span class=s2>&quot;You are a helpful travel assistant. Create a day trip itinerary for </span><span class=si>{city}</span><span class=s2> based on the user&#39;s interests. Use the below chat conversation and the latest input from Human to get the user interests. Provide a brief, bulleted itinerary.&quot;</span><span class=p>),</span>
    <span class=n>MessagesPlaceholder</span><span class=p>(</span><span class=s2>&quot;chat_history&quot;</span><span class=p>),</span>
    <span class=p>(</span><span class=s2>&quot;human&quot;</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{user_message}</span><span class=s2>&quot;</span><span class=p>),</span>
<span class=p>])</span>
<span class=n>chain</span> <span class=o>=</span> <span class=n>itinerary_prompt</span> <span class=o>|</span> <span class=n>chatbedrock_llm</span> 

<span class=n>history</span> <span class=o>=</span> <span class=n>InMemoryChatMessageHistory</span><span class=p>()</span>
<span class=k>def</span> <span class=nf>get_history</span><span class=p>():</span>
    <span class=k>return</span> <span class=n>history</span>

<span class=n>wrapped_chain</span> <span class=o>=</span> <span class=n>RunnableWithMessageHistory</span><span class=p>(</span>
    <span class=n>chain</span><span class=p>,</span>
    <span class=n>get_history</span><span class=p>,</span>
    <span class=n>history_messages_key</span><span class=o>=</span><span class=s2>&quot;chat_history&quot;</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>PlannerState</span><span class=p>(</span><span class=n>TypedDict</span><span class=p>):</span>
    <span class=n>itinerary</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>city</span><span class=p>:</span> <span class=nb>str</span>
    <span class=n>user_message</span><span class=p>:</span> <span class=nb>str</span>

<span class=k>def</span> <span class=nf>input_interests</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>PlannerState</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>RunnableConfig</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>store</span><span class=p>:</span> <span class=n>BaseStore</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PlannerState</span><span class=p>:</span>
    <span class=n>user_message</span> <span class=o>=</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>]</span> <span class=c1>#input(&quot;Your input: &quot;)</span>
    <span class=k>return</span> <span class=p>{</span>
        <span class=o>**</span><span class=n>state</span><span class=p>,</span>
    <span class=p>}</span>

<span class=k>def</span> <span class=nf>create_itinerary</span><span class=p>(</span><span class=n>state</span><span class=p>:</span> <span class=n>PlannerState</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>RunnableConfig</span><span class=p>,</span> <span class=o>*</span><span class=p>,</span> <span class=n>store</span><span class=p>:</span> <span class=n>BaseStore</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>PlannerState</span><span class=p>:</span>
    <span class=c1>#- each agent manages it&#39;s memory</span>
    <span class=n>response</span> <span class=o>=</span> <span class=n>wrapped_chain</span><span class=o>.</span><span class=n>invoke</span><span class=p>({</span><span class=s2>&quot;city&quot;</span><span class=p>:</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>],</span> <span class=s2>&quot;user_message&quot;</span><span class=p>:</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>],</span> <span class=s2>&quot;input&quot;</span><span class=p>:</span> <span class=n>state</span><span class=p>[</span><span class=s1>&#39;user_message&#39;</span><span class=p>]}</span> <span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Final Itinerary:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>

    <span class=k>return</span> <span class=p>{</span>
        <span class=o>**</span><span class=n>state</span><span class=p>,</span>
        <span class=s2>&quot;itinerary&quot;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>content</span>
    <span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>workflow</span> <span class=o>=</span> <span class=n>StateGraph</span><span class=p>(</span><span class=n>PlannerState</span><span class=p>)</span>

<span class=c1>#workflow.add_node(&quot;input_city&quot;, input_city)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>,</span> <span class=n>input_interests</span><span class=p>)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_node</span><span class=p>(</span><span class=s2>&quot;create_itinerary&quot;</span><span class=p>,</span> <span class=n>create_itinerary</span><span class=p>)</span>

<span class=n>workflow</span><span class=o>.</span><span class=n>set_entry_point</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>)</span>

<span class=c1>#workflow.add_edge(&quot;input_city&quot;, &quot;input_interests&quot;)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=s2>&quot;input_interests&quot;</span><span class=p>,</span> <span class=s2>&quot;create_itinerary&quot;</span><span class=p>)</span>
<span class=n>workflow</span><span class=o>.</span><span class=n>add_edge</span><span class=p>(</span><span class=s2>&quot;create_itinerary&quot;</span><span class=p>,</span> <span class=n>END</span><span class=p>)</span>


<span class=n>app</span> <span class=o>=</span> <span class=n>workflow</span><span class=o>.</span><span class=n>compile</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>config_dict</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Current User Request: </span><span class=si>{</span><span class=n>user_request</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=n>init_input</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;user_message&quot;</span><span class=p>:</span> <span class=n>user_request</span><span class=p>,</span><span class=s2>&quot;city&quot;</span> <span class=p>:</span> <span class=s2>&quot;Seattle&quot;</span><span class=p>}</span>

    <span class=k>for</span> <span class=n>output</span> <span class=ow>in</span> <span class=n>app</span><span class=o>.</span><span class=n>stream</span><span class=p>(</span><span class=n>init_input</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config_dict</span><span class=p>,</span> <span class=n>stream_mode</span><span class=o>=</span><span class=s2>&quot;values&quot;</span><span class=p>):</span>
        <span class=k>pass</span>  <span class=c1># The nodes themselves now handle all printing</span>

<span class=n>config</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;configurable&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;thread_id&quot;</span><span class=p>:</span> <span class=s2>&quot;1&quot;</span><span class=p>}}</span>

<span class=n>user_request</span> <span class=o>=</span> <span class=s2>&quot;Can you create a itinerary for boating, swim. Need a complete plan&quot;</span>
<span class=n>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</code></pre></div> <pre><code>Current User Request: Can you create a itinerary for boating, swim. Need a complete plan


Final Itinerary:
Okay, based on your interest in boating and swimming, here is a suggested day trip itinerary for Seattle:

Seattle Day Trip Itinerary:

Morning:
- Start your day at Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.
- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.

Afternoon: 
- Head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.
- Have lunch at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.

Late Afternoon:
- Visit Seacrest Park in West Seattle, which has a public swimming pool, beach access, and a fishing pier. Spend time swimming, relaxing, and taking in the views.
- Consider taking the West Seattle Water Taxi back to downtown Seattle for a scenic ride across the harbor.

Evening:
- Finish your day with dinner at a waterfront restaurant in Seattle's vibrant Pike Place Market area, watching the sunset over the Puget Sound.

Let me know if you would like me to modify or expand on this itinerary in any way!
</code></pre> <div class=highlight><pre><span></span><code><span class=n>user_request</span> <span class=o>=</span> <span class=s2>&quot;Can you add white water rafting to this itinerary&quot;</span>
<span class=n>run_travel_planner</span><span class=p>(</span><span class=n>user_request</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</code></pre></div> <pre><code>Current User Request: Can you add white water rafting to this itinerary


Final Itinerary:
Okay, great, let's add white water rafting to the Seattle day trip itinerary:

Seattle Day Trip Itinerary with White Water Rafting:

Morning:
- Start your day at Fishermen's Terminal, a historic working waterfront. Rent a small boat or kayak and explore the scenic Lake Union.
- Visit the Center for Wooden Boats and learn about the region's maritime history. You can even try your hand at sailing a historic vessel.

Mid-Morning:
- Head out of the city to the Skykomish River, about a 1-hour drive from Seattle, for a white water rafting adventure. Spend 2-3 hours navigating the Class III-IV rapids with an experienced guide.

Afternoon:
- After your rafting trip, head to Alki Beach, one of Seattle's best urban beaches. Spend a few hours swimming, sunbathing, and enjoying the views of the Puget Sound and the Olympic Mountains.
- Have lunch at one of the beachfront restaurants or food trucks, enjoying fresh seafood and local cuisine.

Late Afternoon: 
- Visit Seacrest Park in West Seattle, which has a public swimming pool, beach access, and a fishing pier. Spend time swimming, relaxing, and taking in the views.
- Consider taking the West Seattle Water Taxi back to downtown Seattle for a scenic ride across the harbor.

Evening:
- Finish your day with dinner at a waterfront restaurant in Seattle's vibrant Pike Place Market area, watching the sunset over the Puget Sound.

Let me know if you would like me to modify this itinerary further!
</code></pre> <h2 id=conclusion>Conclusion</h2> <p>You have successfully executed a simple LangGraph implementation, this lab demonstrates how LangGraph can be used to create a simple yet effective Travel Planner. By structuring our application as a graph of interconnected nodes, we achieve a clear separation of concerns and a easily modifiable workflow. This approach can be extended to more complex applications, showcasing the power and flexibility of graph-based designs in AI-driven conversational interfaces.</p> <p>Please proceed to the next lab</p> <div class=highlight><pre><span></span><code>
</code></pre></div> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by <a href="https://github.com/aws-samples/amazon-bedrock-samples/issues/new?title=[Online Feedback]: Short-Summary-of-Issue&body=Page URL: /agents-and-function-calling/open-source-agents/langgraph/Travel_planner_with_langgraph/" target=_blank rel=noopener>creating an issue</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../03_langgraph_agents_of_agent/ class="md-footer__link md-footer__link--prev" aria-label="Previous: LangGraph Multi Agent with tools"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> LangGraph Multi Agent with tools </div> </div> </a> <a href=../../../introduction-to-agents/how_to_create_multi_agents_from_custom_agents/ class="md-footer__link md-footer__link--next" aria-label="Next: Multi Agent Orchestration"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Multi Agent Orchestration </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved. </div> </div> <div class=md-social> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["tags", "toc.integrate", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "search.highlight", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "tags": {"Compatibility": "compat"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.88dd0f4e.min.js></script> <script src=../../../../javascript/feedback.js></script> </body> </html>