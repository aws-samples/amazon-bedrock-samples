<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Amazon Bedrock cookbook website"><meta name=author content=Bedrock-GTM><link href=https://github.amazon-bedrock-samples.com/custom-models/import_models/llama-3.1-jumpstart-chess/llama-3.1-8b-jumpstart-chess-finetuning/ rel=canonical><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>Llama 3.1 8b jumpstart chess finetuning - Amazon Bedrock Recipes</title><link rel=stylesheet href=../../../../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="Amazon Bedrock Recipes" class="md-header__button md-logo" aria-label="Amazon Bedrock Recipes" data-md-component=logo> <img src=../../../../logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Amazon Bedrock Recipes </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Llama 3.1 8b jumpstart chess finetuning </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=purple aria-hidden=true type=radio name=__palette id=__palette_0> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Github: Amazon-Bedrock-Samples </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="Amazon Bedrock Recipes" class="md-nav__button md-logo" aria-label="Amazon Bedrock Recipes" data-md-component=logo> <img src=../../../../logo.png alt=logo> </a> Amazon Bedrock Recipes </label> <div class=md-nav__source> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Github: Amazon-Bedrock-Samples </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Intro to Amazon Bedrock </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Intro to Amazon Bedrock </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1> <label class=md-nav__link for=__nav_2_1_1 id=__nav_2_1_1_label tabindex=0> <span class=md-ellipsis> API Usage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> API Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/01_invoke_api/ class=md-nav__link> <span class=md-ellipsis> Invoke Model API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/04_agents_api/ class=md-nav__link> <span class=md-ellipsis> Agents API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/03_knowledgebases_api/ class=md-nav__link> <span class=md-ellipsis> Knowledge Bases API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/bedrock_apis/02_guardrails_api/ class=md-nav__link> <span class=md-ellipsis> Guardrail API Example </span> </a> </li> <li class=md-nav__item> <a href=../../../../introduction-to-bedrock/converse_api/01_converse_api/ class=md-nav__link> <span class=md-ellipsis> Converse API Example </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Agents </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1 id=__nav_2_2_1_label tabindex=0> <span class=md-ellipsis> Amazon Bedrock Agents </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Amazon Bedrock Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/introduction-to-agents/how_to_create_custom_agents/ class=md-nav__link> <span class=md-ellipsis> How to create an Agent </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_2> <label class=md-nav__link for=__nav_2_2_1_2 id=__nav_2_2_1_2_label tabindex=0> <span class=md-ellipsis> Bedrock Agent Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_2> <span class="md-nav__icon md-icon"></span> Bedrock Agent Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/01-create-agent-with-function-definition/01-create-agent-with-function-definition/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Function Definition </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/02-create-agent-with-api-schema/02-create-agent-with-api-schema/ class=md-nav__link> <span class=md-ellipsis> Create Agent with API Schema </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/03-create-agent-with-return-of-control/03-create-agent-with-return-of-control/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Return of Control </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/04-create-agent-with-single-knowledge-base/04-create-agent-with-single-knowledge-base/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Single Knowledge Base </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/05-create-agent-with-knowledge-base-and-action-group/05-create-agent-with-knowledge-base-and-action-group/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Knowledge Base and Action Group </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/06-prompt-and-session-attributes/06-prompt-and-session-attributes/ class=md-nav__link> <span class=md-ellipsis> Prompt and Session Attributes </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/07-advanced-prompts-and-custom-parsers/07-custom-prompt-and-lambda-parsers/ class=md-nav__link> <span class=md-ellipsis> Custom Prompt and Lambda Parsers </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/08-create-agent-with-guardrails/08-create-agent-with-guardrails/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Guardrails </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/09-create-agent-with-memory/09-create-agent-with-memory/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Memory </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/10-create-agent-with-code-interpreter/10-create-agent-with-code-interpreter/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Code Interpreter </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/14-create-agent-with-custom-orchestration/custom_orchestration_example/ class=md-nav__link> <span class=md-ellipsis> Create Agent with Custom Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/features-examples/15-invoke-inline-agents/inline-agent-api-usage/ class=md-nav__link> <span class=md-ellipsis> Create Dynamic Tooling Inline Agents </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_3> <label class=md-nav__link for=__nav_2_2_1_3 id=__nav_2_2_1_3_label tabindex=0> <span class=md-ellipsis> Bedrock Flows </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_3> <span class="md-nav__icon md-icon"></span> Bedrock Flows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/bedrock-flows/Getting_started_with_Prompt_Management_Flows/ class=md-nav__link> <span class=md-ellipsis> Getting Started with Prompt Management Flows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1_4> <label class=md-nav__link for=__nav_2_2_1_4 id=__nav_2_2_1_4_label tabindex=0> <span class=md-ellipsis> Use Case Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1_4> <span class="md-nav__icon md-icon"></span> Use Case Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/use-case-examples/text-2-sql-agent/create_and_invoke_sql_agent/ class=md-nav__link> <span class=md-ellipsis> Text to SQL Agent </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/use-case-examples/agentsforbedrock-retailagent/workshop/test_retailagent_agentsforbedrock/ class=md-nav__link> <span class=md-ellipsis> Retail Agent Workshop </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/bedrock-agents/use-case-examples/product-review-agent/main/ class=md-nav__link> <span class=md-ellipsis> Product Review Agent </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2 id=__nav_2_2_2_label tabindex=0> <span class=md-ellipsis> Function Calling </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Function Calling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/function_calling_with_converse/function_calling_with_converse/ class=md-nav__link> <span class=md-ellipsis> Function Calling with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/function_calling_with_invoke/function_calling_model_with_invoke/ class=md-nav__link> <span class=md-ellipsis> Function Calling with Invoke </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/return_of_control/return_of_control/ class=md-nav__link> <span class=md-ellipsis> Return of Control </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/function-calling/tool_binding/tool_bindings/ class=md-nav__link> <span class=md-ellipsis> Tool Binding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3> <label class=md-nav__link for=__nav_2_2_3 id=__nav_2_2_3_label tabindex=0> <span class=md-ellipsis> Open Source </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> Open Source </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_1> <label class=md-nav__link for=__nav_2_2_3_1 id=__nav_2_2_3_1_label tabindex=0> <span class=md-ellipsis> CrewAI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_1> <span class="md-nav__icon md-icon"></span> CrewAI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/crew.ai/Find%20dream%20destination%20with%20CrewAI/ class=md-nav__link> <span class=md-ellipsis> Find Dream Destination with CrewAI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_2> <label class=md-nav__link for=__nav_2_2_3_2 id=__nav_2_2_3_2_label tabindex=0> <span class=md-ellipsis> LangGraph </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_2> <span class="md-nav__icon md-icon"></span> LangGraph </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-single-agent/ class=md-nav__link> <span class=md-ellipsis> LangGraph Agent with Function Calling </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-agents-multimodal/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi-Modal Agent with Function Calling </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-multi-agent-sql-tools/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/02_medibot_V3_agents/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent For Medical Chatbot </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-fact-checker-feedback-loop/ class=md-nav__link> <span class=md-ellipsis> LangGraph Fact Checker with Multi Agent </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/langgraph-multi-agent-sql-tools/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent Orchestration </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/03_langgraph_agents_of_agent/ class=md-nav__link> <span class=md-ellipsis> LangGraph Multi Agent with tools </span> </a> </li> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/open-source-agents/langgraph/Travel_planner_with_langgraph/ class=md-nav__link> <span class=md-ellipsis> Managing Memory for Multi Agents </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_3> <label class=md-nav__link for=__nav_2_2_3_3 id=__nav_2_2_3_3_label tabindex=0> <span class=md-ellipsis> Multi Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_3> <span class="md-nav__icon md-icon"></span> Multi Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../agents-and-function-calling/introduction-to-agents/how_to_create_multi_agents_from_custom_agents/ class=md-nav__link> <span class=md-ellipsis> Multi Agent Orchestration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> RAG </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> RAG </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1 id=__nav_2_3_1_label tabindex=0> <span class=md-ellipsis> Amazon Bedrock Knowledge Bases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Amazon Bedrock Knowledge Bases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_1> <label class=md-nav__link for=__nav_2_3_1_1 id=__nav_2_3_1_1_label tabindex=0> <span class=md-ellipsis> Zero Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_1> <span class="md-nav__icon md-icon"></span> Zero Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/00-zero-setup-chat-with-your-document/chat_with_document_kb/ class=md-nav__link> <span class=md-ellipsis> Chat with Your Document </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2 id=__nav_2_3_1_2_label tabindex=0> <span class=md-ellipsis> RAG Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> RAG Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/01_create_ingest_documents_test_kb_multi_ds/ class=md-nav__link> <span class=md-ellipsis> Create and Ingest Documents with Multi-Data Sources </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/02_managed_rag_custom_prompting_and_no_of_results/ class=md-nav__link> <span class=md-ellipsis> Managed RAG with Custom Prompting </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/03_customized-rag-retreive-api-hybrid-search-claude-3-sonnet-langchain/ class=md-nav__link> <span class=md-ellipsis> Customized RAG with Claude 3 and Langchain </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/01-rag-concepts/04_customized-rag-retreive-api-langchain-claude-evaluation-ragas/ class=md-nav__link> <span class=md-ellipsis> RAG Evaluation with Langchain and RAGAS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_3> <label class=md-nav__link for=__nav_2_3_1_3 id=__nav_2_3_1_3_label tabindex=0> <span class=md-ellipsis> Optimizing Retrieval Results </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Optimizing Retrieval Results </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/advanced_chunking_options/ class=md-nav__link> <span class=md-ellipsis> Advanced Chunking Options </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/csv_metadata_customization/ class=md-nav__link> <span class=md-ellipsis> CSV Metadata Customization </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/02-optimizing-accuracy-retrieved-results/query_reformulation/ class=md-nav__link> <span class=md-ellipsis> Query Reformulation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_4> <label class=md-nav__link for=__nav_2_3_1_4 id=__nav_2_3_1_4_label tabindex=0> <span class=md-ellipsis> Advanced Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_4> <span class="md-nav__icon md-icon"></span> Advanced Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/dynamic-metadata-filtering/dynamic-metadata-filtering-KB/ class=md-nav__link> <span class=md-ellipsis> Dynamic Metadata Filtering </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_4_2> <label class=md-nav__link for=__nav_2_3_1_4_2 id=__nav_2_3_1_4_2_label tabindex=0> <span class=md-ellipsis> Reranking </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_4_2> <span class="md-nav__icon md-icon"></span> Reranking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/reranking/01_deploy-reranking-model-sm/ class=md-nav__link> <span class=md-ellipsis> Deploy Reranking Model </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/reranking/02_kb-reranker/ class=md-nav__link> <span class=md-ellipsis> Knowledge Base Reranker </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/03-advanced-concepts/reranking/qa-generator/ class=md-nav__link> <span class=md-ellipsis> QA Generator </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_5> <label class=md-nav__link for=__nav_2_3_1_5 id=__nav_2_3_1_5_label tabindex=0> <span class=md-ellipsis> Responsible AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_5> <span class="md-nav__icon md-icon"></span> Responsible AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/features-examples/05-responsible-ai/contextual-grounding/ class=md-nav__link> <span class=md-ellipsis> Contextual Grounding </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6> <label class=md-nav__link for=__nav_2_3_1_6 id=__nav_2_3_1_6_label tabindex=0> <span class=md-ellipsis> Use Case Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_1_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6> <span class="md-nav__icon md-icon"></span> Use Case Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6_1> <label class=md-nav__link for=__nav_2_3_1_6_1 id=__nav_2_3_1_6_1_label tabindex=0> <span class=md-ellipsis> Metadata Filter Access Control </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6_1> <span class="md-nav__icon md-icon"></span> Metadata Filter Access Control </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/metadata-filter-access-control/kb-end-to-end-acl/ class=md-nav__link> <span class=md-ellipsis> End-to-End ACL with Knowledge Base </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_1_6_2> <label class=md-nav__link for=__nav_2_3_1_6_2 id=__nav_2_3_1_6_2_label tabindex=0> <span class=md-ellipsis> RAG with Structured and Unstructured Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_3_1_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_1_6_2> <span class="md-nav__icon md-icon"></span> RAG with Structured and Unstructured Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/0-create-dummy-structured-data/ class=md-nav__link> <span class=md-ellipsis> Create Dummy Structured Data </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/1_create_sql_dataset_optional/ class=md-nav__link> <span class=md-ellipsis> Create SQL Dataset (Optional) </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/knowledge-bases/use-case-examples/rag-using-structured-unstructured-data/2_rag_with_structured_unstructured_data/ class=md-nav__link> <span class=md-ellipsis> RAG with Structured and Unstructured Data </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2 id=__nav_2_3_2_label tabindex=0> <span class=md-ellipsis> Open Source </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> Open Source </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/open-source/chatbots/qa_chatbot_langchain_bedrock/ class=md-nav__link> <span class=md-ellipsis> Chatbot using Langchain </span> </a> </li> <li class=md-nav__item> <a href=../../../../rag/open-source/chunking/rag_chunking_strategies_langchain_bedrock/ class=md-nav__link> <span class=md-ellipsis> Chunking strategies for RAG applications </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3_2_3> <label class=md-nav__link for=__nav_2_3_2_3 id=__nav_2_3_2_3_label tabindex=0> <span class=md-ellipsis> Vector Stores </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_3_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3_2_3> <span class="md-nav__icon md-icon"></span> Vector Stores </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../rag/open-source/vector_stores/rag_langchain_bedrock_opensearch/ class=md-nav__link> <span class=md-ellipsis> Langchain Chatbot with Opensearch </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Model Customization </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Model Customization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../model-distillation/Historical_invocation_distillation/ class=md-nav__link> <span class=md-ellipsis> Model Distillation with Invocation Logs </span> </a> </li> <li class=md-nav__item> <a href=../../../model-distillation/Distillation-via-S3-input/ class=md-nav__link> <span class=md-ellipsis> Model Distillation with S3 Data </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Gen AI Usecases </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Gen AI Usecases </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> Text Generation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Text Generation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text_generation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Streaming Response with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_code_generation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Generate Python Code with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text_translation_w_bedrock/ class=md-nav__link> <span class=md-ellipsis> Text Translation with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_text-summarization-titan%2Bclaude/ class=md-nav__link> <span class=md-ellipsis> Text summarization with Converse </span> </a> </li> <li class=md-nav__item> <a href=../../../../genai-use-cases/text-generation/how_to_work_with_batch_example_for_multi_threaded_invocation/ class=md-nav__link> <span class=md-ellipsis> Generate Bulk Emails with Batch Inference </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Workshops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Workshops </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class=md-ellipsis> Open-source L400 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Open-source L400 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/01_usecase_introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction to the Use Case </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/02_Lab_Find%20a%20Dream%20Destination_RAG%20query/ class=md-nav__link> <span class=md-ellipsis> Advanced RAG for Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/02_travel_planner_with_langgraph/ class=md-nav__link> <span class=md-ellipsis> Conversational Memory in Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/03_travel_agent_with_tools/ class=md-nav__link> <span class=md-ellipsis> Multi-Modal and Types of Agents </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/04_travel_booking_multi_agent/ class=md-nav__link> <span class=md-ellipsis> Multi-Agent Collaboration with Human-in-loop </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/05_dream_destination_with_crewai/ class=md-nav__link> <span class=md-ellipsis> Find Dream Destination with CrewAI </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/06_agent_evaluation_with_ragas/ class=md-nav__link> <span class=md-ellipsis> RAGAs Agents Evaluation </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l400/07_dynamic_tooling_agents/ class=md-nav__link> <span class=md-ellipsis> Dynamic Tool invocation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Open-source L200 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Open-source L200 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/02_contextual_text_generation/ class=md-nav__link> <span class=md-ellipsis> Introduction to the Use Case </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/03_retrieval_based_text_application/ class=md-nav__link> <span class=md-ellipsis> Retrieval Based Text Generation </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/04_retrieval_based_chat_application/ class=md-nav__link> <span class=md-ellipsis> Retrieval Based Chat Application </span> </a> </li> <li class=md-nav__item> <a href=../../../../workshop/open-source-l200/05_agent_based_text_generation/ class=md-nav__link> <span class=md-ellipsis> Agent Based Text Generation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../../general/tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class=md-nav__item> <a href=../../../../general/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1> Overview </h1> <p>In this notebook Llama 3.1 8b will be fine-tuned to play chess. The model will be pulled from the Sagemaker Jumpstart model hub and fine-tuned using a Sagemaker training job. Sagemaker Jumpstart is a model hub with 400+ LLM's that can be deployed as is or fine-tuned. An overview of Llama 3.1 on Sagemaker Jumpstart can be found <a href=https://aws.amazon.com/blogs/machine-learning/meta-llama-3-1-models-are-now-available-in-amazon-sagemaker-jumpstart/ >here</a>. </p> <p>This notebook can be run on any environment of the user's choice as the training compute will be offloaded into a "ml.g5.24xlarge". If this notebook is run outside of an Amazon Sagemaker environment, please ensure the AWS user credentials are correctly initialized. Some environments this notebook can be run on some examples:</p> <ol> <li>Configuring an AWS EC2 instance with a Deep Learning AMI, and setting up a Jupyter Server: Link</li> <li>Configuring an Amazon Sagemaker environment: Link</li> <li>Configure your own environment, with adequate compute to run this notebook.</li> </ol> <p>The Chess moves dataset is pulled from <a href=https://chessdb.sourceforge.net/Scid/ >here</a>. This dataset outlines the board state in FEN notation, and states the next legal move based on the board state &amp; player turn. More information about what FEN notation is and how to interpret it can be found <a href=https://www.chess.com/terms/fen-chess>here</a>.</p> <p>Once the model is imported at the end of this notebook, please open "test_chess_model.ipynb" to use the model to play chess. If this is the intention skip the "Clean up" section at the bottom of this notebook.</p> <p><strong><em>NOTE:</em></strong> This notebook was tested in the us-east-1 region of AWS</p> <h2> Amazon Bedrock Custom Model Import (CMI) </h2> <p>The resulting model files are imported into Amazon Bedrock via Custom Model Import (CMI).</p> <p>Bedrock Custom Model Import allows for importing foundation models that have been customized in other environments outside of Amazon Bedrock, such as Amazon Sagemaker, EC2, etc.</p> <h2> What will you learn from this notebook </h2> <p>In this notebook, you will learn how to:</p> <ul> <li>Pull a model from Sagemaker Jumpstart &amp; finetune it </li> <li>Use a custom dataset &amp; process it to conform to a prompt template of choice</li> <li>Finetune the model (Llama 3.1 8b) using Sagemaker training jobs</li> <li>Deploy the finetuned model to Amazon Bedrock Custom Import &amp; Conduct Inference</li> </ul> <h2> Architectural Pattern </h2> <p><img alt=Diagram src=../images/architecture.png title=Architecture></p> <p>As can be seen from the diagram above, the model (Llama 3.1 8b) gets pulled from Sagemaker Jumpstart, and The dataset is a chess dataset from pgnmentor.com mirroring Magnus Carlson's games. The model files are then stored in an S3 bucket, to then be imported into Amazon Bedrock. This architecture is modular because the Notebook can be run anywhere, that the appropriate compute is available (as explained earlier).</p> <h2> Code with comments </h2> <h3> Install dependencies & restart kernel </h3> <div class=highlight><pre><span></span><code><span class=err>!</span><span class=n>pip</span> <span class=n>install</span> <span class=o>-</span><span class=n>U</span> <span class=s1>&#39;aiobotocore[boto3]&#39;</span> 
</code></pre></div> <div class=highlight><pre><span></span><code><span class=err>!</span><span class=n>pip</span> <span class=n>install</span> <span class=n>setuptools</span><span class=o>==</span><span class=mf>69.0.2</span>
<span class=err>!</span><span class=n>pip</span> <span class=n>install</span> <span class=n>chess</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=err>!</span><span class=n>pip</span> <span class=n>install</span> <span class=o>--</span><span class=n>upgrade</span> <span class=n>pip</span> <span class=n>setuptools</span> <span class=n>wheel</span> <span class=o>--</span><span class=n>quiet</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=err>!</span><span class=n>pip</span> <span class=n>install</span> <span class=n>transformers</span> <span class=n>datasets</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1># restart kernel</span>
<span class=kn>from</span> <span class=nn>IPython.core.display</span> <span class=kn>import</span> <span class=n>HTML</span>
<span class=n>HTML</span><span class=p>(</span><span class=s2>&quot;&lt;script&gt;Jupyter.notebook.kernel.restart()&lt;/script&gt;&quot;</span><span class=p>)</span>
</code></pre></div> <h3> Setup Sagemaker client </h3> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>boto3</span>
<span class=kn>import</span> <span class=nn>sagemaker</span>
<span class=kn>import</span> <span class=nn>transformers</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sagemaker Version - </span><span class=si>{</span><span class=n>sagemaker</span><span class=o>.</span><span class=n>__version__</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Transformers version - </span><span class=si>{</span><span class=n>transformers</span><span class=o>.</span><span class=n>__version__</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=n>sess</span> <span class=o>=</span> <span class=n>sagemaker</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
<span class=c1># sagemaker session bucket -&gt; used for uploading data, models and logs</span>
<span class=c1># sagemaker will automatically create this bucket if it not exists</span>
<span class=n>sagemaker_session_bucket</span><span class=o>=</span><span class=kc>None</span>
<span class=k>if</span> <span class=n>sagemaker_session_bucket</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>sess</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
    <span class=c1># set to default bucket if a bucket name is not given</span>
    <span class=n>sagemaker_session_bucket</span> <span class=o>=</span> <span class=n>sess</span><span class=o>.</span><span class=n>default_bucket</span><span class=p>()</span>

<span class=k>try</span><span class=p>:</span>
    <span class=n>role</span> <span class=o>=</span> <span class=n>sagemaker</span><span class=o>.</span><span class=n>get_execution_role</span><span class=p>()</span>
<span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
    <span class=n>iam</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;iam&#39;</span><span class=p>)</span>
    <span class=n>role</span> <span class=o>=</span> <span class=n>iam</span><span class=o>.</span><span class=n>get_role</span><span class=p>(</span><span class=n>RoleName</span><span class=o>=</span><span class=s1>&#39;sagemaker_execution_role&#39;</span><span class=p>)[</span><span class=s1>&#39;Role&#39;</span><span class=p>][</span><span class=s1>&#39;Arn&#39;</span><span class=p>]</span>

<span class=n>sess</span> <span class=o>=</span> <span class=n>sagemaker</span><span class=o>.</span><span class=n>Session</span><span class=p>(</span><span class=n>default_bucket</span><span class=o>=</span><span class=n>sagemaker_session_bucket</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;sagemaker role arn: </span><span class=si>{</span><span class=n>role</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;sagemaker bucket: </span><span class=si>{</span><span class=n>sess</span><span class=o>.</span><span class=n>default_bucket</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;sagemaker session region: </span><span class=si>{</span><span class=n>sess</span><span class=o>.</span><span class=n>boto_region_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <h3> Identify model id from Sagemaker Jumpstart & Setup data location </h3> <p>Sagemaker jumpstart has unique identifiers for each model present. Below is the model id &amp; the model version for Llama 3.1 8b</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>sagemaker.jumpstart.model</span> <span class=kn>import</span> <span class=n>JumpStartModel</span>
<span class=n>model_id</span><span class=p>,</span> <span class=n>model_version</span> <span class=o>=</span> <span class=s2>&quot;meta-textgeneration-llama-3-1-8b&quot;</span><span class=p>,</span> <span class=s2>&quot;2.2.2&quot;</span>
<span class=n>pretrained_model</span> <span class=o>=</span> <span class=n>JumpStartModel</span><span class=p>(</span><span class=n>model_id</span><span class=o>=</span><span class=n>model_id</span><span class=p>,</span> <span class=n>model_version</span><span class=o>=</span><span class=n>model_version</span><span class=p>)</span>
</code></pre></div> <p>In the cell below the training data location is being specified to the Sagemaker default S3 bucket. In addition the local training/validation paths are being identified to store in the local directory</p> <div class=highlight><pre><span></span><code><span class=n>train_test_data_location</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;s3://</span><span class=si>{</span><span class=n>sess</span><span class=o>.</span><span class=n>default_bucket</span><span class=p>()</span><span class=si>}</span><span class=s1>/datasets/3-1-8b&#39;</span>
<span class=n>local_train_data_file</span> <span class=o>=</span> <span class=s2>&quot;data/train.jsonl&quot;</span>
<span class=n>local_test_data_file</span> <span class=o>=</span> <span class=s2>&quot;data/validation.jsonl&quot;</span>
</code></pre></div> <h2> Dataset Download section </h2> <p>the dataset is being downloaded from <a href=https://www.pgnmentor.com/ >pgnmentor.com</a> this website allows for the extensive viewing &amp; analysis of previously played chess games. The data that will be used to fine tune this model will be data from some of Magnus Carlsen's games. The cells below outline the process of downloading the data to the directory</p> <div class=highlight><pre><span></span><code><span class=c1># Download Carlsen&#39;s games zip file to the target directory</span>
<span class=err>!</span><span class=n>curl</span> <span class=o>-</span><span class=n>o</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Carlsen</span><span class=o>.</span><span class=n>zip</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>pgnmentor</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>players</span><span class=o>/</span><span class=n>Carlsen</span><span class=o>.</span><span class=n>zip</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1># Unzip the file in the target directory</span>
<span class=err>!</span><span class=n>unzip</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Carlsen</span><span class=o>.</span><span class=n>zip</span> <span class=o>-</span><span class=n>d</span> <span class=o>./</span><span class=n>data</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1># Rename the unzipped folder to &#39;top&#39;</span>
<span class=err>!</span><span class=n>mv</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Carlsen</span><span class=o>.</span><span class=n>pgn</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>top</span><span class=o>.</span><span class=n>pgn</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1># Remove the zip file after unzipping</span>
<span class=err>!</span><span class=n>rm</span> <span class=o>./</span><span class=n>data</span><span class=o>/</span><span class=n>Carlsen</span><span class=o>.</span><span class=n>zip</span>
</code></pre></div> <h3> Dataset Processing & Validation </h3> <p>In the cell below the data is being processed to fit the correct format, and being saved to the local directory. Some points of importance in the cell below: * </p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>chess.pgn</span>
<span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
<span class=kn>import</span> <span class=nn>json</span>
<span class=kn>from</span> <span class=nn>datasets</span> <span class=kn>import</span> <span class=n>load_dataset</span><span class=p>,</span> <span class=n>DatasetDict</span>
<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>random</span>

<span class=k>def</span> <span class=nf>create_chess_message</span><span class=p>(</span><span class=n>fen</span><span class=p>,</span> <span class=n>next_move_color</span><span class=p>,</span> <span class=n>best_move_san</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
    <span class=n>instruction</span> <span class=o>=</span> <span class=s2>&quot;You are a chess engine. Analyze the given position and generate the next best valid move in SAN format.&quot;</span>
    <span class=k>return</span> <span class=p>{</span>
        <span class=s2>&quot;instruction&quot;</span><span class=p>:</span> <span class=n>instruction</span><span class=p>,</span>
        <span class=s2>&quot;fen&quot;</span><span class=p>:</span> <span class=n>fen</span><span class=p>,</span>
        <span class=s2>&quot;nxt-color&quot;</span><span class=p>:</span> <span class=n>next_move_color</span><span class=p>,</span>
        <span class=s2>&quot;move&quot;</span><span class=p>:</span> <span class=n>best_move_san</span> <span class=k>if</span> <span class=n>best_move_san</span> <span class=k>else</span> <span class=kc>None</span>
    <span class=p>}</span>

<span class=k>def</span> <span class=nf>process_sample</span><span class=p>(</span><span class=n>sample</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>create_chess_message</span><span class=p>(</span>
        <span class=n>fen</span><span class=o>=</span><span class=n>sample</span><span class=p>[</span><span class=s1>&#39;fen&#39;</span><span class=p>],</span>
        <span class=n>next_move_color</span><span class=o>=</span><span class=n>sample</span><span class=p>[</span><span class=s1>&#39;nxt_color&#39;</span><span class=p>],</span>
        <span class=n>best_move_san</span><span class=o>=</span><span class=n>sample</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;move&#39;</span><span class=p>)</span>
    <span class=p>)</span>

<span class=c1># Initialize a counter for the number of records written (set to 35000000 for the full dataset)</span>
<span class=c1>#set to 100 by default to finish the training job fast</span>
<span class=n>records_written</span> <span class=o>=</span> <span class=mi>0</span>
<span class=n>max_records</span> <span class=o>=</span> <span class=mi>100</span>

<span class=c1># Your existing code for creating data.json remains the same</span>
<span class=n>pathlist</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=s2>&quot;data/top/&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>glob</span><span class=p>(</span><span class=s1>&#39;**/*.pgn&#39;</span><span class=p>)</span>
<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&quot;data/top/data.json&quot;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
    <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>pathlist</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;File being processed - </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=n>pgn</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>records_written</span> <span class=o>&gt;=</span> <span class=n>max_records</span><span class=p>:</span>
                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Reached </span><span class=si>{</span><span class=n>max_records</span><span class=si>}</span><span class=s2> records. Stopping.&quot;</span><span class=p>)</span>
                <span class=k>break</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>game</span> <span class=o>=</span> <span class=n>chess</span><span class=o>.</span><span class=n>pgn</span><span class=o>.</span><span class=n>read_game</span><span class=p>(</span><span class=n>pgn</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>game</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=k>break</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>result</span> <span class=o>=</span> <span class=n>game</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s2>&quot;Result&quot;</span><span class=p>]</span>
                    <span class=k>if</span> <span class=n>result</span> <span class=o>==</span> <span class=s2>&quot;1-0&quot;</span><span class=p>:</span>
                        <span class=n>winner</span> <span class=o>=</span> <span class=s2>&quot;WHITE&quot;</span>
                    <span class=k>elif</span> <span class=n>result</span> <span class=o>==</span> <span class=s2>&quot;0-1&quot;</span><span class=p>:</span>
                        <span class=n>winner</span> <span class=o>=</span> <span class=s2>&quot;BLACK&quot;</span>
                    <span class=k>else</span><span class=p>:</span>
                        <span class=n>winner</span> <span class=o>=</span> <span class=s2>&quot;DRAW&quot;</span>

                    <span class=n>board</span> <span class=o>=</span> <span class=n>chess</span><span class=o>.</span><span class=n>Board</span><span class=p>()</span>  <span class=c1># Create a new board for each game</span>
                    <span class=k>for</span> <span class=n>move</span> <span class=ow>in</span> <span class=n>game</span><span class=o>.</span><span class=n>mainline_moves</span><span class=p>():</span>
                        <span class=n>current_color</span> <span class=o>=</span> <span class=s2>&quot;WHITE&quot;</span> <span class=k>if</span> <span class=n>board</span><span class=o>.</span><span class=n>turn</span> <span class=k>else</span> <span class=s2>&quot;BLACK&quot;</span>
                        <span class=k>if</span> <span class=n>winner</span> <span class=o>==</span> <span class=s2>&quot;DRAW&quot;</span> <span class=ow>or</span> <span class=n>current_color</span> <span class=o>==</span> <span class=n>winner</span><span class=p>:</span> <span class=c1>#consider the moves only if it&#39;s a winner&#39;s move or neutral</span>
                            <span class=k>if</span> <span class=n>move</span> <span class=ow>in</span> <span class=n>board</span><span class=o>.</span><span class=n>legal_moves</span><span class=p>:</span>
                                <span class=n>move_json</span> <span class=o>=</span> <span class=p>{</span>
                                    <span class=s2>&quot;move&quot;</span><span class=p>:</span> <span class=n>board</span><span class=o>.</span><span class=n>san</span><span class=p>(</span><span class=n>move</span><span class=p>),</span>
                                    <span class=s2>&quot;fen&quot;</span><span class=p>:</span> <span class=n>board</span><span class=o>.</span><span class=n>fen</span><span class=p>(),</span>
                                    <span class=s2>&quot;nxt_color&quot;</span><span class=p>:</span> <span class=n>current_color</span><span class=p>,</span>
                                <span class=p>}</span>
                                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>move_json</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
                                <span class=n>records_written</span> <span class=o>+=</span> <span class=mi>1</span>
                                <span class=n>board</span><span class=o>.</span><span class=n>push</span><span class=p>(</span><span class=n>move</span><span class=p>)</span>
                            <span class=k>else</span><span class=p>:</span>
                                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Illegal move encountered: </span><span class=si>{</span><span class=n>board</span><span class=o>.</span><span class=n>san</span><span class=p>(</span><span class=n>move</span><span class=p>)</span><span class=si>}</span><span class=s2> in position </span><span class=si>{</span><span class=n>board</span><span class=o>.</span><span class=n>fen</span><span class=p>()</span><span class=si>}</span><span class=s2>. Skipping this move.&quot;</span><span class=p>)</span>
                        <span class=k>else</span><span class=p>:</span>
                            <span class=n>board</span><span class=o>.</span><span class=n>push</span><span class=p>(</span><span class=n>move</span><span class=p>)</span>
            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error processing game: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>. Skipping this game.&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>records_written</span> <span class=o>&gt;=</span> <span class=n>max_records</span><span class=p>:</span>
            <span class=k>break</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total records written: </span><span class=si>{</span><span class=n>records_written</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># Load the dataset</span>
<span class=n>dataset</span> <span class=o>=</span> <span class=n>load_dataset</span><span class=p>(</span><span class=s2>&quot;json&quot;</span><span class=p>,</span> <span class=n>data_files</span><span class=o>=</span><span class=s2>&quot;data/top/data.json&quot;</span><span class=p>,</span> <span class=n>split</span><span class=o>=</span><span class=s2>&quot;train[:100%]&quot;</span><span class=p>)</span>

<span class=c1># Create a 70/30 train/test split</span>
<span class=n>dataset</span> <span class=o>=</span> <span class=n>dataset</span><span class=o>.</span><span class=n>train_test_split</span><span class=p>(</span><span class=n>test_size</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> <span class=n>seed</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

<span class=c1># Shuffle each split</span>
<span class=k>for</span> <span class=n>split</span> <span class=ow>in</span> <span class=n>dataset</span><span class=p>:</span>
    <span class=n>dataset</span><span class=p>[</span><span class=n>split</span><span class=p>]</span> <span class=o>=</span> <span class=n>dataset</span><span class=p>[</span><span class=n>split</span><span class=p>]</span><span class=o>.</span><span class=n>shuffle</span><span class=p>(</span><span class=n>seed</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

<span class=c1># Apply the processing function to each split</span>
<span class=n>dataset</span> <span class=o>=</span> <span class=n>dataset</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
    <span class=n>process_sample</span><span class=p>,</span>
    <span class=n>remove_columns</span><span class=o>=</span><span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;train&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>column_names</span><span class=p>,</span>
    <span class=n>num_proc</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>cpu_count</span><span class=p>()</span>  <span class=c1># Use multiple processes for faster processing</span>
<span class=p>)</span>

<span class=n>dataset</span> <span class=o>=</span> <span class=n>dataset</span><span class=o>.</span><span class=n>remove_columns</span><span class=p>(</span><span class=s2>&quot;instruction&quot;</span><span class=p>)</span> <span class=c1># Not needed as we are adding the instruction in template</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;New schema for dataset: </span><span class=si>{</span><span class=n>dataset</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Dataset sizes:&#39;</span><span class=p>)</span>
<span class=k>for</span> <span class=n>split</span> <span class=ow>in</span> <span class=n>dataset</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>split</span><span class=si>}</span><span class=s1>: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=n>split</span><span class=p>])</span><span class=si>}</span><span class=s1> samples&#39;</span><span class=p>)</span>

<span class=n>dataset</span> <span class=o>=</span> <span class=n>dataset</span><span class=o>.</span><span class=n>shuffle</span><span class=p>()</span>

<span class=c1># Save the processed datasets</span>
<span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;train&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>save_to_disk</span><span class=p>(</span><span class=s2>&quot;data/processed_chess_train&quot;</span><span class=p>)</span>
<span class=n>dataset</span><span class=p>[</span><span class=s1>&#39;test&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>save_to_disk</span><span class=p>(</span><span class=s2>&quot;data/processed_chess_test&quot;</span><span class=p>)</span>

<span class=n>dataset</span><span class=p>[</span><span class=s2>&quot;train&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>to_json</span><span class=p>(</span><span class=n>local_train_data_file</span><span class=p>,</span> <span class=n>orient</span><span class=o>=</span><span class=s2>&quot;records&quot;</span><span class=p>,</span> <span class=n>force_ascii</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>dataset</span><span class=p>[</span><span class=s2>&quot;test&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>to_json</span><span class=p>(</span><span class=n>local_test_data_file</span><span class=p>,</span> <span class=n>orient</span><span class=o>=</span><span class=s2>&quot;records&quot;</span><span class=p>,</span> <span class=n>force_ascii</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <p>Using the Python Chess library, the dataset is being validated to ensure all recommended moves are valid. This will ensure the LLM has 100% true examples to learn from </p> <div class=highlight><pre><span></span><code><span class=c1># Validating the dataset created has all valid and legal moves only - for the safer side!</span>
<span class=kn>import</span> <span class=nn>json</span>
<span class=kn>import</span> <span class=nn>chess</span>
<span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>

<span class=k>def</span> <span class=nf>validate_move</span><span class=p>(</span><span class=n>fen</span><span class=p>,</span> <span class=n>move_san</span><span class=p>):</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>board</span> <span class=o>=</span> <span class=n>chess</span><span class=o>.</span><span class=n>Board</span><span class=p>(</span><span class=n>fen</span><span class=p>)</span>
        <span class=c1># Parse SAN move and validate it&#39;s legal</span>
        <span class=n>move</span> <span class=o>=</span> <span class=n>board</span><span class=o>.</span><span class=n>parse_san</span><span class=p>(</span><span class=n>move_san</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>move</span> <span class=ow>in</span> <span class=n>board</span><span class=o>.</span><span class=n>legal_moves</span>
    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
        <span class=c1># If the move can&#39;t be parsed in SAN format</span>
        <span class=k>return</span> <span class=kc>False</span>

<span class=k>def</span> <span class=nf>validate_data_json</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
    <span class=n>valid_count</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=n>invalid_count</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=n>invalid_records</span> <span class=o>=</span> <span class=p>[]</span>

    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=n>lines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>

    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>line</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>tqdm</span><span class=p>(</span><span class=n>lines</span><span class=p>,</span> <span class=n>desc</span><span class=o>=</span><span class=s2>&quot;Validating moves&quot;</span><span class=p>)):</span>
        <span class=n>record</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
        <span class=n>fen</span> <span class=o>=</span> <span class=n>record</span><span class=p>[</span><span class=s1>&#39;fen&#39;</span><span class=p>]</span>
        <span class=n>move</span> <span class=o>=</span> <span class=n>record</span><span class=p>[</span><span class=s1>&#39;move&#39;</span><span class=p>]</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>validate_move</span><span class=p>(</span><span class=n>fen</span><span class=p>,</span> <span class=n>move</span><span class=p>):</span>
                <span class=n>valid_count</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>invalid_count</span> <span class=o>+=</span> <span class=mi>1</span>
                <span class=n>invalid_records</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>i</span><span class=p>,</span> <span class=n>fen</span><span class=p>,</span> <span class=n>move</span><span class=p>))</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=c1># Handle any other unexpected errors</span>
            <span class=n>invalid_count</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>invalid_records</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>i</span><span class=p>,</span> <span class=n>fen</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>move</span><span class=si>}</span><span class=s2> (Error: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>)&quot;</span><span class=p>))</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total records: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>lines</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Valid moves: </span><span class=si>{</span><span class=n>valid_count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Invalid moves: </span><span class=si>{</span><span class=n>invalid_count</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>invalid_records</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Invalid records:&quot;</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>record</span> <span class=ow>in</span> <span class=n>invalid_records</span><span class=p>[:</span><span class=mi>10</span><span class=p>]:</span>  <span class=c1># Print first 10 invalid records</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Line </span><span class=si>{</span><span class=n>record</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>: FEN: </span><span class=si>{</span><span class=n>record</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>, Move: </span><span class=si>{</span><span class=n>record</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>invalid_records</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;... and </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>invalid_records</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>10</span><span class=si>}</span><span class=s2> more.&quot;</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>valid_count</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>lines</span><span class=p>)</span>

<span class=c1># Run the validation</span>
<span class=n>file_path</span> <span class=o>=</span> <span class=s2>&quot;data/top/data.json&quot;</span>
<span class=n>all_valid</span> <span class=o>=</span> <span class=n>validate_data_json</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>

<span class=k>if</span> <span class=n>all_valid</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;All moves are valid!&quot;</span><span class=p>)</span>
<span class=k>else</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Some moves are invalid. Please check the output above for details.&quot;</span><span class=p>)</span>
</code></pre></div> <p>Print random samples from the dataset to view the cleaned &amp; prepped data</p> <div class=highlight><pre><span></span><code><span class=c1># Print random samples</span>
<span class=k>for</span> <span class=n>split</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;train&#39;</span><span class=p>,</span> <span class=s1>&#39;test&#39;</span><span class=p>]:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Random samples from </span><span class=si>{</span><span class=n>split</span><span class=si>}</span><span class=s2> set:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>index</span> <span class=ow>in</span> <span class=n>random</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=n>split</span><span class=p>])),</span> <span class=mi>2</span><span class=p>):</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>dataset</span><span class=p>[</span><span class=n>split</span><span class=p>][</span><span class=n>index</span><span class=p>][</span><span class=s2>&quot;fen&quot;</span><span class=p>])</span>
</code></pre></div> <p>Create the prompt template. This template is needed by Sagemaker Jumpstart to understand the given template from the dataset. This file must be in the same directory as the training data, and named "template.json"</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>json</span>

<span class=n>template</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s2>&quot;prompt&quot;</span><span class=p>:</span> <span class=p>(</span>
        <span class=s2>&quot;&lt;s&gt;[INST] You are a chess engine. Given a chess position in FEN notation and the color to move, &quot;</span>
        <span class=s2>&quot;provide the next best valid move in SAN (Standard Algebraic Notation) format to progress towards winning the game of chess. &quot;</span>
        <span class=s2>&quot;Your response must be a single move wrapped in &lt;move&gt;&lt;/move&gt; tags.</span><span class=se>\n\n</span><span class=s2>&quot;</span>
        <span class=s2>&quot;Chess Position (FEN): </span><span class=si>{fen}</span><span class=se>\n</span><span class=s2>&quot;</span>
        <span class=s2>&quot;Color to Move: {nxt-color} [/INST]&quot;</span>
    <span class=p>),</span>
    <span class=s2>&quot;completion&quot;</span><span class=p>:</span> <span class=s2>&quot; &lt;move&gt;</span><span class=si>{move}</span><span class=s2>&lt;/move&gt; &lt;/s&gt;&quot;</span>
<span class=p>}</span>

<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&quot;data/template.json&quot;</span><span class=p>,</span> <span class=s2>&quot;w&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
    <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>template</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</code></pre></div> <p>In the final step of dataset preparation the training data, testing data, and prompt template will be uploaded to the S3 buckets previously initialized </p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>sagemaker.s3</span> <span class=kn>import</span> <span class=n>S3Uploader</span>
<span class=kn>import</span> <span class=nn>sagemaker</span>
<span class=kn>import</span> <span class=nn>random</span>

<span class=n>S3Uploader</span><span class=o>.</span><span class=n>upload</span><span class=p>(</span><span class=n>local_train_data_file</span><span class=p>,</span> <span class=n>train_test_data_location</span><span class=p>)</span>
<span class=n>S3Uploader</span><span class=o>.</span><span class=n>upload</span><span class=p>(</span><span class=n>local_test_data_file</span><span class=p>,</span> <span class=n>train_test_data_location</span><span class=p>)</span>
<span class=n>S3Uploader</span><span class=o>.</span><span class=n>upload</span><span class=p>(</span><span class=s2>&quot;data/template.json&quot;</span><span class=p>,</span> <span class=n>train_test_data_location</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Training data: </span><span class=si>{</span><span class=n>train_test_data_location</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <h3> Submit the training job </h3> <p>An estimator object is needed by Sagemaker to submit training jobs. In this estimator object there are a some items that should be taken note of:</p> <ul> <li>The model id &amp; version are being passed into the estimator.</li> <li>The eula must be set to "true" - this is due to different LLM's on Sagemaker Jumpstart, being from different model providers. Each provider has its own eula.</li> <li>instance type - this is the compute instance(s) being used to conduct the fine tuning job on.</li> <li>The .fit method for the estimator is what actually submits the training job</li> </ul> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>sagemaker.jumpstart.estimator</span> <span class=kn>import</span> <span class=n>JumpStartEstimator</span>

<span class=n>estimator</span> <span class=o>=</span> <span class=n>JumpStartEstimator</span><span class=p>(</span>
    <span class=n>model_id</span><span class=o>=</span><span class=n>model_id</span><span class=p>,</span>
    <span class=n>model_version</span><span class=o>=</span><span class=n>model_version</span><span class=p>,</span>
    <span class=n>environment</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;accept_eula&quot;</span><span class=p>:</span> <span class=s2>&quot;true&quot;</span><span class=p>},</span>  <span class=c1># Please change this to {&quot;accept_eula&quot;: &quot;true&quot;}</span>
    <span class=n>disable_output_compression</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>instance_type</span><span class=o>=</span><span class=s2>&quot;ml.g5.48xlarge&quot;</span>
<span class=p>)</span>
<span class=c1># By default, instruction tuning is set to false. Thus, to use instruction tuning dataset you use</span>
<span class=n>estimator</span><span class=o>.</span><span class=n>set_hyperparameters</span><span class=p>(</span><span class=n>instruction_tuned</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>epoch</span><span class=o>=</span><span class=s2>&quot;5&quot;</span><span class=p>,</span> <span class=n>max_input_length</span><span class=o>=</span><span class=s2>&quot;1024&quot;</span><span class=p>)</span>
<span class=n>estimator</span><span class=o>.</span><span class=n>fit</span><span class=p>({</span><span class=s2>&quot;training&quot;</span><span class=p>:</span> <span class=n>train_test_data_location</span><span class=p>})</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>estimator</span><span class=o>.</span><span class=n>model_data</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>rivchess_model_src</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;s3DataSource&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;s3Uri&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=w> </span><span class=n>estimator</span><span class=o>.</span><span class=n>model_data</span><span class=p>[</span><span class=s2>&quot;S3DataSource&quot;</span><span class=p>][</span><span class=s2>&quot;S3Uri&quot;</span><span class=p>]</span><span class=w> </span><span class=si>}</span><span class=s1>&#39;</span><span class=p>}}</span>
<span class=o>%</span><span class=n>store</span> <span class=n>rivchess_model_src</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>#Copy the model files to the AWS account where chess application is deployed</span>

<span class=kn>import</span> <span class=nn>boto3</span>
<span class=kn>from</span> <span class=nn>botocore.config</span> <span class=kn>import</span> <span class=n>Config</span>
<span class=kn>import</span> <span class=nn>time</span>
<span class=kn>from</span> <span class=nn>IPython.display</span> <span class=kn>import</span> <span class=n>clear_output</span>
<span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>

<span class=c1># Create S3 clients with optimized config</span>
<span class=n>config</span> <span class=o>=</span> <span class=n>Config</span><span class=p>(</span>
    <span class=n>retries</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;max_attempts&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>
    <span class=n>tcp_keepalive</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=k>def</span> <span class=nf>copy_files</span><span class=p>():</span>
    <span class=c1># Configuration</span>
    <span class=n>source_bucket</span> <span class=o>=</span> <span class=s1>&#39;sagemaker-us-east-1-310426156939&#39;</span>
    <span class=n>source_prefix</span> <span class=o>=</span> <span class=s1>&#39;meta-textgeneration-llama-3-1-8b-2024-11-08-03-39-43-706/output/model/&#39;</span>
    <span class=n>dest_bucket</span> <span class=o>=</span> <span class=s1>&#39;riv-chess-cmi-models&#39;</span>
    <span class=n>dest_prefix</span> <span class=o>=</span> <span class=s1>&#39;meta-textgeneration-llama-3-1-8b-V4/&#39;</span>

    <span class=c1># Initialize S3 clients</span>
    <span class=n>s3_source</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;s3&#39;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s1>&#39;us-east-1&#39;</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>
    <span class=n>s3_dest</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;s3&#39;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s1>&#39;us-west-2&#39;</span><span class=p>,</span> <span class=n>config</span><span class=o>=</span><span class=n>config</span><span class=p>)</span>

    <span class=c1># Get list of all objects</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Fetching list of files...&quot;</span><span class=p>)</span>
    <span class=n>paginator</span> <span class=o>=</span> <span class=n>s3_source</span><span class=o>.</span><span class=n>get_paginator</span><span class=p>(</span><span class=s1>&#39;list_objects_v2&#39;</span><span class=p>)</span>
    <span class=n>pages</span> <span class=o>=</span> <span class=n>paginator</span><span class=o>.</span><span class=n>paginate</span><span class=p>(</span><span class=n>Bucket</span><span class=o>=</span><span class=n>source_bucket</span><span class=p>,</span> <span class=n>Prefix</span><span class=o>=</span><span class=n>source_prefix</span><span class=p>)</span>

    <span class=c1># Prepare file list with sizes</span>
    <span class=n>files_to_copy</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=n>total_size</span> <span class=o>=</span> <span class=mi>0</span>

    <span class=k>for</span> <span class=n>page</span> <span class=ow>in</span> <span class=n>pages</span><span class=p>:</span>
        <span class=k>if</span> <span class=s1>&#39;Contents&#39;</span> <span class=ow>in</span> <span class=n>page</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>obj</span> <span class=ow>in</span> <span class=n>page</span><span class=p>[</span><span class=s1>&#39;Contents&#39;</span><span class=p>]:</span>
                <span class=n>source_key</span> <span class=o>=</span> <span class=n>obj</span><span class=p>[</span><span class=s1>&#39;Key&#39;</span><span class=p>]</span>
                <span class=n>size_mb</span> <span class=o>=</span> <span class=n>obj</span><span class=p>[</span><span class=s1>&#39;Size&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>)</span>  <span class=c1># Convert to MB</span>
                <span class=n>total_size</span> <span class=o>+=</span> <span class=n>size_mb</span>
                <span class=n>files_to_copy</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
                    <span class=s1>&#39;source_key&#39;</span><span class=p>:</span> <span class=n>source_key</span><span class=p>,</span>
                    <span class=s1>&#39;size_mb&#39;</span><span class=p>:</span> <span class=n>size_mb</span><span class=p>,</span>
                    <span class=s1>&#39;dest_key&#39;</span><span class=p>:</span> <span class=n>dest_prefix</span> <span class=o>+</span> <span class=n>source_key</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>source_prefix</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
                <span class=p>})</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total files to copy: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>files_to_copy</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total size: </span><span class=si>{</span><span class=n>total_size</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

    <span class=c1># Create DataFrame for tracking</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>files_to_copy</span><span class=p>)</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;pending&#39;</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;attempts&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>

    <span class=c1># Copy files with progress tracking</span>
    <span class=n>copied</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=n>failed</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

    <span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=c1># Update progress display</span>
            <span class=n>clear_output</span><span class=p>(</span><span class=n>wait</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=n>elapsed_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Progress: </span><span class=si>{</span><span class=n>copied</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>files_to_copy</span><span class=p>)</span><span class=si>}</span><span class=s2> files copied&quot;</span><span class=p>)</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed: </span><span class=si>{</span><span class=n>failed</span><span class=si>}</span><span class=s2> files&quot;</span><span class=p>)</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Elapsed time: </span><span class=si>{</span><span class=n>elapsed_time</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> seconds&quot;</span><span class=p>)</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Currently copying: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;source_key&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;File size: </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;size_mb&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

            <span class=c1># Copy the file</span>
            <span class=n>copy_source</span> <span class=o>=</span> <span class=p>{</span>
                <span class=s1>&#39;Bucket&#39;</span><span class=p>:</span> <span class=n>source_bucket</span><span class=p>,</span>
                <span class=s1>&#39;Key&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;source_key&#39;</span><span class=p>]</span>
            <span class=p>}</span>

            <span class=n>s3_dest</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span>
                <span class=n>copy_source</span><span class=p>,</span>
                <span class=n>dest_bucket</span><span class=p>,</span>
                <span class=n>row</span><span class=p>[</span><span class=s1>&#39;dest_key&#39;</span><span class=p>]</span>
            <span class=p>)</span>

            <span class=n>df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=n>index</span><span class=p>,</span> <span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;completed&#39;</span>
            <span class=n>copied</span> <span class=o>+=</span> <span class=mi>1</span>

        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Error copying </span><span class=si>{</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;source_key&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
            <span class=n>df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=n>index</span><span class=p>,</span> <span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;failed&#39;</span>
            <span class=n>df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=n>index</span><span class=p>,</span> <span class=s1>&#39;error&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
            <span class=n>df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=n>index</span><span class=p>,</span> <span class=s1>&#39;attempts&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>failed</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># Brief pause before continuing</span>

    <span class=c1># Final summary</span>
    <span class=n>clear_output</span><span class=p>(</span><span class=n>wait</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Transfer Complete!&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total files copied: </span><span class=si>{</span><span class=n>copied</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed files: </span><span class=si>{</span><span class=n>failed</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total time: </span><span class=si>{</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>start_time</span><span class=p>)</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> seconds&quot;</span><span class=p>)</span>

    <span class=c1># Show failed files if any</span>
    <span class=k>if</span> <span class=n>failed</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Failed files:&quot;</span><span class=p>)</span>
        <span class=n>failed_df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;failed&#39;</span><span class=p>]</span>
        <span class=n>display</span><span class=p>(</span><span class=n>failed_df</span><span class=p>[[</span><span class=s1>&#39;source_key&#39;</span><span class=p>,</span> <span class=s1>&#39;size_mb&#39;</span><span class=p>,</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=s1>&#39;attempts&#39;</span><span class=p>]])</span>

    <span class=k>return</span> <span class=n>df</span>

<span class=c1># Execute the copy operation</span>
<span class=n>transfer_results</span> <span class=o>=</span> <span class=n>copy_files</span><span class=p>()</span>
</code></pre></div> <h3> Import the fine tuned model into Bedrock using Bedrock Custom Model Import (CMI) </h3> <p>The fine tuned model will now be imported into Amazon Bedrock. This model will be able to be used via the invoke model &amp; invoke model with response stream apis. This model will run in a serverless capacity. Take note that the first inference conducted after a 5 minute window of no inferences, will face a cold startup time. Subsequent inference requests will be conducted as normal, as long as there is less than a 5 minute window between them. To import the model an Import Job must be commenced, which is outlined below</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>datetime</span>
<span class=kn>import</span> <span class=nn>json</span>
<span class=kn>from</span> <span class=nn>botocore.exceptions</span> <span class=kn>import</span> <span class=n>ClientError</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>br_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;bedrock&#39;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s1>&#39;us-east-1&#39;</span><span class=p>)</span>
<span class=n>br_run_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;bedrock-runtime&#39;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=s1>&#39;us-east-1&#39;</span><span class=p>)</span>

<span class=n>model_split</span> <span class=o>=</span> <span class=n>model_id</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>model_split</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
    <span class=n>rivchess_model_nm</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;RIVCHESS-</span><span class=si>{</span><span class=n>model_split</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=k>else</span><span class=p>:</span>
    <span class=n>rivchess_model_nm</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;RIVCHESS-</span><span class=si>{</span><span class=n>model_split</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>

<span class=n>rivchess_imp_jb_nm</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>rivchess_model_nm</span><span class=si>}</span><span class=s2>-job-</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>%M%H%S&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<span class=n>role_arn</span> <span class=o>=</span> <span class=n>role</span>

<span class=n>create_model_import_job_resp</span> <span class=o>=</span> <span class=n>br_client</span><span class=o>.</span><span class=n>create_model_import_job</span><span class=p>(</span><span class=n>jobName</span><span class=o>=</span><span class=n>rivchess_imp_jb_nm</span><span class=p>,</span>
                                  <span class=n>importedModelName</span><span class=o>=</span><span class=n>rivchess_model_nm</span><span class=p>,</span>
                                  <span class=n>roleArn</span><span class=o>=</span><span class=n>role_arn</span><span class=p>,</span>
                                  <span class=n>modelDataSource</span><span class=o>=</span><span class=n>rivchess_model_src</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>list_model_import_jobs_response</span> <span class=o>=</span> <span class=n>br_client</span><span class=o>.</span><span class=n>list_model_import_jobs</span><span class=p>(</span>
    <span class=n>nameContains</span><span class=o>=</span><span class=n>rivchess_imp_jb_nm</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;BR CMI Import Job - </span><span class=si>{</span><span class=n>create_model_import_job_resp</span><span class=p>[</span><span class=s1>&#39;jobArn&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> is - </span><span class=si>{</span><span class=n>list_model_import_jobs_response</span><span class=p>[</span><span class=s1>&#39;modelImportJobSummaries&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=k>while</span> <span class=n>list_model_import_jobs_response</span><span class=p>[</span><span class=s1>&#39;modelImportJobSummaries&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;Completed&#39;</span><span class=p>:</span>
    <span class=n>interactive_sleep</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
    <span class=n>list_model_import_jobs_response</span> <span class=o>=</span> <span class=n>br_client</span><span class=o>.</span><span class=n>list_model_import_jobs</span><span class=p>(</span><span class=n>nameContains</span><span class=o>=</span><span class=n>rivchess_imp_jb_nm</span><span class=p>)</span>
</code></pre></div> <h3> Invoke the imported model using Bedrock API's </h3> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>time</span>
<span class=k>def</span> <span class=nf>interactive_sleep</span><span class=p>(</span><span class=n>seconds</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
    <span class=n>dots</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>seconds</span><span class=p>):</span>
        <span class=n>dots</span> <span class=o>+=</span> <span class=s1>&#39;.&#39;</span>
        <span class=nb>print</span><span class=p>(</span><span class=n>dots</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\r</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>try</span><span class=p>:</span>
    <span class=n>get_imported_model_response</span> <span class=o>=</span> <span class=n>br_client</span><span class=o>.</span><span class=n>get_imported_model</span><span class=p>(</span>
        <span class=n>modelIdentifier</span><span class=o>=</span><span class=n>rivchess_model_nm</span>
    <span class=p>)</span>

    <span class=n>br_model_id</span> <span class=o>=</span> <span class=n>get_imported_model_response</span><span class=p>[</span><span class=s1>&#39;modelArn&#39;</span><span class=p>]</span>
    <span class=n>br_model_id</span>
<span class=k>except</span> <span class=n>br_client</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>ResourceNotFoundException</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Model not yet imported&quot;</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>call_invoke_model_and_print</span><span class=p>(</span><span class=n>native_request</span><span class=p>):</span>
    <span class=n>request</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>native_request</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=c1># Invoke the model with the request.</span>
        <span class=n>response</span> <span class=o>=</span> <span class=n>br_run_client</span><span class=o>.</span><span class=n>invoke_model</span><span class=p>(</span><span class=n>modelId</span><span class=o>=</span><span class=n>br_model_id</span><span class=p>,</span> <span class=n>body</span><span class=o>=</span><span class=n>request</span><span class=p>)</span>
        <span class=n>model_response</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>response</span><span class=p>[</span><span class=s2>&quot;body&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
        <span class=c1># print(f&quot;model_response: {model_response}&quot;)</span>
        <span class=n>response_text</span> <span class=o>=</span> <span class=n>model_response</span><span class=p>[</span><span class=s1>&#39;generation&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;### Response:&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>response_text</span>
    <span class=k>except</span> <span class=p>(</span><span class=n>ClientError</span><span class=p>,</span> <span class=ne>Exception</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;ERROR: Can&#39;t invoke &#39;</span><span class=si>{</span><span class=n>br_model_id</span><span class=si>}</span><span class=s2>&#39;. Reason: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>template</span><span class=p>[</span><span class=s2>&quot;prompt&quot;</span><span class=p>]</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>move_color</span> <span class=o>=</span> <span class=s2>&quot;BLACK&quot;</span>
<span class=n>board_fen</span> <span class=o>=</span> <span class=s2>&quot;6k1/p1q1prbp/b3n1p1/2pPPp2/5P1Q/4BN2/Pr2N1PP/R1R4K b - - 0 21&quot;</span>

<span class=c1># Format the prompt using the template</span>
<span class=n>formatted_prompt</span> <span class=o>=</span> <span class=n>template</span><span class=p>[</span><span class=s2>&quot;prompt&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
    <span class=n>fen</span><span class=o>=</span><span class=n>board_fen</span><span class=p>,</span>
    <span class=n>nxt_color</span><span class=o>=</span><span class=n>move_color</span>
<span class=p>)</span>

<span class=n>native_request</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s2>&quot;prompt&quot;</span><span class=p>:</span> <span class=n>formatted_prompt</span><span class=p>,</span>
    <span class=s2>&quot;max_tokens&quot;</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span>
    <span class=s2>&quot;top_p&quot;</span><span class=p>:</span> <span class=mf>0.9</span><span class=p>,</span>
    <span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=mf>0.1</span>
<span class=p>}</span>

<span class=n>call_invoke_model_and_print</span><span class=p>(</span><span class=n>native_request</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=n>move_color</span> <span class=o>=</span> <span class=s2>&quot;WHITE&quot;</span>
<span class=n>board_fen</span> <span class=o>=</span> <span class=s2>&quot;1r1qk2r/p2bppbp/n2P1np1/1pp5/3P4/2P1BB2/PP2QPPP/RN2K1NR w KQk - 3 11&quot;</span>

<span class=c1># Format the prompt using the template</span>
<span class=n>formatted_prompt</span> <span class=o>=</span> <span class=n>template</span><span class=p>[</span><span class=s2>&quot;prompt&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
    <span class=n>fen</span><span class=o>=</span><span class=n>board_fen</span><span class=p>,</span>
    <span class=n>nxt_color</span><span class=o>=</span><span class=n>move_color</span>
<span class=p>)</span>

<span class=n>native_request</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s2>&quot;prompt&quot;</span><span class=p>:</span> <span class=n>formatted_prompt</span><span class=p>,</span>
    <span class=s2>&quot;max_tokens&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
    <span class=s2>&quot;top_p&quot;</span><span class=p>:</span> <span class=mf>0.9</span><span class=p>,</span>
    <span class=s2>&quot;temperature&quot;</span><span class=p>:</span> <span class=mf>0.1</span><span class=p>,</span>
    <span class=s2>&quot;top_k&quot;</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span>
<span class=p>}</span>

<span class=n>call_invoke_model_and_print</span><span class=p>(</span><span class=n>native_request</span><span class=p>)</span>
</code></pre></div> <h2> Clean Up </h2> <p>Once the model will no longer be used, it may be deleted with the cell below. If additional testing for the model needs to be done, the "test_chess_model.ipynb" notebook can be opened to test the model against a Chess engine called Stockfish. </p> <div class=highlight><pre><span></span><code><span class=n>delete_imported_model_response</span> <span class=o>=</span> <span class=n>br_client</span><span class=o>.</span><span class=n>delete_imported_model</span><span class=p>(</span>
    <span class=n>modelIdentifier</span><span class=o>=</span><span class=n>br_model_id</span>
<span class=p>)</span>
</code></pre></div> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by <a href="https://github.com/aws-samples/amazon-bedrock-samples/issues/new?title=[Online Feedback]: Short-Summary-of-Issue&body=Page URL: /custom-models/import_models/llama-3.1-jumpstart-chess/llama-3.1-8b-jumpstart-chess-finetuning/" target=_blank rel=noopener>creating an issue</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved. </div> </div> <div class=md-social> <a href=https://github.com/aws-samples/amazon-bedrock-samples/tree/main target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["tags", "toc.integrate", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "search.highlight", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "tags": {"Compatibility": "compat"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.88dd0f4e.min.js></script> <script src=../../../../javascript/feedback.js></script> </body> </html>